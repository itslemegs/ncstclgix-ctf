<!DOCTYPE html><html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:Web="http://schemas.live.com/Web/" manifest="/manifest/threshold.appcache"><script type="text/javascript">//<![CDATA[
si_ST=new Date;
//]]></script><head><!--pc--><title>Bing</title><meta content="text/html; charset=utf-8" http-equiv="content-type"/><script type="text/javascript">//<![CDATA[
_G={ST:(si_ST?si_ST:new Date),Mkt:"en-US",RTL:false,Ver:"9_00_0_4060131",IG:"f14ea2f84a3b4f928798238c814bdbe0",EventID:"6d7719afdcde42d380318f369480d494",MN:"SERP",V:"web",P:"SERP",DA:"Co3b",SUIH:"jCRbEqZlS6YDsom_dDnLoQ",IP:"131107160",gpUrl:"\/fd\/ls\/GLinkPing.aspx?"};_G.lsUrl="/fd/ls/l?IG="+_G.IG;curUrl="https:\/\/www.bing.com\/devicecontent";_G.XLS="\/threshold\/xls.aspx";;window.onerror||(window.onerror=function(n,t,i,r,u){var f;typeof n=="object"&&n.srcElement&&n.srcElement.src?(f={ScriptSrc:n.srcElement.src},sj_evt&&sj_evt.fire("ErrorInstrumentation",JSON.stringify(f))):typeof SharedLogHelper!="undefined"?SharedLogHelper.LogError(t,n.toString(),u,i,r):window.addEventListener("load",function(){return SharedLogHelper.LogError(t,n.toString(),u,i,r)})});
//]]></script><style type="text/css">html,body{-ms-content-zooming:none}</style><link rel="stylesheet" href="/rms/BlueBrand/ortl,cc/1bea0f76/854b6456.css?bu=rms+answers+BrandBundle_Mobile+thbrand%24CombinedAsset_th_b%2cthbrand%24Colors_th_b%2cthbrand%24Type_th_b%2cthbrand%24Grid_th_b" type="text/css"/><link rel="stylesheet" href="/rms/BlueHeader/ortl,cc/c57d0e76/50afa249.css?bu=rms+answers+BrandBundle_Mobile+thbrand%24Header_CombinedAsset%2cthbrand%24Header_Colors_th_b%2cthbrand%24Header_Type%2cthbrand%24Header_Grid_th_b" type="text/css"/><style type="text/css">.b_accentColor,.b_accentColor strong,strong.b_accentColor,strong .b_accentColor,.qcard a,#sb_feedback,.b_anno,.appifyCaptionAccent,#b_results a.b_accentColor,#b_results a.b_accentColor:visited{color:#f90;}.b_accentColorStroke{stroke:#f90;}.b_accentColorFill{fill:#f90;}.b_accentColorBackground{background-color:#f90;}input[type="text"]:focus{border-color:#f90;}select:active{background-color:#f90;}select{color:#f90;}select::-ms-expand{color:#f90;}.b_moreLink,.b_moreLink:visited,#b_results .b_moreLink,#b_results .b_morelink:visited{color:#f90;}.sml,.sml a,.sml a:visited{color:#f90;}.b_corActList,.b_corActList a,.b_corActList a:visited{color:#f90;}html,body,#b_content{height:100%;overflow-y:auto;background-color:#eee}#b_content>div{display:flex;height:100%;flex-direction:column}#b_content strong{font-family:'Segoe UI';font-weight:700}#b_content>div>div:nth-child(1){flex:0 0 auto}#b_content>div>div:nth-child(2){flex:1 0;overflow-y:auto}#b_header{display:none}.b_1linetrunc,.b_1linetrunc div:not([class]){white-space:nowrap;overflow-x:hidden;text-overflow:ellipsis}.Header .top{display:none;background-color:#fff;height:24px;font-family:Segoe UI Semilight;font-size:20px}body[dir] .Header .top{padding:12px 24px}.Header progress{width:100%;height:5px;position:absolute}body[dir] .Header .lower{padding:12px 24px}body[dir='ltr'] .top.hasback{padding-left:56px}body[dir='rtl'] .top.hasback{padding-right:56px}.Header .dropdowns{display:inline-block}.Header a{float:right}body[dir='rtl'] .Header a{float:left}.Header select{border:solid 2px;border-color:#ccc;background-color:#fff;height:28px;font-family:"Segoe Ui";color:#000}body[dir] .Header select{padding:2px 8px}body[dir='ltr'] .Header select{margin:0 24px 0 10px}body[dir='rtl'] .Header select{margin:0 10px 0 24px}.Header select::-ms-expand{display:block;border:0;color:#333;background-color:#fff}.Header label{display:inline-block;color:#000}body[dir] .DeviceContent{padding:0 24px 24px}.DeviceContent>div>.b_hList>li{display:block}body[dir] .Speller,body[dir] .inlineError,body[dir] .DeviceContent>div>.b_hList{padding-bottom:24px}.DeviceContent>div>.b_hList:empty{display:none}.DeviceContent h2 a{color:#000}.subsection>*,.subsectionTitles a,.DeviceContent h2:not(.messageHeader):not(.b_groupLabel),.Header select{font-size:12px;line-height:14px}body[dir] .DeviceContent h2.b_groupLabel{padding-bottom:12px}.DeviceContent h2.b_groupLabel:hover,.subsectionTitles h2:hover{text-decoration:underline}.messageHeader{font-family:"Segoe Ui Light";font-size:34px;line-height:normal}.subsection h4 a,.subsection h4 a:hover,.subsection h4 a:visited{color:#000}.subsection>*{cursor:pointer;width:calc(50%- 2px);display:inline-block;background-color:#fff;overflow:hidden}body[dir] .subsection>*{margin-bottom:0}.emails>*,.files>*,.folders>*,.videos>*,.settings>*{width:100%}.videos .centeredSquare_l .inner{flex-basis:172px}.emails .centeredSquare_s .inner{display:none}body[dir='ltr'] .subsection:not(.emails):not(.files):not(.folders):not(.videos):not(.settings)>*:nth-child(2n):not(.b_select){margin-left:4px}body[dir='rtl'] .subsection:not(.emails):not(.files):not(.folders):not(.videos):not(.settings)>*:nth-child(2n):not(.b_select){margin-right:4px}body[dir='ltr'] .subsection:not(.emails):not(.files):not(.folders):not(.videos):not(.settings)>*:nth-child(2n){margin-left:3px}body[dir='rtl'] .subsection:not(.emails):not(.files):not(.folders):not(.videos):not(.settings)>*:nth-child(2n){margin-right:3px}body[dir] .subsection .metadata .b_vPanel>div,body[dir] .secondary,body[dir] .widecolumn{padding-bottom:2px}body[dir] .DeviceContent .b_centeredImagePair>.inner{margin:0}body[dir] .b_centeredImagePair .caption{padding:12px 24px}.DeviceContent .b_imagePair.square_xs>.inner,.DeviceContent li.square_xs{width:32px}.metadata{display:-ms-grid;-ms-grid-columns:1fr auto;-ms-grid-rows:1fr;color:#767676}.metadata .primary{-ms-grid-row:1}.metadata .secondary{-ms-grid-row:2}.metadata .widecolumn{-ms-grid-column:2;-ms-grid-row:1;-ms-grid-row-span:2;-ms-grid-row-align:center}body[dir] .secondary>ul{padding-bottom:0}.subsection>li:not(.b_select):hover,.DTLRow>li:not(.b_select):hover{background-color:#e5e5e5}.subsection>li:not(.b_select).pressed,.DTLRow>li:not(.b_select).pressed{background-color:#ddd}.b_select{border-style:solid}body[dir] .b_select{border-width:1px;margin:-1px}.b_select a{outline:0}.b_select.DTLItem{border-style:solid}body[dir] .b_select.DTLItem{border-width:4px;margin:-4px}body[dir='ltr'] .b_select.DTLItem{margin-right:0}body[dir='rtl'] .b_select.DTLItem{margin-left:0}.DTLItem:not(.b_select):hover{border:solid 2px rgba(0,0,0,.6)}body[dir] .DTLItem:not(.b_select):hover{margin:-2px}body[dir='ltr'] .DTLItem:not(.b_select):hover{margin-right:2px}body[dir='rtl'] .DTLItem:not(.b_select):hover{margin-left:2px}@media screen and (max-width:640px){.DeviceContent .subsection>*{width:100%}body[dir='ltr'] .subsection:not(.emails):not(.files):not(.folders):not(.videos):not(.settings)>*:nth-child(2n){margin-left:0}body[dir='rtl'] .subsection:not(.emails):not(.files):not(.folders):not(.videos):not(.settings)>*:nth-child(2n){margin-right:0}body[dir='ltr'] .subsection:not(.emails):not(.files):not(.folders):not(.videos):not(.settings)>*:nth-child(2n):not(.b_select){margin-left:0}body[dir='rtl'] .subsection:not(.emails):not(.files):not(.folders):not(.videos):not(.settings)>*:nth-child(2n):not(.b_select){margin-right:0}.Header div.top,.lower .dropdowns{display:none}.Header .lower{border-bottom:0}body[dir='ltr'] .Header select{margin-right:12px;padding-left:0}body[dir='rtl'] .Header select{margin-left:12px;padding-right:0}#b_content>div>div:nth-child(2){overflow-y:visible}}@media screen and (max-width:460px){.metadata .widecolumn{-ms-grid-column:1;-ms-grid-row:3}.videos .centeredSquare_l .inner{flex-basis:96px}}body:-ms-lang(ar,dv,fa,he,ku-Arab,pa-Arab,prs,ps,sd-Arab,syr,ug,ur,qps-plocm){direction:rtl}.subsection .inner:-ms-lang(ar,dv,fa,he,ku-Arab,pa-Arab,prs,ps,sd-Arab,syr,ug,ur,qps-plocm){float:right}body[dir='ltr'] .subsection .inner:-ms-lang(ar,dv,fa,he,ku-Arab,pa-Arab,prs,ps,sd-Arab,syr,ug,ur,qps-plocm){margin-left:12px;margin-right:0}body[dir='rtl'] .subsection .inner:-ms-lang(ar,dv,fa,he,ku-Arab,pa-Arab,prs,ps,sd-Arab,syr,ug,ur,qps-plocm){float:left;margin-right:12px;margin-left:0}body[dir] .DTLContainer{margin-top:4px}.DTLRow{display:flex}body[dir] .DTLRow{margin-bottom:4px}.DTLItem{float:left;overflow:hidden}body[dir='ltr'] .DTLItem{margin-right:4px}body[dir='rtl'] .DTLItem{float:right;margin-left:4px}.DTLPlaceholder{background-color:#ddd}.b_placeHolder::before,.b_ReadEmail::before,.b_placeHolderEmail::before,.b_placeHolderDoc::before,.b_placeHolderApp::before,.b_placeHolderPhoto::before,.b_placeHolderVideo::before,.b_placeHolderMusic::before,.b_placeHolderSetting::before{font-size:25px;line-height:32px;font-family:"Segoe UI Symbol";color:rgba(0,0,0,.2)}.b_placeHolderPhoto::before,.b_placeHolderVideo::before{color:#fff;display:inline-block;font-size:40px}body[dir] .b_placeHolderPhoto::before,body[dir] .b_placeHolderVideo::before{padding:18px 26px}.b_placeHolderSetting::before{content:""}.b_placeHolderDoc::before,.b_placeHolderFolder::before{content:""}.b_placeHolderPhoto::before{content:""}.b_placeHolderVideo::before{content:""}.b_placeHolderApp::before{content:""}.b_placeHolderMusic::before{content:"♫"}.b_placeHolderEmail::before{content:"";line-height:26px}.b_ReadEmail::before{content:"";line-height:33px}.lower label{display:inline-block}.subsectionTitles{display:flex;flex-direction:row;width:100%}body[dir] .b_vPanel>div:first-child>.subsectionTitles.noTitle{margin-top:-26px}.subsectionTitles h2{flex:0 auto}.subsectionTitles a{flex:1 auto;text-align:right}body[dir='rtl'] .subsectionTitles a{text-align:left}.imageBackground{background-color:#fff}body[dir] .sb_pag{margin-bottom:24px}body[dir='ltr'] .sb_pag>li{margin-right:12px}body[dir='rtl'] .sb_pag>li{margin-left:12px}.sb_pag>li>a{width:42px;line-height:16px}.Header .top{display:block}body[dir] .b_imagePair{padding:12px}body[dir='ltr'] .b_imagePair>*:last-child{margin-left:12px}body[dir='rtl'] .b_imagePair>*:last-child{margin-right:12px}.settings .b_imagePair>*:last-child,.apps .b_imagePair>*:last-child{align-items:center;display:flex}.imageContainer{width:32px;overflow:hidden}.music .imageContainer{width:72px;height:72px}.videos .imageContainer,.music .placeholder{justify-content:center;align-items:center;display:flex;background-color:#ddd}.videos .imageContainer{width:128px;height:72px;background-color:#000}.videos .placeholder{background-color:#ddd}.subsection>*,.subsectionTitles a,.DeviceContent h2:not(.noResults):not(.b_groupLabel):not(.messageHeader),.Header .lower,.Header select,.recourse span{font-size:13px;line-height:16px}.Header .dropdowns>label{position:relative;top:2px}.metadata .widecolumn{-ms-grid-row-span:1;-ms-grid-row-align:start}body[dir='ltr'] .metadata .widecolumn{padding-left:24px}body[dir='rtl'] .metadata .widecolumn{padding-right:24px}body[dir] .widecolumn,body[dir] .imageContainer{margin-top:2px}body[dir] .b_vList.section>li:last-child{padding-bottom:24px}.DeviceContent .b_groupLabel{text-transform:capitalize;font-size:15px;line-height:20px}.recourse span{position:relative;top:4px}body[dir='ltr'] .recourse span{margin-left:12px}body[dir='rtl'] .recourse span{margin-right:12px}.b_placeHolder::before,.b_ReadEmail::before,.b_placeHolderEmail::before,.b_placeHolderDoc::before,.b_placeHolderApp::before,.b_placeHolderPhoto::before,.b_placeHolderVideo::before,.b_placeHolderMusic::before,.b_placeHolderFolder::before,.b_placeHolderSetting::before,.recourse::before{font-size:32px;font-family:"Segoe MDL2 Assets";color:#000}body[dir] .b_placeHolder::before,body[dir] .b_ReadEmail::before,body[dir] .b_placeHolderEmail::before,body[dir] .b_placeHolderDoc::before,body[dir] .b_placeHolderApp::before,body[dir] .b_placeHolderPhoto::before,body[dir] .b_placeHolderVideo::before,body[dir] .b_placeHolderMusic::before,body[dir] .b_placeHolderFolder::before,body[dir] .b_placeHolderSetting::before,body[dir] .recourse::before{padding:0}.b_placeHolderSetting::before{content:""}.b_placeHolderDoc::before{content:""}.b_placeHolderApp::before{content:""}.b_placeHolderMusic::before{content:""}.b_placeHolderVideo::before{content:""}.b_placeHolderPhoto::before{content:""}.b_placeHolderFolder::before{content:"";position:relative;top:12px}.recourse::before{content:"";font-size:15px}z{a:1}.b_fade,.b_slide,.b_anim,.b_drill,.b_drillSlide,.b_fadeUp,.b_slideListHide{overflow:hidden}.b_fade.b_hide,.b_slide.b_hide,.b_anim.b_hide,.b_drill.b_hide,.b_drillSlide.b_hide,.b_fadeUp.b_hide,.b_slideListHide{display:block;border-top:0!important;border-bottom:0!important}body[dir] .b_fade.b_hide,body[dir] .b_slide.b_hide,body[dir] .b_anim.b_hide,body[dir] .b_drill.b_hide,body[dir] .b_drillSlide.b_hide,body[dir] .b_fadeUp.b_hide,body[dir] .b_slideListHide{padding-top:0!important;padding-bottom:0!important;margin-top:0!important;margin-bottom:0!important}.b_slide.b_hide,.b_anim.b_hide,.b_drillSlide.b_hide,.b_slideListHide{height:0!important}.b_anim{transition:all 250ms}.b_fade{opacity:1;max-height:9999px;transition:opacity linear 250ms,max-height 0 0}.b_fade.b_hide{opacity:0;max-height:0;transition:opacity linear 250ms,max-height 0 250ms}.b_fadeUp{opacity:1;transform:translateY(0);max-height:9999px;transition:opacity linear 170ms,transform cubic-bezier(.15,.85,.35,1) 500ms,max-height 0 0}.b_fadeUp.b_hide{opacity:0;transform:translateY(10px);max-height:0;transition:opacity linear 170ms,transform cubic-bezier(.15,.85,.35,1) 500ms,max-height 0 500ms}.b_slide,.b_slide.b_hide{transition:height cubic-bezier(.15,.85,.35,1) 250ms}.b_drillSlide{opacity:1;transform:scale(1,1);transition:height cubic-bezier(.15,.85,.35,1) 330ms 0,opacity linear 70ms 350ms,transform cubic-bezier(.15,.85,.35,1) 330ms 330ms}.b_drillSlide.b_hide{opacity:0;transform:scale(.9,.9);transition:height cubic-bezier(.15,.85,.35,1) 330ms 330ms,opacity linear 70ms 20ms,transform cubic-bezier(.15,.85,.35,1) 330ms 0}.b_drill{opacity:1;transform:scale(1,1);max-height:9999px;transition:opacity linear 50ms 20ms,transform cubic-bezier(.15,.85,.35,1) 330ms}.b_drill.b_hide{opacity:0;transform:scale(.9,.9);max-height:0;transition:opacity linear 50ms,transform cubic-bezier(.15,.85,.35,1) 170ms,max-height 0 170ms}.b_fadeAnim{animation:fadeAnim linear 330ms}@keyframes fadeAnim{from{opacity:0}to{opacity:1}}.b_slideListHide>li{opacity:0}.b_slideListUp:not(.b_slideListHide)>li{transform:translateY(0)!important;opacity:1;transition:transform cubic-bezier(.15,.85,.35,1) 400ms,opacity linear 250ms}.b_imagePair .inner img,.b_hList img{display:block}body[dir] .b_imagePair>.inner,body[dir] .b_hList .cico{padding-bottom:10px}body[dir] .b_title .b_imagePair>.inner,body[dir] .b_vList>li>.b_imagePair>.inner,body[dir] .b_hList .b_imagePair>.inner,body[dir] .b_vPanel>div>.b_imagePair>.inner,body[dir] .b_gridList .b_imagePair>.inner,body[dir] .b_caption .b_imagePair>.inner,body[dir] .b_attribution .b_imagePair>.inner,body[dir] .b_imagePair>.inner>.b_footnote,body[dir] .b_poleContent .b_imagePair>.inner{padding-bottom:0}.b_imagePair>.inner{float:left}body[dir='rtl'] .b_imagePair>.inner{float:right}.b_imagePair.reverse>.inner{float:right}body[dir='rtl'] .b_imagePair.reverse>.inner{float:left}.b_imagePair .b_imagePair:last-child:after{clear:none}.b_algo .b_title .b_imagePair,.b_ans .b_title .b_imagePair{display:block}.b_imagePair.square_xs>.inner,li.square_xs{width:30px}body[dir='ltr'] .b_imagePair.square_xs{padding-left:40px}body[dir='rtl'] .b_imagePair.square_xs{padding-right:40px}body[dir='ltr'] .b_imagePair.square_xs>.inner{margin:2px 0 0 -40px}body[dir='rtl'] .b_imagePair.square_xs>.inner{margin:2px -40px 0 0}body[dir='ltr'] .b_imagePair.square_xs.reverse{padding-left:0;padding-right:40px}body[dir='rtl'] .b_imagePair.square_xs.reverse{padding-right:0;padding-left:40px}body[dir='ltr'] .b_imagePair.square_xs.reverse>.inner{margin:2px -40px 0 0}body[dir='rtl'] .b_imagePair.square_xs.reverse>.inner{margin:2px 0 0 -40px}.b_imagePair.square_b>.inner,li.square_b{width:100px}li.square_b{word-wrap:break-word}body[dir='ltr'] .b_imagePair.square_b{padding-left:110px}body[dir='rtl'] .b_imagePair.square_b{padding-right:110px}body[dir='ltr'] .b_imagePair.square_b>.inner{margin:2px 0 0 -110px}body[dir='rtl'] .b_imagePair.square_b>.inner{margin:2px -110px 0 0}body[dir='ltr'] .b_imagePair.square_b.reverse{padding-left:0;padding-right:110px}body[dir='rtl'] .b_imagePair.square_b.reverse{padding-right:0;padding-left:110px}body[dir='ltr'] .b_imagePair.square_b.reverse>.inner{margin:2px -110px 0 0}body[dir='rtl'] .b_imagePair.square_b.reverse>.inner{margin:2px 0 0 -110px}.b_centeredImagePair,.b_centeredImagePair>*{display:flex;width:100%}.b_centeredImagePair>*{align-items:center;justify-content:center}.b_centeredImagePair>.inner{overflow:hidden}body[dir='ltr'] .b_centeredImagePair>.inner{margin-right:12px}body[dir='rtl'] .b_centeredImagePair>.inner{margin-left:12px}.b_centeredImagePair .centeredText{width:100%}.centeredSquare_s>.inner{flex:0 0 64px;min-height:64px}.centeredSquare_l>.inner{flex:0 0 96px;min-height:96px}.contextMenu{z-index:6;position:absolute;display:block;background-color:#fff;border:2px solid #000;font-weight:600}body[dir] .contextMenu{padding:5px 0}body[dir] .contextMenuItem{padding:12px 20px}.contextMenu .divider{border-color:#000}body[dir] .contextMenu .divider{margin:8px 0}.contextMenuItem:active{background:#000;color:#fff}.contextMenuItem:hover{background:#e6e6e6}@media screen and (-ms-high-contrast:active){.contextMenuItem:hover{background-color:Highlight;color:HighlightText}}#fdbkcontainer{background:#fff;bottom:0;position:fixed;color:#000;z-index:9;font-size:15px;border:1px solid #ccc}#fdbkcontainer .fdbkactionbtns{position:absolute}@media(max-width:340px){#fdbkcontainer{width:100%;height:100%}}@media(max-width:340px)and (max-height:599px){#fdbkcontainer .fdbkactionbtns{bottom:12px}}@media(max-width:340px)and (min-height:600px){body[dir] #fdbkcontainer .fdbkactionbtns{padding:54px 0 0 0}}@media(min-width:341px){#fdbkcontainer{width:320px;height:488px}body[dir='ltr'] #fdbkcontainer{right:0}body[dir='rtl'] #fdbkcontainer{left:0}body[dir='rtl'] #fdbkcontainer{left:0;right:auto}#fdbkcontainer .fdbkactionbtns{bottom:12px}}#fdbkcontainer h1{font-weight:normal;font-size:20px;line-height:24px}body[dir] #fdbkcontainer h1{margin-bottom:12px}#fdbkcontainer a{color:#0078d7;text-decoration:none;font-size:15px;display:inline-block}body[dir] #fdbkcontainer #fdbkfrm{margin:12px}#fdbkcontainer label{color:#000;background:none;background-position:inherit;height:inherit;position:static;display:inline-block;cursor:pointer}body[dir] #fdbkcontainer label{margin:0}body[dir='ltr'] #fdbkcontainer label{padding:0 0 3px 0}body[dir='rtl'] #fdbkcontainer label{padding:0 0 3px 0}#fdbkcontainer input{vertical-align:top}body[dir] #fdbkcontainer input{margin-top:4px}body[dir='ltr'] #fdbkcontainer input{margin-left:0;margin-right:7px}body[dir='rtl'] #fdbkcontainer input{margin-right:0;margin-left:7px}body[dir] #fdbkcontainer .inputwrapper{margin-bottom:12px}#fdbkcontainer #fdbkverbatim{width:100%;box-sizing:border-box;overflow:auto;height:83px;font-size:15px;font-family:'Segoe UI';width:296px;height:62px;color:#999;line-height:16px}body[dir='ltr'] #fdbkcontainer #fdbkverbatim{padding:3px 3px 3px 10px}body[dir='rtl'] #fdbkcontainer #fdbkverbatim{padding:3px 10px 3px 3px}#fdbkcontainer input{font-size:15px}#fdbkcontainer input[type="submit"],#fdbkcontainer input[type="button"]{width:142px;height:35px}#fdbkcontainer input[type="submit"]{background-color:#0078d7;color:#fff;cursor:pointer;border:1px solid #0078d7}body[dir='ltr'] #fdbkcontainer input[type="submit"]{margin-right:12px}body[dir='rtl'] #fdbkcontainer input[type="submit"]{margin-left:12px}#fdbkcontainer input[type="button"]{background-color:#ccc;border:1px solid #ccc;cursor:pointer}#fdbkcontainer #fdbkinternal .small{font-size:9px}#fdbkcontainer #fdbkinternal .medium{font-size:12px}#fdbkcontainer #fdbkinternal a{font-size:15px}body[dir] #fdbkcontainer #fdbkinternal label{margin-top:5px}#fdbkcontainer #fdbkinternal input[type="text"]{width:275px;color:#000;height:25px}body[dir] #fdbkcontainer #fdbkinternal input[type="text"]{margin:0;margin-top:5px}body[dir='ltr'] #fdbkcontainer #fdbkinternal input[type="text"]{padding-left:10px}body[dir='rtl'] #fdbkcontainer #fdbkinternal input[type="text"]{padding-right:10px}#fdbkcontainer #fdbkverbatim.smallverbatim{height:62px}body[dir] #fdbkcontainer .fdbkss{margin-top:5px;margin-bottom:17px}a#fdbklmlink{float:left;clear:left;color:#0078d7}body[dir] a#fdbklmlink{margin-top:7px}body[dir='rtl'] a#fdbklmlink{float:right;clear:right}a#fdbkpplink{float:left;clear:left;color:#0078d7}body[dir='rtl'] a#fdbkpplink{float:right;clear:right}body[dir] div#fdbkinternal{margin-top:5px}</style><style type="text/css">.b_select{background-color:#ffe0b3;border-color:#f90;}</style><script type="text/javascript">//<![CDATA[
var amd,define,require;(function(n){function e(n,i,u){t[n]||(t[n]={dependencies:i,callback:u},r(n))}function r(n){if(n){if(n)return u(n)}else{if(!f){for(var r in t)u(r);f=!0}return i}}function u(n){var o,f;if(i[n])return i[n];if(t.hasOwnProperty(n)){var c=t[n],e=c.dependencies,a=c.callback,l=r,s={},h=[l,s];if(e.length<2)throw"invalid usage";else if(e.length>2)for(o=e.slice(2,e.length),f=0;f<o.length;f++)h.push(u(o[f]));return a.apply(this,h),i[n]=s,s}}var t={},i={},f=!1;n.define=e,n.require=r})(amd||(amd={})),define=amd.define,require=amd.require;var _w=window,_d=document,sb_ie=window.ActiveXObject!==undefined,sb_i6=sb_ie&&!_w.XMLHttpRequest,_ge=function(n){return _d.getElementById(n)},sb_st=function(n,t){return setTimeout(n,t)},sb_ct=function(n){clearTimeout(n)},sb_gt=function(){return+new Date},sj_gx,AjaxWrapper;_w.sj_ce=function(n){return _d.createElement(n)},_w.sk_merge||(_w.sk_merge=function(n){_d.cookie=n}),function(){function t(n,t,i){n.readyState==n.OPENED&&t.apply(n,i)}function h(n,u){return function(){var f=arguments;r(n)||n.readyState!=n.OPENED?(Object.defineProperties(n,{readyState:{get:function(){return 4}},status:{get:function(){return 200}},responseText:{get:function(){return""}},responseBody:{get:function(){return""}}}),n.onreadystatechange&&n.onreadystatechange.apply(n,null)):i(n.url)?ThresholdUtilities.getCortanaHeaders(function(i){if(i)for(var r in i)i.hasOwnProperty(r)&&r.substring(0,2)==="X-"&&n.setRequestHeader(r,i[r]);t(n,u,f)}):t(n,u,f)}}function c(n,t){return function(){n.url=arguments[1],t.apply(n,arguments),e(n)}}function l(n,i){return function(){t(n,i,arguments)}}function i(n){var e=!0,t,i,r;if(u.href=n,t=u.hostname,t&&t.indexOf(".")>0){i=!1;for(r in f)if(t.indexOf(f[r])>0){i=!0;break}i||(e=!1)}return e}function s(n){return function(){return r(n)}}function r(n){return SearchAppWrapper&&SearchAppWrapper.CortanaApp&&!SearchAppWrapper.CortanaApp.isBingEnabled&&i(n.url)}function o(){var n=new XMLHttpRequest;return n.send=h(n,n.send),n.open=c(n,n.open),n.setRequestHeader=l(n,n.setRequestHeader),n.isRequestBlocked=s(n),n}function e(n){typeof _CachedFlights!="undefined"&&_CachedFlights.length&&(n.setRequestHeader("X-MSEdge-ExternalExpType","JointCoord"),n.setRequestHeader("X-MSEdge-ExternalExp",_CachedFlights.join(",")))}var f=[".bing.com",".staging-bing-int.com",".working-bing-int.com",".bing-int.com",".bing-exp.com"],u=document.createElement("a");sj_gx=function(){return o()}}(AjaxWrapper||(AjaxWrapper={}));function lb(){_w.si_sendCReq&&sb_st(_w.si_sendCReq,800),_w.lbc&&_w.lbc()};
//]]></script><script type="text/javascript" src="/rms/BingCore.Bundle/jc/4e3d6870/07801425.js?bu=rms+answers+Shared+BingCore%24shared%2cBingCore%24env.override%2cBingCore%24event.custom.fix%2cBingCore%24event.native%2cBingCore%24dom%2cBingCore%24cookies_parser%2cBingCore%24XHRPrefetch%24rmsajax_xhrprefetch%2cBingCore%24ClientInstV2%24InstrumentationConfigThrdatasources%2cBingCore%24ClientInstV2%24LogUploadCapFeatureDisabled%2cBingCore%24ClientInstV2%24ClientInstConfigSeparateQFQueue%2cBingCore%24ClientInstV2%24clientinst_xls%2cEmpty%2cBingCore%24ClientInstV2%24LogHelper%2cBingCore%24ClientInstV2%24VisibilityChangeEventHelper%2cBingCore%24Animation%2cBingCore%24fadeAnimation%2cBingCore%24framework%2cBingCore%24ShowWebView%2cBingCore%24CoreUtilities"></script><script type="text/javascript">//<![CDATA[
_w.si_ct=function(n,t,i){var u="getAttribute",f,r,o;try{for(;n!==document.body;n=n.parentNode){if(f=n.tagName=="A"&&n[u]("h")||n[u]("_ct")||n[u]("data-h"),f){r=n[u]("_ctf"),r&&_w[r]||(r="si_T"),_w[r]&&_w[r]("&"+f,n,i);break}if(t)break}}catch(e){}return!0},function(){_w._G&&(_G.si_ct_e="click"),sj_be(document,"click",function(n){si_ct(sb_ie?_w.event.srcElement:n.target,!1,_w.event||n)},!1)}();var wlc_d = 1500,wlc_t = 63570477187;;var sj_log=function(n,t,i){var r=new RegExp('"',"g");(new Image).src=_G.lsUrl+'&Type=Event.ClientInst&DATA=[{"T":"'+n+'","FID":"CI","Name":"'+t+'","Text":"'+escape(i.replace(r,""))+'"}]'};_w.si_PP=function(n,t,i){var f,c,r,h,s,a,v,u,y,o,e,l;if(!_G.PPS){for(c=["FC","BC","H","BP",null];f=c.shift();)c.push('"'+f+'":'+(_G[f+"T"]?_G[f+"T"]-_G.ST:-1));if(r=i||_w.performance&&_w.performance.timing,h=null,r&&(s=["unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd","msFirstPaint","responseEnd",""],a=r.navigationStart,a>=0)){for(y=o=v=0;f=s.shift();v++)u=r[f],u>0&&(y|=1<<v,u-=a,s.push(u===o?"":(u-o).toString(16)),o=u);e="navigation",h=',"w3c":"'+y.toString(16)+","+s.join()+'","nav":'+(e in r?r[e]:performance[e].type)}l='{"pp":{"S":"'+(t||"L")+'",'+c.join(",")+',"CT":'+(n-_G.ST)+',"IL":'+_d.images.length+"}"+(_G.C1?","+_G.C1:"")+(h!==null?h:"")+"}",_w.Log2?Log2.LogEvent("CPT",JSON.parse(l)):(_G.PPImg=new Image,_G.PPImg.src=_G.lsUrl+"&Type=Event.CPT&DATA="+l+(_G.P?"&P="+_G.P:"")),_G.PPS=1,sb_st(function(){sj_evt.fire("onPP"),sj_evt.fire(_w.p1)},1)}},_w.onbeforeunload=function(){si_PP(new Date,"A")};(function(n){_w.si_PP=function(t,i){var u=_w.performance&&_w.performance.timing,r;u&&(r='"NS":"'+u.navigationStart+'"',_G.C1=_G.C1?_G.C1+","+r:r),n&&n(t,i)}})(_w.si_PP);_TC={SP:"devicecontent,people411,meetingprep,profile\/interests\/v2,account\/permissions,showtimesth,showmoremoviesth,themebasedlocalrecommendation\/search,transitline,morescholarinfo\/search,tasklineth\/search,events\/search,cabs\/search,cabs\/searchasync,cabs\/book,cabs\/driver,cabs\/driverupdate"};;
//]]></script><script type="text/javascript" src="/rms/SparkleFramework/jc/42426650/e7810346.js?bu=rms+serp+snr%24react-with-addons.min.source%2csnr%24Sparkle.source%2csnr%24Sparkle.React.source%2csnr%24ResourceManagement.source%2csnr%24Array_c.source%2csnr%24string_c.source"></script><script type="text/javascript">//<![CDATA[
var TCH={rTags:["H2"]};(function(){var s=["LI","TR"],rt=["TR"],f=["A"],b=["INPUT","SELECT"],u="getElementsByTagName",v="pressed",p="transition",a="press",l="unpress",nt="b_noTarget",c="b_poleContent",t=" ",n=null,g=function(t){if(!t.defaultPrevented){var i=o(sj_et(t));i&&(r(),t.button===0?(n=i,sj_evt.fire(a,n.c,t)):n=null)}},h=function(n){var i,t;if(n.style.cursor!="pointer")if(i=o(n),i)i.e.style.cursor="pointer";else if(n.children)for(t=0;t<n.children.length;t++)h(n.children[t])},d=function(t){if(!t.defaultPrevented&&t.button===0){var i=sj_et(t);n&&i===n.e||(r(),n=!n||sj_we(n.e,i)?null:o(i)),n&&n.cl&&(_w._G&&_G.si_ct_e==="click"||si_ct(n.l),n.l.click())}},r=function(){n&&sj_evt.fire(l,n.c)},it=function(n){var t=n[1];t.classList.add(p),t.classList.add(v)},tt=function(n){var t=n[1];t.classList.remove(v)},o=function(n){var h=i(n,f),t={e:n,c:h,l:h,cl:!0},v=i(n,b),r,o,a,l;if(v)t=null;else if(r=i(n,s,c),r){if(o=e(r),!o&&rt.indexOf(r.tagName)>=0&&(r=i(r.parentNode,s,c),o=e(r)),!o&&r)for(a=_w.TCH.rTags,l=0;l<a.length;l++)if(o=w(r[u](a[l])),o)break;o&&(!h||o===h)&&(t={e:n,c:r,l:o,cl:!0})}return t&&!t.l&&(t=null),t&&(y(t.l,n)||t.l===t.e)&&(t.cl=!1),t},y=function(n,t){var r,i;if(t)for(r=n[u](t.tagName),i=0;i<r.length;i++)if(r[i]===t)return!0;return!1},w=function(n){for(var t=null,r,i=0;i<n.length;i++)if(r=e(n[i]),r)if(t){if(r.href!==t.href){t=null;break}}else t=r;else if(n[i][u](f).length>1){t=null;break}return t},k=function(n){return n&&n.className.indexOf(nt)<0},e=function(n){var o=null,t;if(n){var i=n[u](f),h=i.length,s=!0,e=null,r=null;for(t=0;t<h;t++)if(k(i[t]))if(r){if(r!==i[t].href){s=!1;break}}else e=i[t],r=i[t].href;s&&r&&(o=e)}return o},i=function(n,i,r){for(;n!==document&&n;n=n.parentNode)if(n)for(var u=0;u<i.length;++u)if(n.tagName===i[u]||r&&n.className&&(t+n.className+t).indexOf(t+r+t)>=0)return n};sj_be(_d,"mousedown",g),sj_be(_d,"mouseup",r),sj_be(_d,"dragleave",r),sj_be(_d,"click",d),sj_be(_w,"load",function(){return h(sj_b)}),sj_evt.bind(a,it),sj_evt.bind(l,tt)})();var HitHighlightingParser;(function(n){function t(n,t,u){var o,e,f;if(t=t?t:0,u=u?u:n.length,t===u)return n;for(o=[],f=t;f<u;f++)e=n.charAt(f),e!==r&&e!==i&&o.push(e);return o.join("")}function u(n){var u;if(!n)return[];var e=[],o=!1,s=!1,f=0;for(u=0;u<=n.length;++u)o?n[u]===i&&(u-f>0&&e.push({text:t(n,f,u),highlighted:!0}),o=!1,f=u+1):n[u]===r&&(u-f>0&&e.push({text:t(n,f,u),highlighted:!1}),o=!0,f=u+1);return f!==n.length&&e.push({text:f===0?n:t(n,f),highlighted:!1}),e}var r=String.fromCharCode(57344),i=String.fromCharCode(57345);n.RemoveHitHighlighting=t,n.split=u})(HitHighlightingParser||(HitHighlightingParser={}));var HtmlHitHighlightingEncoder=function(){function n(){this.strongView=Sparkle.resolveView("strong")}return n.prototype.writeContent=function(n,t){var i,r,f,u;if(typeof n=="string"){i=HitHighlightingParser.split(n);for(r in i)f=i[r].text,i[r].highlighted&&(u=Sparkle.copyContext({},{}),u.defaultSegment.push(i[r].text),f=this.strongView.renderView(u)),t.push(f)}else t.push(n)},n.prototype.writeAttribute=function(n){return typeof n=="string"?HitHighlightingParser.RemoveHitHighlighting(n):n},n.prototype.writeUnencodedContent=function(n){var t,r,i;if(typeof n=="string"){t=HitHighlightingParser.split(n),r=[];for(i in t)t[i].highlighted?r.push("<strong>"+t[i].text+"<\/strong>"):r.push(t[i].text);return r.join("")}return n},n}();
//]]></script></head><body onload="if(_w.lb)lb();"><script type="text/javascript">//<![CDATA[
var ThresholdDiagnosticsProd=function(){function n(){}return n.prototype.recordApiString=function(n){console.log(n)},n}();_w.ThresholdDiagnostics=new ThresholdDiagnosticsProd;var CoreUtilities;(function(n){function i(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return t.apply(null,[null,n].concat(r))}function t(n,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return function(){for(var i=[],f,u=0;u<arguments.length;u++)i[+u]=arguments[u];if(i&&i.length!==0)for(f in r)r.hasOwnProperty(f)&&i.push(r[f]);else i=r;return t.apply(n,i)}}n.deferFunction=i,n.deferMethod=t,window.sj_df=i,window.sj_dm=t})(CoreUtilities||(CoreUtilities={}));var FailedPromise=function(){function n(){this.isActive=!0,this.operation=null}return n.prototype.then=function(n,t){return this.handleError(t),this},n.prototype.done=function(n,t){this.handleError(t)},n.prototype.handleError=function(n){this.isActive&&n&&_w.setImmediate(function(){return n(null)})},n.prototype.cancel=function(){this.isActive=!1},n}(),ThresholdUtilitiesM2=function(){function n(){this.regExes={},this.guidCleaner=/[-{}]/g,this.ampersandSanitizer=/&+$|((\?|&|#)&+)/g,this.isFirstPageStart=!0,this.startTime=_w.performance?_w.performance.timing.navigationStart:si_ST,this.apiSequenceNumber=0,this.headersAsyncPromise=null,this.headersCallComplete=!1,this.cortanaHeaders=null,this.themeColor=null,this.headersCallTimeout=3e3,this.headersCallbacks=[],this.langArray=["ar","dv","fa","he","ku-arab","pa-arab","prs","ps","sd-arab","syr","ug","ur","qps-plocm"],sj_evt.bind("ajax.threshold.pageStart",sj_dm(this,this.onPageStart),1)}return n.prototype.getUrlParameter=function(n,t){for(var r=null,f=this.getParameterRegex(t),u,i,e=0;u=f.exec(n);)i=u;return i&&i.length>=2?r=i[1]:t==="mock"&&(r=this.getMockParameter(n)),r},n.prototype.setUrlParameter=function(n,t,i){var f=n,u=this.getParameterRegex(t).exec(n),r="&",s,o,e;return u?(r=u[0].substring(0,1),s=u.index,o=u.index+u[0].length,f=n.substring(0,s),i&&(f+=r+t+"="+i),f+=n.substring(o)):i&&(e=this.getRegex("devicecontent"),e.test(n)?n.indexOf("#")<0&&(r="#"):n.indexOf("?")<0&&(r="?"),f=n+r+t+"="+i),f},n.prototype.getDecodedQuery=function(n){var i=n,t;return i||(i=_w.location.href),t=this.getUrlParameter(i,"q"),t&&(t=decodeURIComponent(t.replace(this.getRegex("\\+")," ")).trim()),t},n.prototype.getUrlReadyQuery=function(n){return encodeURIComponent(n).replace(this.getRegex("%20"),"+")},n.prototype.recordApiTimeDetail=function(n,t,i){var e=new Date,o,r,f,u;if(n&&(_G.ApiTimes=_G.ApiTimes||{},_G.ApiTimes[n]=e.getTime()-this.startTime),i){o={};for(r in i)i.hasOwnProperty(r)&&(o[r]=i[r]);i=o,i.time=e}else i={time:e,label:n||t,sequence:this.apiSequenceNumber++};return f=_w.msWriteProfilerMark,u=i.sequence+","+(n||i.label),f&&f(u),_w.performance&&performance.mark&&performance.mark(u),i},n.prototype.recordApiTime=function(n){return this.recordApiTimeDetail(n),null},n.prototype.uploadApiTimes=function(n){var t=_G.ApiTimes;this.recordApiTime(n),t&&typeof Log2!="undefined"&&Log2&&(Log2.LogEvent("CPT2",{wt:t}),_G.ApiTimes={})},n.prototype.wrapSynchronousApiCall=function(n,t,i,r){for(var h=this,s=[],o,e,f,u=4;u<arguments.length;u++)s[u-4]=arguments[u];o=this.recordApiTimeDetail(i?i+"S":null,t),f=function(n,u){var e=h.recordApiTimeDetail(i?i+n:null,t,o),f=u?" exception: "+u.stack:"";h.recordApiString("ApiEnd "+n+' \t"'+(r?r:"")+'"\t'+t+"("+s.join(", ")+")\t"+(e.time.getTime()-o.time.getTime())+"ms elapsed"+f)};try{e=n[t].apply(n,s),f("C")}catch(c){f("E",c),SharedLogHelper.LogError("Exception","Failed while calling overrideMethod: "+t,c),e=null}return e},n.prototype.wrapApiCall=function(){for(var f=[],e,u=4;u<arguments.length;u++)f[u-4]=arguments[u];for(f=[],e=0;e<arguments.length;e++)f.push(arguments[e]);return f.splice(4,0,0,null),this.wrapApiCallWithTimeout.apply(this,f)},n.prototype.wrapApiCallWithTimeout=function(n,t,i,r,u,f){for(var c=[],l,s=6;s<arguments.length;s++)c[s-6]=arguments[s];if(_w.SearchAppWrapperLogging)return n[t].apply(n,c);var v=this,a=this.recordApiTimeDetail(i?i+"S":null,t),e,o,h=function(n,u){var e="stack",o=v.recordApiTimeDetail(i?i+n:null,t,a),f=u&&u[e]?" exception: "+u[e]:"";u&&f===""&&(f=" Windows error: "+u.message),v.recordApiString("ApiEnd "+n+' \t"'+(r?r:"")+'"\t'+t+"("+c.join(", ")+")\t"+(o.time.getTime()-a.time.getTime())+"ms elapsed"+f)};try{o=n[t].apply(n,c),u&&u>0&&(e=sb_st(function(){o&&o.cancel&&o.cancel(),h("T"),f&&f(null)},u)),o.then(function(n){return e&&sb_ct(e),h("C"),n},function(n){e&&sb_ct(e),h("E",n),SharedLogHelper.LogError("Exception","Failed in overrideMethod callback: "+t,n),f&&f(null)})}catch(y){e&&sb_ct(e),h("E",y),SharedLogHelper.LogError("Exception","Failed while calling overrideMethod: "+t,y),l=new FailedPromise,o=l.then(null,f)}return o},n.prototype.cleanGuid=function(n){var t=n;return t&&(t=t.replace(this.guidCleaner,"")),t},n.prototype.parseJSON=function(n){var i,t=null;if(n)try{i=JSON.parse(n)}catch(r){t=r}return i||console.log("Unable to parse JSON input: "+n+(t?".  Exception: "+t:"")),i},n.prototype.getCortanaHeaders=function(n){var f=this,i,u;if(this.headersCallComplete){n(this.cortanaHeaders);return}if(!this.headersAsyncPromise){i=null,u=!1;function e(){i&&(sb_ct(i),i=null),f.headersCallComplete=!0}function r(n){var i,r,t;if(!u)for(i=f.headersCallbacks,r=i.length,t=0;t<r;t++)i[t](n)}function s(n){e(),f.cortanaHeaders=n,r(n)}function o(){e(),r(null)}i=sb_st(function(){r(null),u=!0},this.headersCallTimeout),this.headersAsyncPromise=this.wrapApiCall(SearchAppWrapper.CortanaApp,"getQueryHeadersAsync","GQH_","getQueryHeaders").then(s,o)}this.headersCallbacks.push(n)},n.prototype.getThemeColor=function(n){function i(n){var i,t;this.themeColor==null&&n&&(i=n["X-BM-Theme"],i&&(t=i.split(";")[1],t&&t!=this._accentColor&&(r.themeColor="#"+t)))}var u=this,r=this;this.themeColor===null?this.getCortanaHeaders(function(t){i(t),n(u.themeColor)}):n(this.themeColor)},n.prototype.setBodyLangAttributes=function(n){_d.body.setAttribute("dir",this.langArray.some(function(t){return n=n.toLocaleLowerCase(),n==t||n.indexOf(t+"-")==0})?"rtl":"ltr"),_d.body.setAttribute("lang",n)},n.prototype.getEmptyTaskFrame=function(n){return{CustomTaskFrame:!0,Status:"InProgress",Uri:"action://FindMyStuff/FindDocument",TypeId:"b89d219d-7b61-48e7-8f3c-367e4a0e631b",RawTextQuery:{Uri:"entity://TextData",TypeId:"ae77cbd2-cf71-438c-95b4-d3b86dc4a60e",State:"Filled",Source:"Unknown",ClientUpdate:!1,Value:n,ProfanityMasked:n}}},n.prototype.recordApiString=function(n){ThresholdDiagnostics.recordApiString(n)},n.prototype.pushOntoArray=function(n,t){if(n&&t)for(var i in t)n.push(t[i])},n.prototype.navigateTo=function(n,t){var i=sj_ce("a","b_hide");i.href=n,i.setAttribute("data-h",t.GetNamespacedKValue()),_d.body.appendChild(i),i.click()},n.prototype.getParameterRegex=function(n){return this.getRegex("[?&#]"+n.toLowerCase()+"=([^&#]*)")},n.prototype.getRegex=function(n,t,i){var r=this.regExes[n];return r||(r=new RegExp(n,(i?"":"g")+(t?"":"i")),this.regExes[n]=r),r.lastIndex=0,r},n.prototype.getMockParameter=function(n){var u=null,f=null,t=n.indexOf("#"),r,i;return t>0&&t<n.length-1&&(r=n.substr(t+1).split("&"),i=r.filter(this.unlabeledParameterFilter),i.length>0&&(u=i[0])),u},n.prototype.unlabeledParameterFilter=function(n){return n.indexOf("=")<0},n.prototype.clearLocalCache=function(){this.cortanaHeaders=null,this.themeColor=null,this.headersAsyncPromise=null,this.headersCallComplete=!1,this.headersCallbacks=[]},n.prototype.onPageStart=function(n){console.log("onPageStart"),!this.isFirstPageStart&&n[1]&&(this.startTime=n[1],this.clearLocalCache()),this.isFirstPageStart=!1,sj_evt.fire("ajax.postload")},n}();_w.ThresholdUtilities=new ThresholdUtilitiesM2,sj_evt.bind("threshold.pageUnload",function(){sj_evt.fire("unload")},0);var SearchAppWrapper={CortanaApp:_w.CortanaApp,Utils:ThresholdUtilities};var sj_b=_d.body;var AsyncStatus,AppViewSizePreference,DeviceFolders,PerfMetricKey,TargetScope,TargetPivot,DestinationApp,SearchMode,OpCode,WebViewLifetimeState,ChromeState,SearchQuerySortType,Provider,IndexedState;(function(n){n[n.Started=0]="Started",n[n.Completed=1]="Completed",n[n.Canceled=2]="Canceled",n[n.Error=3]="Error"})(AsyncStatus||(AsyncStatus={})),function(n){n[n.Default=0]="Default",n[n.UseHalf=1]="UseHalf",n[n.UseFull=2]="UseFull"}(AppViewSizePreference||(AppViewSizePreference={})),function(n){n[n.Apps=0]="Apps",n[n.Settings=1]="Settings",n[n.Files=2]="Files",n[n.Music=3]="Music",n[n.PicturesAndVideos=4]="PicturesAndVideos"}(DeviceFolders||(DeviceFolders={})),function(n){n[n.Default=0]="Default",n[n.CortanaAppStarted=1]="CortanaAppStarted",n[n.QueryInvoke=2]="QueryInvoke",n[n.DeviceQueryStarted=3]="DeviceQueryStarted",n[n.AppsQueryFinished=4]="AppsQueryFinished",n[n.FileQueryFinished=5]="FileQueryFinished",n[n.MusicQueryFinished=6]="MusicQueryFinished",n[n.PicturesAndVideoQueryFinished=7]="PicturesAndVideoQueryFinished",n[n.SettingsQueryFinished=8]="SettingsQueryFinished",n[n.LocalHistoryQueryFinished=9]="LocalHistoryQueryFinished",n[n.QueryFormulationShown=10]="QueryFormulationShown",n[n.QueryFormulationInit=11]="QueryFormulationInit",n[n.QueryFormulationCacheLoadStart=12]="QueryFormulationCacheLoadStart",n[n.QueryFormulationCacheLoadStop=13]="QueryFormulationCacheLoadStop",n[n.SrvLaunchFromQF=14]="SrvLaunchFromQF",n[n.SrvStarted=15]="SrvStarted",n[n._deprecated_SearchGlyphClicked=16]="_deprecated_SearchGlyphClicked",n[n._deprecated_SrvProtocolLaunch=17]="_deprecated_SrvProtocolLaunch",n[n.MediaQueryFinished=18]="MediaQueryFinished",n[n.WindowsSearchEmailQueryFinished=19]="WindowsSearchEmailQueryFinished",n[n.PicturesQueryFinished=20]="PicturesQueryFinished",n[n.VideoQueryFinished=21]="VideoQueryFinished",n[n.OemQueryFinished=22]="OemQueryFinished",n[n.ReactiveAgentsQueryFinished=23]="ReactiveAgentsQueryFinished",n[n.PathCompletionQueryFinished=24]="PathCompletionQueryFinished",n[n.ProactiveQueryStarted=25]="ProactiveQueryStarted",n[n.CommandLineQueryFinished=26]="CommandLineQueryFinished",n[n.PathCompletionQueryStarted=27]="PathCompletionQueryStarted",n[n.CommandLineQueryStarted=28]="CommandLineQueryStarted",n[n.QueryBuilderSlotsStarted=29]="QueryBuilderSlotsStarted",n[n.LocationSlotFinished=30]="LocationSlotFinished",n[n.PeopleSlotFinished=31]="PeopleSlotFinished",n[n.QueryFormulationFallback=32]="QueryFormulationFallback",n[n.MyStuffFallback=33]="MyStuffFallback"}(PerfMetricKey||(PerfMetricKey={})),function(n){n[n.Cat1=0]="Cat1",n[n.Cat3=1]="Cat3",n[n.MyStuff=2]="MyStuff"}(TargetScope||(TargetScope={})),function(n){n[n.Default=0]="Default",n[n.Apps=1]="Apps",n[n.Settings=2]="Settings",n[n.Music=3]="Music",n[n.PicturesAndVideo=4]="PicturesAndVideo",n[n.Files=5]="Files",n[n.Emails=6]="Emails"}(TargetPivot||(TargetPivot={})),function(n){n[n.Settings=0]="Settings",n[n.Documents=1]="Documents",n[n.Photos=2]="Photos",n[n.Videos=3]="Videos",n[n.Music=4]="Music",n[n.Email=5]="Email",n[n.Folder=6]="Folder",n[n.All=255]="All"}(DestinationApp||(DestinationApp={})),function(n){n[n.MyStuff=0]="MyStuff",n[n.Web=1]="Web"}(SearchMode||(SearchMode={})),function(n){n[n.Info=0]="Info",n[n.Start=1]="Start",n[n.Stop=2]="Stop"}(OpCode||(OpCode={})),function(n){n[n.AppHidden=0]="AppHidden",n[n.AppVisible=1]="AppVisible",n[n.WebViewVisible=2]="WebViewVisible"}(WebViewLifetimeState||(WebViewLifetimeState={})),function(n){n[n.NoHeader=0]="NoHeader",n[n.StandardSmall=1]="StandardSmall",n[n.StandardMedium=2]="StandardMedium"}(ChromeState||(ChromeState={})),function(n){n[n.SearchQuerySort_Default=0]="SearchQuerySort_Default",n[n.SearchQuerySort_NameLowerToUpper=1]="SearchQuerySort_NameLowerToUpper",n[n.SearchQuerySort_NameUpperToLower=2]="SearchQuerySort_NameUpperToLower",n[n.SearchQuerySort_RecentToOldest=3]="SearchQuerySort_RecentToOldest",n[n.SearchQuerySort_OldestToRecent=4]="SearchQuerySort_OldestToRecent",n[n.SearchQuerySort_Max=5]="SearchQuerySort_Max"}(SearchQuerySortType||(SearchQuerySortType={})),function(n){n[n.Microsoft=0]="Microsoft",n[n.OEM=1]="OEM"}(Provider||(Provider={})),function(n){n[n.Unknown=0]="Unknown",n[n.NotIndexed=1]="NotIndexed",n[n.PartiallyIndexed=2]="PartiallyIndexed",n[n.FullyIndexed=3]="FullyIndexed"}(IndexedState||(IndexedState={}));_G.AppVer="8_01_2_4079551";(function(){function u(n){return function(){var t=sb_gt();sj_evt.bind("directNavComplete",r(t,n),!0)}}function r(n,t){return function(){Log2.LogEvent("Load",{status:t,TS:n},"AppCache")}}var i=["cached","checking","downloading","error","noupdate","obsolete","updateready"],f=_w.applicationCache,t,n;for(t in i)n=i[t],sj_be(f,n,u(n))})();var sa_config ={"th":false};;if(!_w["ViewResolver"]) {var ViewResolver = {};};var sa_acConfig = "d03c1acc";;var AppCacheState;(function(n){function r(){return t}function i(){if(t){var i=sj_cook.get("SRCHHPGUSR","IAC"),n="";i&&i!==""?i.indexOf(t)<0&&(n=t+","+i):n=t,n!==""&&sj_cook.set("SRCHHPGUSR","IAC",n,!0,"/")}}var u=sb_gt().toString(),t;sj_cook.set("_SS","CPID",u,!1,"/"),t=_w.sa_acConfig,t&&sj_cook.set("_SS","CPH",t,!1,"/"),n.GetAppCacheVersion=r,n.MarkAppCacheVersionAsInvalid=i})(AppCacheState||(AppCacheState={}));var _CachedFlights =["d-thshld39","d-thshldspcl40","mystuffqu"];;
//]]></script><div id="b_content"></div><script type="text/javascript">//<![CDATA[
_G.FCT=new Date;
//]]></script><script type="text/javascript">//<![CDATA[
_G.BCT=new Date;
//]]></script><script type="text/javascript">//<![CDATA[
(function(){function r(i){var r,u;i&&(r=t(i),_w.Log2&&(Log2.LogEvent(r.eventType,r.data),n()&&(sj_evt.fire("visibility",document.hidden),_w.ThresholdUtilities&&(u=_w.ThresholdUtilities,u.uploadApiTimes("PCE")),_w.ClickConfig&&ClickConfig.FlushSkipAbort?Log2.FlushMainQueueDontForce():Log2.ForceFlush(),_w.clickFlushedTime=sb_gt())))}function n(){for(var n=_w.event.srcElement;!n.href;)if(n.parentElement)n=n.parentElement;else return!1;return n.href.split("#")[0]!==_d.URL.split("#")[0]?!0:!1}function t(n){var t=n.match(i);return{eventType:"Click",data:{AppNS:t[1],K:t[2]}}}var i=/ID=(\w+),(\d+(?:\.\d+)*)/i;_w.si_T=r})();function cpHandler(){_d.cookie="CPR=0;path=/",_d.cookie="IPH="+_G.IP+";path=/";var n=_d.createElement("iframe");n.src="/fd/sa/cp.html",n.style.display="none",_d.body.appendChild(n)}sj_evt.bind("onP1",cpHandler,1,1500);define("onHTML",["require","exports","event.custom"],function(n,t,i){i.fire("onHTML")});_w.keyMap={Content:"b_content",SearchForm:"sb_form",SBoxId:"sb_form_q",Notification:"b_notificationContainer",Identity:"id_h",Prefix:"b_",RmsDefer:"aRmsDefer",RmsKeys:["rms:answers:Shared:BingCore.Bundle","rms:answers:AjaxSerp:Ajax.Bundle","rms:answers:BoxModel:Framework"],AutoSug:"sa_as",FeaturePersist:1};_G.JCache&&(_G.SRF=document.getElementById(keyMap.SearchForm)&&document.getElementById(keyMap.SearchForm).outerHTML,_G.CNT=document.getElementById(keyMap.Content)?document.getElementById(keyMap.Content).outerHTML:document.getElementById("sw_content").outerHTML);
//]]></script><script type="text/javascript" src="/rms/Ajax.Bundle/jc/e2d6f5b9/afad0936.js?bu=rms+answers+AjaxSerp+Core%24ajax.shared%2cThreshold%24ajax.history.threshold%2cCore%24ajax.render%2cCore%24ajax.providers%2cCore%24ajax.lifeCycle%2cCore%24Providers%24ajax.provider.threshold"></script><script type="text/javascript">//<![CDATA[
(function(n,t){onload=function(){_G.BPT=new Date,n&&n();var r=new Date,i=function(){t(r),sj_evt.unbind("ajax.threshold.pageStart",i)};sj_evt.bind("ajax.threshold.pageStart",i),_w.si_PP=function(){},sb_st(function(){sj_evt.fire("onPP"),sj_evt.fire(_w.p1)},0)}})(_w.onload,_w.si_PP);sj_be(_d,"mousewheel",function(n){n.ctrlKey==!0&&sj_pd(n)}),sj_be(_d,"keydown",function(n){n.ctrlKey==!0&&(n.keyCode==107||n.keyCode==109||n.keyCode==187||n.keyCode==189)&&sj_pd(n)});var AppInst;(function(n){function o(r,u,f,o,s){var c,h,l;s===void 0&&(s=!0),c="",r&&(h=r.match(e),h&&h.length>=3&&(c=h[1],l=h[2],f===1&&o||n.layoutJson.push({T:"L.MI",Action:"Update",AppNS:c,K:l,V:"1"}))),u&&n.datasourceJson.push({T:"D.MI",Action:"Update",AppNS:c,K:u,InstallState:i(f)}),s&&t()}function i(n){switch(n){case 0:return"Installed";case 1:return"NotInstalled";default:return"Unknown"}}function r(){return f++}function t(){var t=[];n.layoutJson.length>0&&(t.push({Page:n.layoutJson}),n.layoutJson=[]),n.datasourceJson.length>0&&(t.push(n.datasourceJson),n.datasourceJson=[]),t.length>0&&u(JSON.stringify(t))}function u(n){if(n)if(_w.Log2)Log2.LogEvent("ClientInst",JSON.parse(n));else{var i=sb_gt(),r="<E><T>Event.ClientInst<\/T><IG>"+_G.IG+"<\/IG><TS>"+i+"<\/TS><D>"+n+"<\/D><\/E>",u="<ClientInstRequest><Events>"+r+"<\/Events><STS>"+i+"<\/STS><\/ClientInstRequest>",t=sj_gx();t.open("POST","/fd/ls/lsp.aspx",!0),t.setRequestHeader("Content-Type","text/xml"),t.send(u)}}var e=/ID=([\w]+),([\d]+\.[\d]+)/i,f=1,s;n.layoutJson=[],n.datasourceJson=[],function(n){n[n.Installed=0]="Installed",n[n.NotInstalled=1]="NotInstalled"}(n.InstallState||(n.InstallState={})),s=n.InstallState,n.queueServerAppLog=o,n.getUniqueId=r,n.submitLog=t})(AppInst||(AppInst={}));var AppApi;(function(n){function e(n,t){i[n]||(i[n]=t)}function l(n){var r,i;if(t&&n&&(r=t[n.id],r))for(i=0;i<r.length;++i)s(r[i],n)}function s(n,t){var c=Boolean(n.getAttribute("data-hideIfNotInstalled")),l,v,r,o;if(f&&(l=!1,v=t.installed?0:1,AppInst.queueServerAppLog(n.getAttribute("h"),n.getAttribute("data-appInfoDsK"),v,c,l)),r=n.getAttribute("data-controlName"),r&&(o=i[r],o)){var y=n.getAttribute("data-minVersion"),p=n.getAttribute("data-additionalProps"),s=t.installedAppVersion?u(t.installedAppVersion):null,e=y?u(y):null,a={appElement:n,appInfo:t,installedVersion:s,requiredMinVersion:e,updateRequired:e&&s?h(s,e)<0:!1,updateAvailable:t.updateAvailable,hideIfNotInstalled:c,additionalProps:null};try{a.additionalProps=p?JSON.parse(p):null,o(a)}catch(w){Log.Log("Error","AppApi","Handler_"+r,!1,"Tx",w.message)}t.installed&&c&&n.classList.remove("b_hide")}}function c(){var e,f,r,n,i,u;if(!t)for(t={},e="data-appid",f=_d.querySelectorAll("["+e+"]"),r=0;r<f.length;r++)n=f[r],n&&(i=n.getAttribute(e),i&&(u=t[i],u?u.push(n):t[i]=[n]))}function v(n,t,i,u){var e,o,f;n.setAttribute("href",u),e=r(t.parentElement,"[data-launchappid='"+i+"']"),e&&(o="h",f=e.getAttribute(o),f&&f.length>0&&n.setAttribute(o,f))}function a(n){var i=r(n.parentElement,"[data-linkRole='Upgrade']"),t;i&&(t=i.getAttribute("h"),t&&n.setAttribute("h",t))}function o(n){if(n){c();for(var t=0;t<n.length;++t)l(n[t])}f&&AppInst.submitLog()}function u(n){return n.split(".").map(function(n){return Number(n)})}function h(n,t){for(var u=Math.min(n.length,t.length),r,i=0;i<u;i++)if(r=n[i]-t[i],r!=0)return r;return n.length-t.length}function r(n,t){return n.querySelector(t)}n.AddControlHandler=e;var i={},t=null,f=typeof AppInst!="undefined";n.setLaunchLink=v,n.instrumentUpgradeLink=a,n.UpdateAppInfo=o})(AppApi||(AppApi={}));var CachedDeviceItems={},SmartSearch;(function(){function u(){sj_evt.fire("NavigationComplete")}function l(n,f){var ot=!0,h,lt,tt,y,ft,d,l,ut,rt,it,nt,et,k,s;if(n){var p=SearchAppWrapper.Utils,st=n.pathname,b=n.hostname,g=n.protocol,vt=n.search,at=n.hash;if(i&&e||a(),h=n.href,g.toLowerCase()==="javascript:")return;if(lt=_w.location,st.toLowerCase()===_w.location.pathname.toLowerCase()&&vt.toLowerCase()===_w.location.search.toLowerCase()&&at.toLowerCase()===_w.location.hash.toLowerCase())SharedLogHelper.LogWarning("SelfNavigate");else if(h){b||(b=i);var ht=(!g||g.indexOf("http")===0)&&(b===i||b===location.hostname),ct=w(st,b,ht),c=o.launcher;switch(ct){case 5:k=h.indexOf("?")===-1?"?":"&",h+=k+"persona=0";case 3:tt="navigateWebViewAsync",o[tt]?p.wrapApiCallWithTimeout(o,tt,r(tt),h,t,null,h).done(u):ot=!1;break;case 0:y=null,ft=n.getAttribute("data-appcontext"),ft&&(y=c.createAppLaunchOptions(),y.appContext=ft),d=n.getAttribute("data-appid"),d&&(l=CachedDeviceItems[d],l?(s="launchSearchItemAsync",ut=y?p.wrapApiCallWithTimeout(c,s,r(s),l.id,t,null,l,y):p.wrapApiCallWithTimeout(c,s,r(s),l.id,t,null,l),ut.done(u)):(rt=n.getAttribute("data-itemtype"),s=rt&&rt==="settings"?"findSettingsAsync":"findAppsAsync",p.wrapApiCallWithTimeout(o.searchResultsView.deviceSearch,s,r(s),"Navigation",t,null,[d]).then(sj_df(v,y))));break;case 4:it=n.getAttribute("data-experiencename"),it&&SearchAppWrapper.CortanaApp.launchExperienceByName(it,null);break;case 2:nt=n.getAttribute("data-dest"),nt&&(et=n.getAttribute("data-provider"),et?c.launchSearchInApp(nt,ThresholdUtilities.getDecodedQuery(_w.location.toString()),et):c.launchSearchInApp(nt,ThresholdUtilities.getDecodedQuery(_w.location.toString())),u());break;case 1:ht&&(n.protocol=e,n.hostname=i,n.port=e==="https:"?"443":"80",g=n.protocol,h=n.href,k=h.indexOf("?")===-1?"?":"&",h+=k+"ts="+sb_gt(),_G.nclid&&(h+="&nclid="+_G.nclid)),s="launchUriAsync",p.wrapApiCallWithTimeout(c,s,r(s),"Navigation",t,null,h).then(u)}}}f&&ot&&f.preventDefault()}function r(n){return n.match(y).join("").toUpperCase()}function v(n,i){var o,f,e;if(n!=null)for(o in n)if(f=n[o],f&&f.id){e="launchSearchItemAsync",SearchAppWrapper.Utils.wrapApiCallWithTimeout(SearchAppWrapper.CortanaApp.launcher,e,r(e),null,t,null,f,i).then(u);break}}function w(n,t,i){if(i&&h(n))return n==="search"||n==="/search"?5:3;if(t==="ms-smartsearch"){if(n==="app"||n==="/app")return 0;if(n==="searchInApp"||n==="/searchInApp")return 2;if(n==="experience"||n==="/experience")return 4}return 1}function p(n){if(!n.defaultPrevented){var i=n.target,t=c(i,"A");t&&l(t,n)}}function c(n,t){for(;n&&n!==document;n=n.parentNode)if(n.tagName===t)return n}function h(n){var i=_TC,t,r;for(!f&&i&&i.SP&&(f=i.SP.split(","));n.indexOf("/")===0;)n=n.substring(1);for(t=0;t<f.length;t++)if(r=f[t].length>0?n.toLowerCase().indexOf(f[t])===0:n==="",r)return!0;return!1}function a(){if(_w._TH_BU){var n=_TH_BU.split("//",2);if(n.length===2){e=n[0],i=n[1];return}}e=location.protocol,i=location.hostname}var o=SearchAppWrapper.CortanaApp,f=null,e=null,i=null,t=100,y=/(^.)|([A-Z])/g,s;sj_be(_w,"click",p),function(n){n[n.App=0]="App",n[n.Web=1]="Web",n[n.Explore=2]="Explore",n[n.Navigation=3]="Navigation",n[n.Experience=4]="Experience",n[n.Search=5]="Search"}(s||(s={}))})(SmartSearch||(SmartSearch={}));(function(){var f="data-appid",n,r,t,i,u;if(typeof AppApi!="undefined"&&typeof AppApi.UpdateAppInfo!="undefined"){for(n=[],r=document.querySelectorAll("["+f+"]"),t=0;t<r.length;t++)i=r[t].getAttribute(f),n.indexOf(i)<0&&n.push(i);u=function(t){var f=[],e,i,r,u;for(e in n)i=n[e],t.hasKey(i)&&(r=t[i],r&&(u={id:i,installedAppVersion:r.version,installed:!0},f.push(u),CachedDeviceItems&&!CachedDeviceItems[i]&&(CachedDeviceItems[i]=r)));AppApi.UpdateAppInfo(f),ThresholdUtilities.uploadApiTimes("ALR")},n.length>0&&SearchAppWrapper.Utils.wrapApiCall(SearchAppWrapper.CortanaApp.searchResultsView.deviceSearch,"findAppsAsync","AL","AppLinking",n).then(u)}})();var LocStringManager,WindowsCultureResolver;(function(n){function h(n,t){if(!n)throw"locStringKey is null";if(!t)throw"locString is null";var s=n.namespace,f=i(s)||c(s),u=n.name,h=r(u,f)||o(u,f);e(n.uiCulture,t,h)}function s(n){var o,h,s,c,e,u;if(!n)throw"locStringKey is null";if(o=n.namespace,h=i(o),!h)throw"namespace "+o+" is not registered";if(s=n.name,c=r(s,h),!c)throw"name "+s+" is not registered in namespace "+o;for(e=n.uiCulture;!u;)if(u=f(e,c),u||e)u||(e=t.resolveCulture(e));else throw"the invariant empty culture does not have parent";return u}function l(n){if(!n)throw"parentCultureResolver is null";n.parentParentCultureResolver=t,t=n}function i(n){if(!n)throw"namespace in locStringKey is null";return u[n]}function c(n){if(!n)throw"namespace in locStringKey is null";return u[n]={}}function r(n,t){if(!n)throw"name in locStringKey is null";return t[n]}function o(n,t){if(!n)throw"name in locStringKey is null";return t[n]={}}function e(n,t,i){if(typeof n=="undefined"||n===null)throw"uiCulture in locStringKey is null";i&&(i[n.toLowerCase()]=t)}function f(n,t){if(typeof n=="undefined"||n===null)throw"uiCulture in locStringKey is null";return t?t[n.toLowerCase()]:null}var u={},t={parentParentCultureResolver:null,resolveCulture:function(n){if(!n)throw"culture is null";var t=n.lastIndexOf("-");return t>0?n.substring(0,t):""}};n.register=h,n.getLocString=s,n.addParentCultureResolver=l})(LocStringManager||(LocStringManager={})),function(){var i={as:"as-in",bs:"bs-latn-ba","fil-latn":"fil-ph","gd-latn":"gd-gb","ig-latn":"ig-ng","ky-cyrl":"ky-kg","mi-latn":"mi-nz",ml:"ml-in","mn-mn":"mn-cyrl",nb:"nb-no",nn:"nn-no",or:"or-in","prs-arab":"prs-af","quc-latn":"qut","tk-latn":"tk-tm","tt-cyrl":"tt-ru","uz-latn":"uz-latn-uz","yo-latn":"yo-ng","zh-cn":"zh-chs","zh-hant-hk":"zh-cht","zh-hant-mo":"zh-cht","zh-hant-tw":"zh-cht","zh-hans-cn":"zh-chs","zh-hans-sg":"zh-chs","zh-hk":"zh-cht","zh-tw":"zh-cht"},t={parentParentCultureResolver:null,resolveCulture:function(n){var u=!1,r=n;return r&&(r=i[r.toLowerCase()])&&(u=!0),u||(r=t.parentParentCultureResolver.resolveCulture(n)),r}};LocStringManager.addParentCultureResolver(t)}(WindowsCultureResolver||(WindowsCultureResolver={}));
//]]></script><script type="text/javascript" src="/rms/rms%20localizationstrings%20Threshold%20LocStrings/jc/55a809a1/8e06707b.js"></script><script type="text/javascript" src="/rms/BundledViews/jc/1c9317fc/9f0ba066.js?bu=rms+views+Shared+CenteredImagePair%2cAlertWrapper%2cFootnoteWrapper%2cGroupLabel%2cHorizontalList%2cHorizontalListItem%2cImagePair%2cImagePairWrapper%2cLegacyImagePair%2cRichCaptionControl%2cSelectItem%2cTitleWrapper%2cVerticalList%2cVerticalListItem%2cVerticalStackPanel%2cVerticalStackPanelItem"></script><script type="text/javascript" src="/rms/BundledViews/jc/9aae38e9/2516c91d.js?bu=rms+views+Threshold+DenseTileLayout%2cErrorMessage%2cInlineError%2cItemList%2cItemTitle%2cLocalStrings%2cMyStuffHeader%2cMyStuffPhotoItem%2cPageCanvas%2cPagination%2cPlaceHolderImage%2cRecourse%2cRegion%2cResultItem%2cResultItemCentered%2cResultItemPosition%2cResultItemPositionItem%2cResultItemPrimaryPosition%2cResultItemSecondaryPosition%2cResultItemWideColumnPosition%2cSection%2cSectionContents%2cSpellCorrection%2cSpellerSuggestion%2cSubsectionHeader%2cInstLink"></script><script type="text/javascript">//<![CDATA[
var ProvidersMap ={"local":{"all":[],"files":["LocalResultsProvider","OneDriveResultsProvider"],"folders":["LocalResultsProvider","OneDriveResultsProvider"],"apps":["LocalResultsProvider"],"settings":["LocalResultsProvider"],"pictures":["LocalResultsProvider","OneDriveResultsProvider"],"videos":["LocalResultsProvider","OneDriveResultsProvider"],"music":["LocalResultsProvider","OneDriveResultsProvider"]}};var LocalOnlyProviders =["apps","settings"];var TemplateConfig ={"OneColumnWidth":936,"TwoColumnWidth":456,"Height":464,"TitleHeight":16,"ItemHeight":64,"LargeItemHeight":96,"DefaultSectionHeight":384,"SingleSourceHeight":1920};var PageDebug ={"client":"windows","clientVersion":"M2","canvas":"MyStuff"};;var ViewResolution;(function(){function t(n){return n.create(ViewResolver[n.viewName])}for(var i in ViewResolver)Sparkle.appendViewResolveRule(i,t)})(ViewResolution||(ViewResolution={}));(function(){_w.GetUxClassificationSection=function(){return{client:"windows",clientversion:"M2"}}})();var Instrumentation;(function(n){function bt(n){u=n,sj_evt.fire("ClientInst.PageInstInfo",ht)}function at(n,t,i){if(_w.Log2){if(t){var r=s(t,!1);r&&(n.layoutNodes=r)}ft(n,i),Log2.LogMasterPageImpression(n)}}function vt(n,t){var u=s(n,!0),f,i,r;if(u&&u.length>0){for(f=[],i=0;i<u.length;i++)r=u[i],f.push({T:"L.MI",Action:"Update",AppNS:r.AppNS,K:r.K,L:r.L});Log2.LogEvent("ClientInst",null,null,t,f)}}function ti(n,r){var v=_w.location.href,a=[],p=r?r:_G.IG,o=t[p],y,u,s,c;if(o)for(y in o)if(u=o[y].tree,!u.IsInstrumented()){var l=u.GetValue(),e=u.GetChildren(),h=[];if(e.length>0){for(s in e)h.push(f(e[s]));l.DS=h}a.push(l),i(u)}return c={dataSources:a,layoutNodes:[],pageName:n,rawQuery:ThresholdUtilities.getDecodedQuery(),isQuery:!0,form:ThresholdUtilities.getUrlParameter(v,"form"),impressionUrl:v,appName:dt}}function ot(n,r){var h=s(n,!0),p=[],l,c,y,e,o,k,u,w;if(h&&h.length>0)for(l=0;l<h.length;l++)c=h[l],p.push({T:"L.MI",Action:"Update",AppNS:c.AppNS,K:c.K,L:c.L});if(y=_G.IG,r&&(y=r),e=[],o=t[y],o)for(k in o)if(u=o[k].tree,u.IsInstrumented())v(u,e);else{var d=u.GetValue(),a=u.GetChildren(),b=[];if(a.length>0){for(w in a)b.push(f(a[w]));d.DS=b}e.push(d),i(u)}(p.length>0||e.length>0)&&Log2.LogEvent("ClientInst",null,null,e,p)}function e(n,i,r,u,f,e){var a="D.Item",v="D.Url",h=_G.IG,o,s,l;if(f&&(h=f),t[h]||(t[h]=[]),o={AppNS:k,K:lt++,T:a},n&&(o.Url=n,o.T=v),i&&(o.N=i),e&&(o.T=e),r)for(s in r)r.hasOwnProperty(s)&&(string.IsNullOrWhiteSpace(r[s])||r[s].length===0?console.warn("Skipping logging datasource field key: "+s+" because it has no value."):ii[s]===!0?o[s]=r[s]:console.warn("Unknown datasource field key: "+s+". skipping logging value: "+r[s]));return u?(l=c(o,u,h),!l&&InstrumentationConfig.CopyDataCommand&&(rt(u,h),c(o,u,h))):t[h].push(new ri(new ut(o))),o}function ni(n,t,i,r){var u={},f;u.Service=t,u.Scenario=n;for(f in r)u[f]=r[f];return e(null,null,u,null,i,gt)}function kt(n,t,i){return a(e(n,t,null,i))}function a(n){return new it(n)}function h(n,r,u){var h,f,o,s;for(h in t){f=t[h];for(s in f)f[s].kValueExists(n)&&(o=s);if(o&&f[o].kValueExists(n)){var a=e(null,null,null,null,u,null),l=f[o].tree.GetValue(),c=[];c.push({T:"D.MI",Action:"Move",SrcAppNS:l.AppNS,SrcK:l.K,DestAppNS:a.AppNS,DestK:a.K}),Log2.LogEvent("ClientInst",null,null,c,null,null,h),t[u].push(f[o]),i(f[o].tree);return}}SharedLogHelper.LogError("missingDataSourceException","couldn't find data source with appNS "+r+" and k value "+n)}function rt(n,t){h(n.K.toString(),n.AppNS,t)}function c(n,i,r){var f=[],s=t[r],h,u,o,e,c;for(h in s)for(f.push(s[h].tree);f.length>0;){if(u=f.pop(),o=u.GetValue(),o.K===i.K&&o.AppNS===i.AppNS)return u.AddChild(n),s[h].addKValue(n.K.toString()),!0;e=u.GetChildren();for(c in e)f.push(e[c])}return!1}function f(n){var u=n.GetValue(),i=n.GetChildren(),r,t;if(i.length>0){for(r=[],t=0;t<i.length;t++)r.push(f(i[t]));u.DS=r}return u}function v(n,t){var u=n.GetChildren(),h=n.GetValue(),r,o;for(r in u)if(u[r].IsInstrumented())v(u[r],t);else{var c=u[r].GetValue(),e=u[r].GetChildren(),s=[];if(e.length>0){for(o in e)s.push(f(e[o]));c.DS=s}t.push({T:"D.MI",Action:"Append",AppNS:h.AppNS,K:h.K,DS:[c]}),i(u[r])}}function i(n){var r,t;for(n.SetIsInstrumented(),r=n.GetChildren(),t=0;t<r.length;t++)i(r[t])}function ft(n,t){var u={MUID:sj_cook.get("MUID","MUID")},i,r;if(t)for(i in t)t.hasOwnProperty(i)&&(u[i]=t[i]);n.clientUserInfo=u,r=GetUxClassificationSection(),r&&(n.uxClassification=r)}function ht(n){var f,e,t,i;if(u){f=n.clientUserInfo,f||(f={},n.clientUserInfo=f);for(t in o)o.hasOwnProperty(t)&&!f[t]&&(i=u[o[t]],i&&(f[t]=i));e={};for(t in r)r.hasOwnProperty(t)&&(i=u[r[t]],i&&(e[t]=i));n.userInfoOverrides=e}}function s(n,t){var s,f,i,r,u,o,e,h;if(n.parentElement&&(n=n.parentElement),s=n.querySelectorAll(st),f=s.length,f==0)return[];for(i=[],r=0;r<f;r++)u=y(s,r,f,null,t),u&&(r=u.lastProcessedIndex,i.push(u));if(t){e=[];for(h in i)ThresholdUtilities.pushOntoArray(e,b(i[h]));o=e.map(p)}else o=i.map(function(n){for(var t=n.layout,i;t.L&&t.L.length==1&&t.L[0].L;)i=t.AppNS,t=t.L[0],i&&!t.AppNS&&(t.AppNS=i);return t});return o}function b(n){var i=[],u=n.layout.AppNS,r,t;for(r in n.children)if(t=n.children[r],t.isLogged)t.layout.AppNS||(t.layout.AppNS=u),ThresholdUtilities.pushOntoArray(i,b(t));else{i.push(n);break}return i}function y(n,t,i,r,u){var h=[],o=n[t],a=o.hasAttribute(g),w=o.getAttribute(d)==="1",s,e,l,f,v,c;if(w&&!a)return null;if(s=et(o,r),e={isContainer:a,lastProcessedIndex:t,layout:s,isLogged:w,children:h},o.setAttribute(d,"1"),!e.isContainer)return e;for(l=s.AppNS,f=t+1;f<i;f++)if(v=n[f],o.contains(v))c=y(n,f,i,l?l:r,u),c&&(f=c.lastProcessedIndex,h.push(c));else break;if(h.length>0)s.L=h.map(p);else if(e.isContainer&&u)return null;return e.lastProcessedIndex=f-1,e}function p(n){return n.layout}function et(n,i,r){var f=null,e=null,p=!n.hasAttribute(g),w=n.getAttribute(yt),c,u,b,o,a;if(w&&(u=l(w),u&&(f=u.K,e=u.AppNS)),c=n.getAttribute(wt),c&&(u=l(c),u&&(f=u.K,e=u.AppNS)),f||(f=n.getAttribute(pt)),b=p?tt:ct,o={T:b},f){var y=f.split(".",1)[0],s=r?r:_G.IG,v=!1;for(a in t[s])if(t[s][a].kValueExists(y)){v=!0;break}!v&&InstrumentationConfig.CopyDataCommand&&h(y.toString(),e,s),o.K=f}return e&&e!=i?o.AppNS=e:e||i||(o.AppNS=k),!p&&n.hasAttribute(nt)&&(o.Region=n.getAttribute(nt)),o}function l(n){if(!n)return null;var t=w.exec(n);return t&&t.length==3?{AppNS:t[1],K:t[2]}:null}var it=function(){function n(n){this.hValue="ID="+n.AppNS+","+n.K,this.dsItem=n}return n.prototype.GetNamespacedKValue=function(){return this.hValue+".1"},n.prototype.GetKValue=function(){return this.dsItem.K.toString()+".1"},n.prototype.GetDataSource=function(){return this.dsItem},n.prototype.GetUrlWithFormCode=function(){return this.dsItem?this.dsItem.Url:null},n}(),ut=function(){function n(n){this.children=[],this.instrumented=!1,this.value=n}return n.prototype.AddChild=function(t){this.children.push(new n(t))},n.prototype.GetValue=function(){return this.value},n.prototype.GetChildren=function(){return this.children},n.prototype.IsInstrumented=function(){return this.instrumented},n.prototype.SetIsInstrumented=function(){this.instrumented=!0},n}(),ri=function(){function n(n){this.kValuesContained={},this.tree=n,this.kValuesContained[n.GetValue().K.toString()]=!0}return n.prototype.addKValue=function(n){this.kValuesContained[n]=!0},n.prototype.kValueExists=function(n){return this.kValuesContained[n]},n}(),lt=1,yt="h",wt="data-h",pt="data-k",nt="data-region",g="data-isregion",d="data-logged",st="[data-k], [data-isregion], [h], [data-h]",ct="L.Box",tt="L.Url",k="SERP",gt="D.MyStuff",dt="SmartSearch",ii={T:!0,Service:!0,Scenario:!0,AppNS:!0,K:!0,AppID:!0,AppName:!0,Url:!0,CDT:!0,LMD:!0,EXT:!0,PHits:!0,Rank:!0,SettingID:!0,DS:!0,SPDisplay:!0,PPMiss:!0,order:!0},u=null,t={},r,o,w;ThresholdUtilities.getCortanaHeaders(bt),r={Make:"X-Device-Manufacturer",Model:"X-Device-Product","Loc/RT":"X-Search-Location"},o={DeviceID:"X-Device-MachineId",IsTouch:"X-Device-Touch",DeviceSKU:"X-Device-SKU",OSSKU:"X-Device-OSSKU",ConnectionType:"X-Device-NetworkType",ClientMarket:"X-BM-RegionalSettings",AppLifetimeID:"X-Device-ClientSession",CortanaOptIn:"X-Device-IsOptIn"},ClientInstConfig.waitForPageInfo=!0,ClientInstConfig.isInstrumentationEnabled=SearchAppWrapper.CortanaApp.isBingEnabled,sj_evt.bind("ajax.threshold.pageStart",function(){ClientInstConfig.isInstrumentationEnabled=SearchAppWrapper.CortanaApp.isBingEnabled}),n.LogPageImpression=at,n.LogUpdatedLayout=vt,n.CreatePageImpression=ti,n.LogUpdatedLayoutCentralizedDataSources=ot,n.CreateDataSourceItem=e,n.CreateDataSourcesRoot=ni,n.CreateInstrumentedItem=kt,n.CreateInstrumentedItemFromDs=a,w=/ID=(\w+),(\d+(?:\.\d+)*)/i})(Instrumentation||(Instrumentation={})),_w.ThresholdInst=Instrumentation;var Instrumentation;(function(n){function s(n,t){var i=_w.location.href;return{dataSources:[t],layoutNodes:[],pageName:n,rawQuery:ThresholdUtilities.getDecodedQuery(),isQuery:!0,form:ThresholdUtilities.getUrlParameter(i,"form"),impressionUrl:i,appName:h}}function c(n,t,i,r){var f=ThresholdInst.CreateDataSourceItem(null,null,{T:e,Service:n,Scenario:t,DS:i}),u;for(u in r)f[u]=r[u];return f}function l(n,t,u,f){for(var c=[],v=n.length,y=u==="OneDriveAnswer"?r:i,l,s,h,o=0;o<v;o++)l=y(n[o]),c.push(l);s={T:e,AppNS:a,Service:u,Scenario:t,DS:c};for(h in f)s[h]=f[h];return[s]}function t(n){var e=[],f,t,u,r,i;if(n.Positions)for(f=n.Positions,t=0;t<f.length;t++)if(u=f[t],u.key=="PrimaryPropertiesMissing")for(r=u.positionItems,i=0;i<r.length;i++)e.push(r[i].key);return e}function u(n){var e=[],f,t,u,i,r;if(n.Positions)for(f=n.Positions,t=0;t<f.length;t++)for(u=f[t].positionItems,i=0;i<u.length;i++)r=u[i],r.isSecondary&&e.push(r.key);return e}function r(n,i){var e={},r;return e[o]=t(n),e[f]=u(n),r=ThresholdInst.CreateDataSourceItem(n.ClickUrl,null,e,i),n.InstItem=ThresholdInst.CreateInstrumentedItemFromDs(r),r}function i(n,i){var b="http://ms-smartsearch/app?",k="CDT",p="LMD",y="EXT",tt="dummmy",it="AppID",g="AppName",w="SettingID",d="PHits",nt="Rank",v=b+n.Id,s=null,r={},e,a,l,c,h;switch(n.Type){case"app":r[it]=n.Id,r[g]=n.DisplayName,s=v;break;case"setting":r[w]=n.Id,s=v;break;default:e=n.DataSource,s=tt+e.extension,r[k]=e.createdDate,r[p]=e.createdDate,string.IsNullOrEmpty(e.extension)||(r[y]=e.extension)}return a=n.DataSource.propertyHits.join(),a!==""&&(r[d]=a),n.DataSource.rankScore&&(r[nt]=n.DataSource.rankScore),l=t(n),l.length>0&&(r[o]=l),c=u(n),c.length>0&&(r[f]=c),h=ThresholdInst.CreateDataSourceItem(s,null,r,i),n.InstItem=ThresholdInst.CreateInstrumentedItemFromDs(h),h}var h="SmartSearch",e="D.MyStuff",a="SERP",o="PPMiss",f="SPDisplay";n.createPageImpression=s,n.createAnswerDataSources=c,n.createLocalDataSources=l,n.CreateOneDriveDataSourceResult=r,n.CreateLocalDataSourceResult=i})(Instrumentation||(Instrumentation={}));var RequestAlterationFactory=function(){function n(){this.requestAlterers=[],this.requestAltererationEngines={}}return n.prototype.RegisterComponent=function(n){this.requestAlterers.push(n)},n.prototype.GetEngine=function(n){var i=this.GetRequestKey(n),t=this.requestAltererationEngines[i];return t||(t=new RequestAlterationEngine(this.requestAlterers)),t},n.prototype.GetRequestKey=function(n){return n.GetQuery()},n}(),RequestAlterationEngine=function(){function n(n){this.requestAlterers=n}return n.prototype.AlterRequest=function(n,t,i,r){this.completionTarget=i+sb_gt(),this.alterationIndex=0,this.callback=r,this.completed=!1,this.requestAlterers.length===0?r():(this.timeout=sb_st(sj_dm(this,this.chainAlterRequestFunction),i),this.requestAlterers[this.alterationIndex].AlterRequest(n,t,i,sj_dm(this,this.chainAlterRequestFunction))||this.chainAlterRequestFunction(n,t))},n.prototype.chainAlterRequestFunction=function(n,t){if(!this.completed){var i=sb_gt();i>=this.completionTarget||this.alterationIndex===this.requestAlterers.length-1?(this.timeout&&(sb_ct(this.timeout),this.timeout=null),this.completed=!0,this.callback()):(++this.alterationIndex,this.requestAlterers[this.alterationIndex].AlterRequest(n,t,this.completionTarget-i,sj_dm(this,this.chainAlterRequestFunction))||this.chainAlterRequestFunction(n,t))}},n}(),RequestAlteration=new RequestAlterationFactory;var StaticSectionOrder;(function(){var t=function(){function n(){}return n.prototype.AlterRequest=function(n,t,i,r){var o,f,u,s,e;if(!n)return!1;if(t)o=this.OrderSections(n,t,i,r);else{if(f=[],u=n.GetScope(),u==="all"){s=n.GetProviderSections();for(e in s)e!==u&&f.push(e)}else f.push(u);n.TaskFrame.OrderedSections=f,r(n),o=!0}return o},n.prototype.OrderSections=function(n,t,i,r){for(var f=n.GetSections(),c=[],h=0,l=f.length-1,o,e,s,u=0;u<=l;u++){o=!1,e=t[f[u]].ItemList;for(s in e)if(e[s]&&e[s].length>0){o=!0;break}o?c[u-h]=f[u]:(c[l-h]=f[u],h++)}return n.TaskFrame.OrderedSections=f,r(n),!0},n}();RequestAlteration.RegisterComponent(new t)})(StaticSectionOrder||(StaticSectionOrder={}));var RequestData=function(){function n(n,t,i,r){this.sourceFriendlyNameMapping={local:"LocalResultsProvider",OneDriveAnswer:"OneDriveResultsProvider"},this.provider=null,this.oemEnabledOverride=null,this.query=n,this.url=t,this.scope=i,this.TaskFrame=r,this.source=ThresholdUtilities.getUrlParameter(this.url,"source"),this.sortBy=this.assignSortBy(),this.trySetProvider(ThresholdUtilities.getUrlParameter(this.url,"provider"))||this.trySetProvider(_w.localStorage.getItem("MS_DProvider"))}return n.prototype.GetScope=function(){var t=this.scope,e=this.GetProviderSections(),o=e.all?"all":"files",r,i,n,u,f;return t||(r={"task://FindMyStuff/FindSettings":"settings","task://FindMyStuff/FindApp":"apps","task://FindMyStuff/FindEmail":"email"},i={Picture:"pictures",Email:"email",Video:"videos"},this.TaskFrame?(n=this.TaskFrame,n.Name&&(u=r[n.Name],u&&(t=r[n.Name])),!t&&n.FileType&&n.FileType.Value&&(f=i[n.FileType.Value],f&&(t=i[n.FileType.Value]))):SharedLogHelper.LogError("CUError","invalid task frame")),e[t]?t:o},n.prototype.GetSections=function(){var n=this.TaskFrame.OrderedSections;return n?n:[]},n.prototype.GetQuery=function(){return this.query},n.prototype.GetUrl=function(){return this.url},n.prototype.GetSource=function(){return this.sourceFriendlyNameMapping[this.source]?this.sourceFriendlyNameMapping[this.source]:this.source},n.prototype.GetSortBy=function(){return this.sortBy},n.prototype.GetProvider=function(){return this.provider===null&&(this.provider=this.GetIsOemEnabled()?1:0),this.provider},n.prototype.GetProviderSections=function(){var i="local",n=i,t;return this.GetProvider()===1&&(n="OEM"),t=ProvidersMap[n],t||n===i||(n=i,t=ProvidersMap[n]),t},n.prototype.GetFirstItemNumber=function(){var t=ThresholdUtilities.getUrlParameter(this.url,"first"),i=1,n;return t&&(n=parseInt(t),!isNaN(n)&&n>0&&(i=n)),i},n.prototype.GetIsOemEnabled=function(){return DCPageConfig.OemEnabled&&SearchAppWrapper.CortanaApp.isOemEnabled?!0:!1},n.prototype.GetQueryKey=function(){return this.GetQuery()+this.GetSortBy()},n.prototype.LogDataSources=function(n){var r=this.GetSections(),t={order:r},i;InstrumentationConfig.ManagedDataSources?ThresholdInst.CreateDataSourcesRoot("RequestData","RequestData",null,t):(i=Instrumentation.createAnswerDataSources("RequestData","RequestData",[],t),ThresholdUtilities.pushOntoArray(n,[i]))},n.prototype.assignSortBy=function(){var t=ThresholdUtilities.getUrlParameter(this.GetUrl(),"sortby"),n=0;return t&&(n=Number(t)),n},n.prototype.trySetProvider=function(n){var i=!1,t;return n&&(t=parseInt(n),isNaN(t)||(this.provider=t,i=!0)),i},n}();var ContentTypeFilter=function(){function n(n){var f,i,r,u;this.Data={Name:"",Options:[],OnChange:null,Selected:0,InstItem:null},this.dataSources=[],this.Data.Name="scopes",this.Data.Id="filter";var s=[],e,o=0,l=n.GetScope();InstrumentationConfig.ManagedDataSources&&(this.dataSourcesRoot=ThresholdInst.CreateDataSourcesRoot("ContentTypeFilter","DeviceContent"),this.Data.InstItem=ThresholdInst.CreateInstrumentedItemFromDs(this.dataSourcesRoot)),f=n.GetProviderSections();for(i in f){r=ResultsProviderConfig.sectionKeyToSectionFilterFormCodeSuffix[i],r==undefined&&(r=""),u=i,i==="all"&&(u=null);var h=MyStuffLocalization.getLocalStringForScope(i),c=n.GetUrl(),t=ThresholdUtilities.setUrlParameter(c,"scope",u);t=ThresholdUtilities.setUrlParameter(t,"form",ResultsProviderConfig.sectionFilterFormCode+r),t=ThresholdUtilities.setUrlParameter(t,"source",""),l===i?e=o:t=ThresholdUtilities.setUrlParameter(t,"first",null),s.push({Value:t,Key:h.Title,Link:t,InstItem:this.createInstrumentedItem(t,i)}),o++}this.Data.Options=s,this.Data.OnChange=sj_dm(this,this.onSelectItemChange),this.Data.Selected=e}return n.prototype.GetNewDataSources=function(){var n=null,t=this.dataSources.length;return t&&(n=this.dataSources.splice(0,t)),n=[Instrumentation.createAnswerDataSources("DeviceContent","ContentTypeFilter",n)],this.Data.InstItem=ThresholdInst.CreateInstrumentedItemFromDs(n[0]),n},n.prototype.createInstrumentedItem=function(n,t){var i=ThresholdInst.CreateInstrumentedItem(n,t,this.dataSourcesRoot);return InstrumentationConfig.ManagedDataSources||this.dataSources.push(i.GetDataSource()),i},n.prototype.onSelectItemChange=function(){var n=_ge("filter"),t=n.options[n.selectedIndex].value;ThresholdUtilities.navigateTo(t,this.Data.Options[n.selectedIndex].InstItem)},n._allView="all",n}();var SortConfig={SortOptionsAll:[0,3],IsSortEnabled:!0};var ContentTypeSort=function(){function n(t){var u;this.Data={Id:"sort",Options:[],OnChange:null,Selected:0,InstItem:null},this.dataSources=[];var s=[],e=0,o=0,f=t.GetUrl(),h=t.GetSortBy();for(InstrumentationConfig.ManagedDataSources&&(this.dataSourcesRoot=ThresholdInst.CreateDataSourcesRoot("ContentTypeSort","DeviceContent"),this.Data.InstItem=ThresholdInst.CreateInstrumentedItemFromDs(this.dataSourcesRoot)),u=0;u<SortConfig.SortOptionsAll.length;u++){var r=SortConfig.SortOptionsAll[u],c=MyStuffLocalization.AllStrings[n._localizationKeyPrefx+r],i=f;i=r===0?ThresholdUtilities.setUrlParameter(f,"sortby",""):ThresholdUtilities.setUrlParameter(f,"sortby",r+""),i=ThresholdUtilities.setUrlParameter(i,"form",n.sortOptionsToFormCodes[r]),i=ThresholdUtilities.setUrlParameter(i,"first",null),r===h&&(e=o),s.push({Value:i,Key:c,Link:i,InstItem:this.createInstrumentedItem(i,r.toString())}),o++}this.Data.Options=s,this.Data.Selected=e,this.Data.OnChange=sj_dm(this,this.itemChanged)}return n.prototype.GetNewDataSources=function(){var n=null,t=this.dataSources.length;return t&&(n=this.dataSources.splice(0,t)),n=[Instrumentation.createAnswerDataSources("DeviceContent","ContentTypeSort",n)],this.Data.InstItem=ThresholdInst.CreateInstrumentedItemFromDs(n[0]),n},n.prototype.createInstrumentedItem=function(n,t){var i=ThresholdInst.CreateInstrumentedItem(n,t,this.dataSourcesRoot);return InstrumentationConfig.ManagedDataSources||this.dataSources.push(i.GetDataSource()),i},n.prototype.itemChanged=function(){var t=_ge("sort"),i=t.options[t.selectedIndex].value;ThresholdUtilities.navigateTo(i,this.Data.Options[t.selectedIndex].InstItem)},n.sortOptionsToFormCodes={0:"WNSMSR",3:"WNSMSO"},n._localizationKeyPrefx="SortBy",n}();var ProviderFilter=function(){function n(n){this.Data={Id:"providers",Options:[],OnChange:null,Selected:0,InstItem:null},this.IsEnabled=!1,this.dataSources=[],n.GetIsOemEnabled()&&(InstrumentationConfig.ManagedDataSources&&(this.dataSourcesRoot=ThresholdInst.CreateDataSourcesRoot("ProviderFilter","DeviceContent"),this.Data.InstItem=ThresholdInst.CreateInstrumentedItemFromDs(this.dataSourcesRoot)),this.pushProviderOption(n,SearchAppWrapper.CortanaApp.region!=="CN"?"ࠀ":"B",1,"OEMFORM")),this.Data.Options.length>0&&(this.pushProviderOption(n,"C",0,"MICROSOFTFORM"),this.Data.OnChange=sj_dm(this,this.onSelectItemChange),this.IsEnabled=!0)}return n.prototype.GetNewDataSources=function(){var n=null,t=this.dataSources.length;return t&&(n=this.dataSources.splice(0,t)),n=[Instrumentation.createAnswerDataSources("DeviceContent","ProviderFilter",n)],this.Data.InstItem=ThresholdInst.CreateInstrumentedItemFromDs(n[0]),n},n.prototype.pushProviderOption=function(t,i,r,u){var h=t.GetUrl(),s=n.providerString,f=ThresholdUtilities.setUrlParameter(h,s,r.toString()),o,e;f=ThresholdUtilities.setUrlParameter(f,"form",u),o=this.createInstrumentedItem(f,"ProviderLink_"+r),e={Value:f,Key:i,Link:f,InstItem:o,AltText:r===0?"Microsoft":"              "},e[s]=r.toString(),t.GetProvider()===r&&(this.Data.Selected=this.Data.Options.length),this.Data.Options.push(e)},n.prototype.createInstrumentedItem=function(n,t){var i=ThresholdInst.CreateInstrumentedItem(n,t,this.dataSourcesRoot);return InstrumentationConfig.ManagedDataSources||this.dataSources.push(i.GetDataSource()),i},n.prototype.onSelectItemChange=function(){var t=_ge("providers"),i;if(t){i=this.Data.Options[t.selectedIndex][n.providerString];try{_w.localStorage.setItem("MS_DProvider",i)}catch(r){}ThresholdUtilities.navigateTo(t.options[t.selectedIndex].value,this.Data.Options[t.selectedIndex].InstItem)}},n.providerString="provider",n}();var Header=function(){function n(n){var i,r,t;this.dataSources=[],i=new ContentTypeFilter(n),InstrumentationConfig.ManagedDataSources||ThresholdUtilities.pushOntoArray(this.dataSources,i.GetNewDataSources()),this.ContentTypeFilterData=i.Data,SortConfig.IsSortEnabled&&(r=new ContentTypeSort(n),InstrumentationConfig.ManagedDataSources||ThresholdUtilities.pushOntoArray(this.dataSources,r.GetNewDataSources()),this.ContentTypeSortData=r.Data),t=new ProviderFilter(n),t.IsEnabled&&(InstrumentationConfig.ManagedDataSources||ThresholdUtilities.pushOntoArray(this.dataSources,t.GetNewDataSources()),this.ProviderFilterData=t.Data),this.Query=n.GetQuery(),SearchAppWrapper.CortanaApp.isBingEnabled&&(this.RecourseLink=this.getRequeryLink(n)),this.InstItem=this.createInstrumentedItem(null,"Header"),this.IsBackButtonVisible=SearchAppWrapper.CortanaApp.isBackButtonVisible,sj_evt.bind("ajax.load",this.OnPageLoadCallback,1)}return n.prototype.OnPageLoadCallback=function(){var n,i,t;this.IsBackButtonVisible=SearchAppWrapper.CortanaApp.isBackButtonVisible,n=_d.querySelector(".top"),n&&(i="hasback",t=n.classList.contains(i),(this.IsBackButtonVisible&&!t||!this.IsBackButtonVisible&&t)&&n.classList.toggle(i))},n.prototype.GetNewDataSources=function(){var t=null,n=this.dataSources.length;return n&&(t=this.dataSources.splice(0,n)),t},n.prototype.getRequeryLink=function(){var t=ThresholdUtilities.setUrlParameter("/search","form","WNSMTW");return t=ThresholdUtilities.setUrlParameter(t,"q",ThresholdUtilities.getUrlReadyQuery(this.Query)),this.createInstrumentedItem(t,"RecourseLink")},n.prototype.createInstrumentedItem=function(n,t){var i=ThresholdInst.CreateInstrumentedItem(n,t);return InstrumentationConfig.ManagedDataSources||this.dataSources.push(i.GetDataSource()),i},n}();var CompletionTracker=function(){function n(){this.itemSet=new WeakMap,this.itemList=[]}return n.prototype.Start=function(n){var i=!1,t=this.itemSet;return t.has(n)?i=t.get(n):(t.set(n,!1),this.itemList.push(n)),i},n.prototype.Complete=function(n){var i=!1,t=this.itemSet;return t.has(n)&&(i=t.get(n)),t.set(n,!0),i},n.prototype.IsFullyComplete=function(){var i=!0,t=this.itemList,n;for(n in t)if(!this.itemSet.get(t[n])){i=!1;break}return i},n}();var SubSectionStore=function(){function n(n,t,i,r,u){this.subSectionProviders=[],this.completedSubSectionProviders=[],this.createdSubSections=[],this.completionTracker=new CompletionTracker,this.owningSection=n,this.requestData=t,this.dimensions=i,this.sectionCompletedCallback=r,this.sectionUpdatedCallback=u,this.deferedSubSectionUpdate=sj_dm(this,this.subSectionUpdate),this.deferedSubSectionComplete=sj_dm(this,this.subSectionComplete)}return n.prototype.RegisterSubSectionProvider=function(n){this.subSectionProviders.push(n)},n.prototype.CreateSubSections=function(){for(var n in this.subSectionProviders)this.subSectionProviders[n].CreateSubSections(this.requestData,this)},n.prototype.AddSections=function(n,t){var i,r;if(this.completedSubSectionProviders.push(n),t)for(i=0;i<t.length;i++)r=t[i],r.Initialize(this.requestData,this.dimensions,this.deferedSubSectionComplete,this.deferedSubSectionUpdate),this.completionTracker.Start(r);ThresholdUtilities.pushOntoArray(this.createdSubSections,t),this.checkComplete()},n.prototype.GetSubSections=function(){return this.createdSubSections},n.prototype.subSectionUpdate=function(){window.setImmediate(sj_dm(this,this.sectionUpdatedCallback,this.owningSection))},n.prototype.subSectionComplete=function(n){this.subSectionUpdate(n),this.completionTracker.Complete(n),this.checkComplete()},n.prototype.checkComplete=function(){this.completionTracker.IsFullyComplete()&&this.subSectionProviders.length===this.completedSubSectionProviders.length&&window.setImmediate(sj_dm(this,this.sectionCompletedCallback,this.owningSection))},n}();var PageSection=function(){function n(n,t,i,r){var f,u,e;this.app=SearchAppWrapper.CortanaApp,this.onSubSectionComplete=null,this.dataSources=[],this.dataSourceRoot=null,f=t.Key,this.Key=f,this.Title=MyStuffLocalization.getLocalStringForScope(f).Title,this.subSectionStore=new SubSectionStore(this,n,t.GetDimensions(),i,r),this.createSubSections(n,f,!1),this.Layout=0,InstrumentationConfig.ManagedDataSources&&(this.dataSourceRoot=ThresholdInst.CreateDataSourcesRoot(this.Key,"DeviceContent")),u=ThresholdUtilities.setUrlParameter(n.GetUrl(),"scope",this.Key),e=ResultsProviderConfig.sectionFilterFormCode+ResultsProviderConfig.sectionKeyToSectionFilterFormCodeSuffix[this.Key],u=ThresholdUtilities.setUrlParameter(u,"form",e),this.ScopeInstItem=this.createInstrumentedItem(u,this.Key),InstrumentationConfig.ManagedDataSources||this.dataSources.push(Instrumentation.createAnswerDataSources(this.Key,"DeviceContent",[this.ScopeInstItem.GetDataSource()]))}return n.prototype.HasResults=function(){var i=this.subSectionStore.GetSubSections(),t=!1,n;for(n in i)if(i[n].HasResults()){t=!0;break}return t},n.prototype.HasError=function(){for(var t=this.subSectionStore.GetSubSections(),i=!1,n=0;n<t.length;n++)if(t[n].State===3){i=!0;break}return i},n.prototype.IsIndexed=function(){for(var t=this.subSectionStore.GetSubSections(),i=!0,n=0;n<t.length;n++)if(!t[n].IsIndexed){i=!1;break}return i},n.prototype.GetItems=function(){for(var t=this.subSectionStore.GetSubSections(),r={},i,u,n=0;n<t.length;n++){r[t[n].Key]=[],i=t[n].ViewModel.Items;for(u in i)r[t[n].Key].push(i[u].DataSource)}return r},n.prototype.GetNewDataSources=function(){for(var i=[],r=this.subSectionStore.GetSubSections(),t,n=0;n<r.length;n++)t=r[n].GetNewDataSources(),t&&ThresholdUtilities.pushOntoArray(i,t);return i},n.prototype.GetPaginationSubSection=function(){var t=this.subSectionStore.GetSubSections(),n=null;return t.length===1&&(n=t[0]),n},n.prototype.GetSubSections=function(){return this.subSectionStore.GetSubSections()},n.prototype.PrerenderingProcess=function(){this.GetSubSections().forEach(function(n){n.PrerenderingProcess()})},n.prototype.createSubSections=function(n,t){var u=this.subSectionStore,e=n.GetSource(),r,f;e?(r=_w[e].CreateSubSection(t),r&&u.RegisterSubSectionProvider(r)):(f=n.GetProviderSections(),f[t].map(function(n){if(_w[n]&&_w[n].CreateSubSection){var i=_w[n].CreateSubSection(t);i&&u.RegisterSubSectionProvider(i)}})),u.CreateSubSections()},n.prototype.createInstrumentedItem=function(n,t){var i=ThresholdInst.CreateInstrumentedItem(n,t,this.dataSourceRoot);return InstrumentationConfig.ManagedDataSources||this.dataSources.push(i.GetDataSource()),i},n}();var SectionRenderingConfig;(function(n){function t(n,t){var i=t===2?TemplateConfig.SingleSourceHeight:TemplateConfig.DefaultSectionHeight;return{Key:n,Width:_w.innerWidth,MaxHeight:i,GetDimensions:function(){var n={height:i};return Object.defineProperty(n,"width",{get:function(){return _w.innerWidth}}),n}}}n.GetSectionRenderingConfig=t})(SectionRenderingConfig||(SectionRenderingConfig={}));var TestHooksEnabled=!1;var ComponentsConfig={IsSpellerEnabled:!0,EchoEnabled:!0};var Speller,SpellerSuggestion;(function(n){function t(n,t){function i(n){if(n&&n.Results&&n.Results[r]){var i=n.Results[r];i[0]&&i[0].Content&&i[0].Content.SpellerData&&i[0].Content.SpellerData.SpellCorrectedQuery?t(i[0].Content.SpellerData.SpellCorrectedQuery):t(null)}else t(null)}function u(t){t&&t.length===3&&t[1]===n.GetQuery()&&i(t[2])}var r="MyStuffSpellerOutput";OneDriveConfig.EnablePromise?MyStuffOnlineFederator.FetchMyStuffOnline(n).then(i):(MyStuffOnlineFederator.FetchMyStuffOnlineM2(n),sj_evt.bind("ajax.MyStuffOnlineFederator.completed",u,1))}n.fetchOnlineContent=t})(Speller||(Speller={})),SpellerSuggestion=function(){function n(){this.dataSources=[],this.dataSourcesRoot=null,this.IsComplete=!1}return n.prototype.Initialize=function(t,i){this.urlStr=t.GetUrl(),InstrumentationConfig.ManagedDataSources&&(this.dataSourcesRoot=ThresholdInst.CreateDataSourcesRoot(n._spellerName,n._spellerName)),this.LayoutInstItem=this.createInstrumentedItem(null,n._spellerName),Speller.fetchOnlineContent(t,sj_dm(this,this.processResults,i))},n.prototype.processResults=function(t,i){var u=ThresholdUtilities,r;t&&(r=u.setUrlParameter(this.urlStr,"q",u.getUrlReadyQuery(t)),r=u.setUrlParameter(r,"form",n._formCode),this.SpellSuggestion=t,this.RecourseLink=r,this.InstItem=this.createInstrumentedItem(r,n._recourseLinkName),InstrumentationConfig.ManagedDataSources||this.dataSources.push(Instrumentation.createAnswerDataSources(n._spellerName,n._spellerName,[this.InstItem.GetDataSource()])),this.IsComplete=!0),i&&i()},n.prototype.GetNewDataSources=function(){var t=null,n=this.dataSources.length;return n&&(t=this.dataSources.splice(0,n)),t},n.prototype.createInstrumentedItem=function(n,t){var i=ThresholdInst.CreateInstrumentedItem(n,t,this.dataSourcesRoot);return InstrumentationConfig.ManagedDataSources||this.dataSources.push(i.GetDataSource()),i},n._formCode="WNSMTM",n._recourseLinkName="SpellerLink",n._responseType="MyStuffSpellerOutput",n._serviceName="SpellerProcessor",n._spellerName="Speller",n}();var DCPageConfig={PassCustomTaskFrames:!0};var PaginationControl;(function(n){function s(n,t){var u=t.GetMaxRenderItemsNumber(),f=t.GetLastRenderedItemNumber(),i=t.GetTotalEstimatedResultsCount();return h(n,u,f,i)}function h(n,s,h,c){var a,p,k;InstrumentationConfig.ManagedDataSources&&(t=ThresholdInst.CreateDataSourcesRoot("Pagination","DeviceContent"));var tt=Math.max(1,n.GetFirstItemNumber()),nt=Math.ceil(c/s),y=Math.ceil(tt/s),b=n.GetUrl(),l={PaginationLinks:[],PreviousPage:null,NextPage:null,DataSource:null,ContainingRegion:null},w=Math.min(o,y-1),d=Math.min(o,nt-y),g=Math.max(1,y-w),v=(g-1)*s+1;return v=Math.max(1,v),p=0,w>0&&(p=f(l,b,g,v,w,s,p),a=l.PaginationLinks[l.PaginationLinks.length-1].Url,a=ThresholdUtilities.setUrlParameter(a,r,"PQRE"),l.PreviousPage={Active:!1,Url:a,Text:_G.RTL?"E76C":"E76B",InstData:i(l.PaginationLinks[l.PaginationLinks.length-1].Url)}),(w>0||d>0)&&l.PaginationLinks.push({Active:!0,Url:b,Text:y.toString(),InstData:null}),d>0&&(v=h+1,a=ThresholdUtilities.setUrlParameter(b,e,v.toString()),a=ThresholdUtilities.setUrlParameter(a,r,"PORE"),l.NextPage={Active:!1,Url:a,Text:_G.RTL?"E76B":"E76C",InstData:i(a)},f(l,b,y+1,v,d,s,p)),InstrumentationConfig.ManagedDataSources?(l.DataSource=t,l.ContainingRegion=ThresholdInst.CreateInstrumentedItemFromDs(t)):(k=Instrumentation.createAnswerDataSources("DeviceContent","Pagination",u.splice(0,u.length)),l.DataSource=k,l.ContainingRegion=ThresholdInst.CreateInstrumentedItemFromDs(k)),l}function f(n,t,u,f,o,s,h){for(var c,a,l=0;l<o;l++,h++)c=ThresholdUtilities.setUrlParameter(t,e,f.toString()),a="PERE"+(h===0?"":h.toString()),c=ThresholdUtilities.setUrlParameter(c,r,a),n.PaginationLinks.push({Active:!1,Url:c,Text:(u+l).toString(),InstData:i(c)}),f+=s;return h}function i(n,i){var r=ThresholdInst.CreateInstrumentedItem(n,i,t);return InstrumentationConfig.ManagedDataSources||u.push(r.GetDataSource()),r}var u=[],t=null,o=3,e="first",r="form";n.GetPaginationItems=s})(PaginationControl||(PaginationControl={}));var RecourseConfig={IsEnabled:!0};function logVisibilityChange(){try{var t=document.visibilityState;Log2.LogEvent("ClientInst",{s:t,t:sb_gt().toString(),o:"cortana"},"MyStuff"),ThresholdUtilities.uploadApiTimes("PVE")}catch(i){SharedLogHelper.LogFatalError("LogVisibilityFailure",null,i)}}var VirtualPage=function(){function n(){this.IsErrorPage=!1,this.sections=[],this.sectionsToAddOnPage=[],this.sectionsRendered=[],this.componentHasUpdated=!1,this.mpiLogged=!1,this.pageContainerDiv=sj_ce("div"),this.headerContainer=sj_ce("div"),this.sectionsContainer=sj_ce("div"),this.pageName=n.PagePrefix+"all",this.noResults=!0,this.isIndexed=!0,this.pageDataSources=[],this._paginationControl=PaginationControl,this._paginationItems=null,this.completionTracker=new CompletionTracker,this.renderCount=0,this.pageLoaded=!1,this.paginationRendered=!1,this.viewData={TestHooksEnabled:TestHooksEnabled,SmallImageConfig:n.SmallImageConfig,LargeImageConfig:n.LargeImageConfig},this.populateSectionsCalled=!1,this.pageContainerDiv.appendChild(this.headerContainer),this.pageContainerDiv.appendChild(this.sectionsContainer),ThresholdUtilities.getThemeColor(function(n){sj_ic(".b_accentColor { color: "+n+"; }")}),InstrumentationConfig.VisibilityEventEnabled&&VisibilityChangeEventHelper.Register(CortanaApp,document,logVisibilityChange,"MyStuff");try{this.guid=ThresholdUtilities.cleanGuid(SearchAppWrapper.CortanaApp.createGuid())}catch(t){this.guid="00000000000000000000000000000000",SharedLogHelper.LogError("CreateGuidFailure",null,t)}}return n.prototype.Initialize=function(n,t,i){var r=new RequestData(n,t,i,null);this.requestData=r,PageDebug&&(PageDebug.query=r.GetQuery(),DCPageConfig.OemEnabled&&(PageDebug.oemEnabled=r.GetIsOemEnabled().toString(),PageDebug.oemPageActive=(r.GetProvider()!==0).toString())),SearchAppWrapper.Utils.wrapApiCall(SearchAppWrapper.CortanaApp.searchResultsView,"getTaskFrameAsync",null,"getTaskFrame",n).then(sj_dm(this,this.ProcessTaskFrame,n,t))},n.prototype.SerializeState=function(){var n={};return n.IG=this.guid,n.Content=this.pageContainerDiv,n.EOS="1",n},n.prototype.ProcessTaskFrame=function(t,i){var u=ThresholdUtilities.parseJSON(t);this.requestData.TaskFrame=u?u:ThresholdUtilities.getEmptyTaskFrame(i),this.requestAlterationEngine=RequestAlteration.GetEngine(this.requestData),this.requestAlterationEngine.AlterRequest(this.requestData,null,n.AlterationWaitTime,sj_dm(this,this.populatePage))},n.prototype.populatePage=function(){try{this.requestData.LogDataSources(this.pageDataSources),_G.PN=this.pageName,this.fireFeedbackEvent(),this.RenderSpellerSuggestion(),this.RenderHeader(),this.PopulateSections(),sj_evt.bind("ajax.navigateStart",sj_dm(this,this.Activate),1)}catch(t){SharedLogHelper.LogError("UnhandledVirtualPageException",null,t),this.pageName=n.PagePrefix+"Error",this.RenderErrorPage(),this.fireFeedbackEvent(),this.IsErrorPage=!0,this.mpi||(this.mpi=InstrumentationConfig.ManagedDataSources?ThresholdInst.CreatePageImpression(this.pageName):Instrumentation.createPageImpression(this.pageName,this.GetNewDataSources())),this.Activate(),ThresholdUtilities.uploadApiTimes("ESE")}},n.prototype.Activate=function(){this.guid===_G.IG&&(this.setCortanaHeader(),this.mpiLogged||(ThresholdInst.LogPageImpression(this.mpi,_d.body),this.mpiLogged=!0))},n.prototype.SectionUpdated=function(n){var i=this.sectionsToAddOnPage.indexOf(n),t=this.sectionsRendered.indexOf(n);t<0&&i<0&&(n.HasResults()&&this.sectionsToAddOnPage.push(n),this.isIndexed=this.isIndexed&&n.IsIndexed()),this.componentHasUpdated=!0},n.prototype.OnComponentCompleted=function(n){var t=this.completionTracker;t.Complete(n),t.IsFullyComplete()&&this.populateSectionsCalled&&(this.BeginRenderSections(!0),this.setCortanaHeader(),ThresholdUtilities.uploadApiTimes("ESR"))},n.prototype.SectionCompleted=function(n){this.noResults&&n.HasResults()&&(this.noResults=!1),n.HasError()&&(this.IsErrorPage=!0),this.OnComponentCompleted(n)},n.prototype.RenderHeader=function(){var n=new Header(this.requestData),i=this.headerContainer,t="Threshold:MyStuffHeader";Sparkle.render(t,{uiCulture:SearchAppWrapper.CortanaApp.uiLanguage,properties:{ViewModel:n},viewData:this.viewData},i),InstrumentationConfig.ManagedDataSources||ThresholdUtilities.pushOntoArray(this.pageDataSources,n.GetNewDataSources()),this.headerViewModel=n},n.prototype.RenderSpellerSuggestion=function(){if(ComponentsConfig.IsSpellerEnabled){var n=new SpellerSuggestion;this.spellerViewModel=n,this.completionTracker.Start(n),n.Initialize(this.requestData,sj_dm(this,this.RenderSpellerSuggestionCallback)),InstrumentationConfig.ManagedDataSources||ThresholdUtilities.pushOntoArray(this.pageDataSources,n.GetNewDataSources())}},n.prototype.GetNewDataSources=function(){var t=null,n=this.pageDataSources.length;return n&&(t=this.pageDataSources.splice(0,n)),t},n.prototype.RenderSpellerSuggestionCallback=function(){this.componentHasUpdated=!0,this.OnComponentCompleted(this.spellerViewModel)},n.prototype.PopulateSections=function(){var r,e,u,i,f,t;for(this.populateSectionsCalled=!0,r=this.requestData.GetSections(),this.viewState=r.length>1?0:string.IsNullOrEmpty(this.requestData.GetSource())?1:2,e=sj_dm(this,this.SectionCompleted),u=sj_dm(this,this.SectionUpdated),this.layoutInstItem=this.createInstrumentedItem(null,"PageContents"),this.recourseViewModel=RecourseConfig.IsEnabled?new Recourse(this.requestData):null,!InstrumentationConfig.ManagedDataSources&&this.recourseViewModel&&ThresholdUtilities.pushOntoArray(this.pageDataSources,this.recourseViewModel.GetNewDataSources()),this.pageView=Sparkle.render("Threshold:PageCanvas",{uiCulture:SearchAppWrapper.CortanaApp.uiLanguage,properties:{Sections:this.sectionsRendered,Speller:this.spellerViewModel,LayoutInstItem:this.layoutInstItem,ViewState:this.viewState,PaginationItems:this._paginationItems,Recourse:this.recourseViewModel,IsIndexed:this.isIndexed},viewData:this.viewData},this.sectionsContainer),this.intervalTimer=setInterval(sj_dm(this,this.BeginRenderSections),n.PageWaitTime),i=0;i<r.length;i++)f=SectionRenderingConfig.GetSectionRenderingConfig(r[i],this.viewState),t=new PageSection(this.requestData,f,e,u),this.sections.push(t),this.completionTracker.Start(t),InstrumentationConfig.ManagedDataSources||ThresholdUtilities.pushOntoArray(this.pageDataSources,t.GetNewDataSources());this.mpi=InstrumentationConfig.ManagedDataSources?ThresholdInst.CreatePageImpression(this.pageName):Instrumentation.createPageImpression(this.pageName,this.GetNewDataSources())},n.prototype.BeginRenderSections=function(t){var r,i;if(this.sectionsToAddOnPage.length>0){for(r={},i=0;i<this.sections.length;i++)r[this.sections[i].Key]={ItemList:this.sections[i].GetItems()};this.requestAlterationEngine.AlterRequest(this.requestData,r,n.AlterationWaitTime,sj_dm(this,this.CompleteRenderSections,t))}else this.CompleteRenderSections(t)},n.prototype.CompleteRenderSections=function(t){var a=this,l=this.sectionsContainer,s=!1,r=MyStuffLocalization.AllStrings,i,f,o,e,h,u,c;if(t&&this.PopulatePagination(),t&&this.noResults)this.IsErrorPage?(i=r.PageError,f=r.PageErrorSubtitle):(i=r.NoResults,f=r.NoResultsSubtitle,SharedLogHelper.LogError("MyStuffNoResult",i)),Sparkle.render("Threshold:ErrorMessage",{uiCulture:SearchAppWrapper.CortanaApp.uiLanguage,properties:{Speller:this.spellerViewModel,PaginationItems:this._paginationItems,Message:i,MessageSubtitle:f,Recourse:this.recourseViewModel,IsIndexed:this.isIndexed},viewData:this.viewData},l),s=!0;else if(this.pageLoaded||this.sectionsRendered.length!==0||this.sectionsToAddOnPage.length!==0||this.IsErrorPage||++this.renderCount!==n.RenderingCycles){if(this.componentHasUpdated){for(o=this.requestData.GetSections(),e=[],h=0;h<o.length;h++)for(u=0;u<this.sectionsToAddOnPage.length;u++)o[h]===this.sectionsToAddOnPage[u].Key&&e.push(this.sectionsToAddOnPage[u]);if(this.sectionsToAddOnPage.splice(0,this.sectionsToAddOnPage.length),e&&(this.sectionsRendered=this.sectionsRendered.concat(e)),this.sectionsRendered.forEach(function(n){return n.PrerenderingProcess()}),o.length!==1||this.sectionsRendered.length!==1||this.paginationRendered||this.PopulatePagination(),!InstrumentationConfig.ManagedDataSources)for(c in this.sections)ThresholdUtilities.pushOntoArray(this.pageDataSources,this.sections[c].GetNewDataSources());this.renderCount>=n.RenderingCycles?this.pageView=Sparkle.render("Threshold:PageCanvas",{uiCulture:SearchAppWrapper.CortanaApp.uiLanguage,properties:{Sections:this.sectionsRendered,Speller:this.spellerViewModel,LayoutInstItem:this.layoutInstItem,ViewState:this.viewState,PaginationItems:this._paginationItems,Recourse:this.recourseViewModel,IsIndexed:this.isIndexed},viewData:this.viewData},this.sectionsContainer):Sparkle.update(this.pageView,{uiCulture:SearchAppWrapper.CortanaApp.uiLanguage,properties:{Sections:this.sectionsRendered,Speller:this.spellerViewModel,LayoutInstItem:this.layoutInstItem,ViewState:this.viewState,PaginationItems:this._paginationItems,Recourse:this.recourseViewModel,IsIndexed:this.isIndexed},viewData:this.viewData}),s=!0}}else i=r.StillWorking,f=r.StillWorkingSubtitle,SharedLogHelper.LogError("MyStuffStillLoading",i),Sparkle.render("Threshold:ErrorMessage",{uiCulture:SearchAppWrapper.CortanaApp.uiLanguage,properties:{Speller:this.spellerViewModel,PaginationItems:this._paginationItems,Message:i,MessageSubtitle:f,Recourse:this.recourseViewModel,IsIndexed:this.isIndexed},viewData:this.viewData},l),s=!0;s&&(InstrumentationConfig.ManagedDataSources||(this.headerViewModel&&ThresholdUtilities.pushOntoArray(this.pageDataSources,this.headerViewModel.GetNewDataSources()),this.spellerViewModel&&ThresholdUtilities.pushOntoArray(this.pageDataSources,this.spellerViewModel.GetNewDataSources()),this._paginationItems&&this._paginationItems.DataSource&&this.pageDataSources.push(this._paginationItems.DataSource)),t&&(this.clearProgressBar(),this.pageLoaded=!0),this.componentHasUpdated=!1,_w.setImmediate(function(){return a.LogUpdates()}))},n.prototype.PopulatePagination=function(){var t=this.sections,n;t.length!==1||this.paginationRendered||(n=t[0].GetPaginationSubSection(),n&&(this._paginationItems=this._paginationControl.GetPaginationItems(this.requestData,n),this.paginationRendered=!0))},n.prototype.RenderErrorPage=function(){var n=sj_ce("div"),t,r,i;n.className="DeviceContent",typeof TestHooksEnabled!="undefined"&&TestHooksEnabled&&n.setAttribute("data-tag","MyStuff.Error"),t=sj_ce("div"),t.className="messageHeader",r=sj_ce("div"),t.innerText=MyStuffLocalization.AllStrings.PageError,r.innerText=MyStuffLocalization.AllStrings.TryAgainError,n.appendChild(t),n.appendChild(r),i=this.sectionsContainer.childNodes,i.length>0?this.sectionsContainer.insertBefore(n,i[0]):this.sectionsContainer.appendChild(n),this.clearProgressBar()},n.prototype.clearProgressBar=function(){var n=_ge("b_progress");n&&(_ge("b_progress").style.display="none")},n.prototype.setCortanaHeader=function(){if(!ComponentsConfig.EchoEnabled){var n=SearchAppWrapper.CortanaApp,t=MyStuffLocalization.AllStrings;this.completionTracker.IsFullyComplete()?(n.setEmotion("calm1",!1,!1),this.noResults?n.setCortanaText(MyStuffLocalization.getLocalStringForScope(this.requestData.GetScope()).HeaderNoResults):n.setCortanaText(t.SearchCompleted)):(n.setEmotion("id=thinking1,c=0",!1,!1),n.setCortanaText(t.Searching))}},n.prototype.LogUpdates=function(){InstrumentationConfig.ManagedDataSources?ThresholdInst.LogUpdatedLayoutCentralizedDataSources(_d.body):ThresholdInst.LogUpdatedLayout(_d.body,this.GetNewDataSources())},n.prototype.fireFeedbackEvent=function(){sj_evt.fire("WindowsFeedback.Badge.Show")},n.prototype.createInstrumentedItem=function(n,t){var i=ThresholdInst.CreateInstrumentedItem(n,t);return InstrumentationConfig.ManagedDataSources||this.pageDataSources.push(i.GetDataSource()),i},n.SmallImageConfig={GetBestLayoutStrategy:function(){return{ImageCssRMSKey:"SquareExtraSmall",ImageCssClassName:"square_xs"}}},n.LargeImageConfig={GetBestLayoutStrategy:function(){return{ImageCssRMSKey:"SquareBig",ImageCssClassName:"square_b"}}},n.PageWaitTime=500,n.AlterationWaitTime=500,n.PagePrefix="Page.Device.",n.RenderingCycles=10,n}();var AccessibilityNavigation;(function(n){function u(n){t.Navigate(n)}function r(){t.OnLoad()}var i=function(){function n(){this.lastArrowedElement="lastArrowedElement",this.focusLink="focusLink",this.resetNav=!0,this.up=38,this.down=40,this.left=37,this.right=39,this.tab=9,this.tileMargins=10,this.arrowSelector=".Header .dropdowns select, .Header .lower > a, .subsection > li, .subsectionTitles > a, .DTLItem, div[data-region='Recourse'] li",this.tabSelector=".b_tabgroup"}return n.prototype.OnLoad=function(){this.resetNav=!0},n.prototype.Navigate=function(n){var t=n.keyCode,r,i;(t===this.right||t===this.left||t===this.down||t===this.up||t===this.tab)&&(i=this.getMatchingContainer(document.activeElement,this.arrowSelector),this.activeElement!==i&&(this.updateActiveElement(i),this.activeTabGroup=this.getMatchingContainer(this.activeElement,this.tabSelector)),this.activeTabGroup&&this.activeTabGroup[this.lastArrowedElement]&&this.updateActiveElement(this.activeTabGroup[this.lastArrowedElement]),this.activeElement&&this.activeElement.tagName!=="SELECT"&&this.activeTabGroup&&(t===this.right||t===this.left||t===this.down||t===this.up)?r=this.handleArrowKeyNavigation(t):t===this.tab&&(r=this.handleTabNavigation(n.shiftKey)),r&&n.preventDefault())},n.prototype.convertListToArray=function(n,t){for(var r=[],i=0;i<n.length;i++)(!t||t(n[i]))&&r.push(n[i]);return r},n.prototype.findElementAtPosition=function(n,t,i){for(var u=0;u<i.length;u++){var r=i[u],o=sj_go(r,"Top"),h=sj_go(r,"Left"),c=r.offsetWidth,s=r.offsetHeight,f=t-o,e=n-h;if(f>=0&&f<s&&e>=0&&e<c)return r[this.focusLink]=this.findSelectableElement(r),r}return null},n.prototype.findSelectableElement=function(n){return n?n.tagName==="A"||n.tagName==="SELECT"?n:n.querySelector("a, select"):null},n.prototype.getAdjacentElement=function(n){var u=sj_go(this.activeElement,"Top"),f=sj_go(this.activeElement,"Left"),s=this.activeElement.offsetWidth,h=this.activeElement.offsetHeight,r=10,i,t,o,e;switch(n){case this.right:i=f+s+r,t=u+h/2;break;case this.left:i=f-r,t=u+h/2;break;case this.up:i=f+s/2,t=u-r;break;case this.down:i=f+s/2,t=u+h+r;break;default:return null}return(o=this.getElementArray(this.activeTabGroup),e=this.findElementAtPosition(i,t,o),e)?e:this.findElementAtPosition(i-r,t,o)},n.prototype.getElementArray=function(n){var i=n.querySelectorAll(this.arrowSelector),t=n.tagName;return i.length===0&&(t==="A"||t==="SELECT")&&n.msMatchesSelector(this.arrowSelector)?[n]:this.convertListToArray(i,this.selectableElementValidation)},n.prototype.getMatchingContainer=function(n,t){while(n&&!n.msMatchesSelector(t))n=n.parentElement;return n},n.prototype.getNextFocus=function(n){var t=this.getAdjacentElement(n);if((!t||!t[this.focusLink])&&!this.isTwoDimensional(this.activeElement,this.activeTabGroup)){var r=37,u=[1,0,3,2],f=[3,2,1,0],i=n-r;i=r+(_d.body.dir!=="rtl"?u[i]:f[i]),t=this.getAdjacentElement(i)}return t&&t[this.focusLink]?t:null},n.prototype.getTabArray=function(){for(var i=_d.querySelectorAll(this.tabSelector),r=[],t,u,n=0;n<i.length;n++)t=i[n],t.parentNode.classList.contains("subsectionTitles")&&(u=i[n+1],r.push(u),n++),r.push(t);return this.convertListToArray(r,this.selectableElementValidation)},n.prototype.handleArrowKeyNavigation=function(n){var t=this.getNextFocus(n);return t&&this.updateActiveElement(t),this.setFocus(this.activeElement)},n.prototype.handleTabNavigation=function(n){var u=this.getTabArray(),r,i,t;if(this.activeTabGroup){if(i=u.indexOf(this.activeTabGroup),!n&&i==u.length-1||n&&i==0)return!1;r=i+(n?-1:1)}else r=0;return t=u[r],this.resetNav&&(t[this.lastArrowedElement]=t.querySelector(".b_active"),this.resetNav=!1),t[this.lastArrowedElement]?this.updateActiveElement(t[this.lastArrowedElement]):this.updateActiveElement(this.getElementArray(t)[0]),this.activeTabGroup=t,this.activeElement[this.focusLink]=this.findSelectableElement(this.activeElement),this.setFocus(this.activeElement)},n.prototype.isTwoDimensional=function(n,t){return t.offsetWidth>=1.5*n.offsetWidth&&t.offsetHeight>=1.5*n.offsetHeight?!0:!1},n.prototype.selectableElementValidation=function(n){return n.tagName==="A"||n.tagName==="SELECT"||null!=n.querySelector("a, select")},n.prototype.setFocus=function(n){if(this.activeTabGroup[this.lastArrowedElement]=this.activeElement,n&&n[this.focusLink]){var t=n[this.focusLink];return t.setAttribute("aria-live","true"),t.focus(),!0}return!1},n.prototype.updateActiveElement=function(n){var t=this.activeElement;this.activeElement=n,t&&this.updateDeselectedElement(t),this.activeElement&&this.updateSelectedElement(this.activeElement)},n.prototype.updateDeselectedElement=function(n){n.setAttribute("aria-selected","false"),n.classList.remove("b_select")},n.prototype.updateSelectedElement=function(n){n.setAttribute("aria-selected","true"),n.tagName==="LI"&&n.classList.add("b_select")},n}(),t;n.KeyboardNavigator=i,t=new i,sj_be(_d,"keydown",u),sj_evt.bind("ajax.load",r,1)})(AccessibilityNavigation||(AccessibilityNavigation={}));var MyStuffLocalization;(function(n){function t(t){var i={Title:"",HeaderNoResults:""};switch(t){case"all":i.Title=n.AllStrings.AllTitle;break;case"apps":i.Title=n.AllStrings.AppsTitle,i.HeaderNoResults=n.AllStrings.AppsHeaderNoResult;break;case"files":i.Title=n.AllStrings.FilesTitle,i.HeaderNoResults=n.AllStrings.FilesHeaderNoResult;break;case"folders":i.Title=n.AllStrings.FoldersTitle,i.HeaderNoResults=n.AllStrings.FoldersHeaderNoResult;break;case"settings":i.Title=n.AllStrings.SettingsTitle,i.HeaderNoResults=n.AllStrings.SettingsHeaderNoResult;break;case"music":i.Title=n.AllStrings.MusicTitle,i.HeaderNoResults=n.AllStrings.MusicHeaderNoResult;break;case"pictures":i.Title=n.AllStrings.PhotosTitle,i.HeaderNoResults=n.AllStrings.PhotosHeaderNoResult;break;case"videos":i.Title=n.AllStrings.VideosTitle,i.HeaderNoResults=n.AllStrings.VideosHeaderNoResult;break;case"emails":i.Title=n.AllStrings.EmailsTitle,i.HeaderNoResults=n.AllStrings.EmailsHeaderNoResult}return i}n.AllStrings=LocStringManager.getLocString({uiCulture:SearchAppWrapper.CortanaApp.uiLanguage,name:"LocStrings",namespace:"Threshold"}),n.getLocalStringForScope=t})(MyStuffLocalization||(MyStuffLocalization={}));var AutoSuggest;(function(n){var t;(function(t){var i;(function(t){function v(){return!!i}function a(){return e}function c(){return r}function o(n,t){var i=_ge(n.id);t?i.className.indexOf(f)===-1&&(i.className+=f):i.className=i.className.replace(f,"")}function y(n){r&&(r.selected=!1,o(r,!1)),r=n,r&&(r.selected=!0,o(r,!0))}function l(n,t,i,r){h(t,i,s(n,r))}function s(t,i){return t.map(function(t){var r={id:t.verb,text:t.displayName,isSeparator:!t.verb,selected:!1};return r.isSeparator||(r.click=function(){i(t.verb),n.safeExecute(function(){t.executeAsync(),u()},"verb.executeAsync")}),r})}function h(n,t,r){if(u(),r.length>0){e=r.filter(function(n){return!n.isSeparator}),i=_d.createElement("div"),i.id="contextMenu",i.className="contextMenu",i.style.top="1px",i.style.left="1px",i.style.visibility="hidden";var f;r.forEach(function(n){var r,t;n.isSeparator?(r=_d.createElement("hr"),r.className="divider",i.appendChild(r)):(t=_d.createElement("div"),t.id=n.id,t.textContent=n.text,t.className="contextMenuItem",t.addEventListener("mouseup",function(t){t.button==0&&n.click()}),i.appendChild(t))}),_d.body.appendChild(i),sb_st(function(){var u=i.offsetWidth+1,r=i.offsetHeight+1;i.style.left=i.parentElement.offsetWidth-n<u?i.parentElement.offsetWidth-u+"px":n+"px",i.style.top=i.parentElement.offsetHeight-t<r?i.parentElement.offsetHeight-r+"px":t+"px",i.style.visibility=""},0)}}function u(){i&&(_d.body.removeChild(i),i=null,e=[],r=null)}var i,e=[],r,f;t.isContextMenuVisible=v,t.getSelectableItems=a,t.getSelectedItem=c,f=" sa_hv",t.select=y,t.showContextMenu=l,t.dismiss=u,_d.body.addEventListener("mouseup",u),_w.addEventListener("blur",u),sj_evt.bind("ajax.threshold.pageStart",u)})(i=t.ContextMenus||(t.ContextMenus={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var MyStuffContextMenu;(function(n){function r(n,i){return i&&i.canHaveContextMenu?(ThresholdUtilities.wrapApiCall(i,"getVerbsAsync","",i.displayName).then(sj_df(t,n.x,n.y)),!0):!1}function u(n,r){var u=[new i(r.SeeMore,"OneDriveOpenFile")];return r.LocationUrl&&u.push(new i(r.LocationUrl,"OneDriveOpenFileLocation")),t(u,n.x,n.y),!0}function t(n,t,i){AutoSuggest.Windows.ContextMenus.showContextMenu(n,t+_w.pageXOffset,i+_w.pageYOffset,function(){})}var i=function(){function n(n,t){this.verb=t,this.url=n,this.displayName=MyStuffLocalization.AllStrings[t]}return n.prototype.executeAsync=function(){return SearchAppWrapper.CortanaApp.launcher.launchUriAsync(this.url)},n}();n.Handler=r,n.OneDriveHandler=u})(MyStuffContextMenu||(MyStuffContextMenu={}));var ServerQueryAugmentation=function(){function n(){this.apiType="MyStuffQueryAugmentation"}return n.prototype.AlterRequest=function(n,t,i,r){var f=!0,u=n.GetQuery();return this.previousQuery==u?f=!1:(this.requestData=n,this.callback=r,this.getOnlineAugmentations(),this.previousQuery=u),f},n.prototype.getOnlineAugmentations=function(){var i;ThresholdUtilities.recordApiTime(this.apiType+"_SQAS");var u="/ThresholdRelevance/QueryAugmentation",t=sj_gx(),f=_w.location.search,r=this.requestData.GetQuery(),n=ThresholdUtilities.setUrlParameter(u,"q",ThresholdUtilities.getUrlReadyQuery(r));_G.IG&&(n=ThresholdUtilities.setUrlParameter(n,"IG",_G.IG),i=ThresholdInst.CreateDataSourceItem(),n=ThresholdUtilities.setUrlParameter(n,"IID",i.AppNS+"."+i.K)),typeof CopyTestParameters!="undefined"&&(n=CopyTestParameters(f,n)),t.open("POST",n,!0),t.onreadystatechange=sj_dm(this,this.requestCallback,t,r),t.send(this.requestData.TaskFrame)},n.prototype.requestCallback=function(n,t,i){if(t.readyState===t.DONE){if(t.status===200){var r=ThresholdUtilities.parseJSON(t.response);r?this.processResponse(i,r):(ThresholdUtilities.recordApiTime(this.apiType+"_SQAE"),SharedLogHelper.LogError(this.apiType+"_Error","invalid response"))}else ThresholdUtilities.recordApiTime(this.apiType+"_SQAE"),SharedLogHelper.LogError(this.apiType+"_Error","invalid Status:"+t.status);this.callback()}},n.prototype.processResponse=function(n,t){var i,u,r;ThresholdUtilities.recordApiTime(this.apiType+"_SQAC"),t&&t.Results&&(i=t.Results.QueryAlterations,u=this.requestData.TaskFrame,i&&i.Content&&i.Content.MyStuffAugmentation&&(r=i.Content.MyStuffAugmentation,r.AlteredQueries&&(u.AlteredQueries=r.AlteredQueries)))},n}(),SectionOrder,QueryAugmentation,MyStuffSectionType;(function(){RequestAlteration.RegisterComponent(new ServerQueryAugmentation)})(QueryAugmentation||(QueryAugmentation={})),SectionOrder=function(){function n(){}return n.prototype.AlterRequest=function(n,t,i,r){var c,s,u,f,o,e,h;if(!n||n.GetScope()!="all")return!1;if(c=n.GetQuery(),(!this.querySectionOrder||this.querySectionOrder.Query!=c)&&_w.localStorage)try{s=_w.localStorage.QFGroupOrder,this.querySectionOrder=ThresholdUtilities.parseJSON(s)}catch(l){SharedLogHelper.LogWarning("SectionOrder","exception in parsing QFGroupOrder: "+s?s:"",l)}if(this.querySectionOrder&&this.querySectionOrder.Query==c){if(u=this.querySectionOrder.SectionOrder,f=n.TaskFrame.OrderedSections,u&&u.length>0&&f&&f.length>0){for(o=[],e=0;e<u.length;e++)h=MyStuffSectionType[u[e]].toLowerCase(),f.indexOf(h)>=0&&o.push(h);n.TaskFrame.OrderedSections=o.concat(f.filter(function(n){return o.indexOf(n)<0}))}return r(),!0}},n}(),function(){RequestAlteration.RegisterComponent(new SectionOrder)}(QueryAugmentation||(QueryAugmentation={})),function(n){n[n.Apps=0]="Apps",n[n.Settings=1]="Settings",n[n.Files=2]="Files",n[n.Pictures=3]="Pictures",n[n.Videos=4]="Videos",n[n.Music=5]="Music",n[n.Folders=6]="Folders",n[n.Emails=7]="Emails",n[n.Default=255]="Default"}(MyStuffSectionType||(MyStuffSectionType={}));var PhysicalPage;(function(){function f(){var n=_w.location.toString();t.renderPage(n,t.Origin.DirectNav)}function i(n,t){var u=ThresholdUtilities.getDecodedQuery(n),i=new VirtualPage;t(i.SerializeState(),i.IsErrorPage),sj_evt.bind("onP1",sj_df(r,n,u,i),!0)}function r(n,t,i,r){t=ThresholdUtilities.setUrlParameter(t,"q",ThresholdUtilities.getUrlReadyQuery(i));var u=ThresholdUtilities.getUrlParameter(t,"scope");r.Initialize(i,t,u),ThresholdUtilities.setBodyLangAttributes(SearchAppWrapper.CortanaApp.uiLanguage)}function u(){var n="showWebViewAsync";SearchAppWrapper.CortanaApp[n]&&SearchAppWrapper.Utils.wrapApiCallWithTimeout(SearchAppWrapper.CortanaApp,n,"SWV",null,500,null)}var e=require("ajax.provider.threshold"),t=require("ajax.lifeCycle"),o=document.createElement("div"),s;o.style.display="none",s="scope",e.setJsonProvider(i),sj_evt.bind("ajax.startNewQuery",f,1),sj_evt.bind("directNavComplete",function(){sj_evt.bind("ajax.navigateStart",function(){u(),sj_evt.fire("ajax.threshold.pageStart",sb_gt())},1)})})(PhysicalPage||(PhysicalPage={}));var ResultListAlterationFactory=function(){function n(){this.altererSets={},this.querySets={}}return n.prototype.RegisterAlterer=function(n,t){var i=this.altererSets[n];i||(this.altererSets[n]=i=[]),i.push(t)},n.prototype.GetAlterationEngine=function(n,t){var u=this.altererSets[t],f=null,i=this.querySets[n],o,e,r;if(i||(i=new WeakMap,this.querySets[n]=i),u){f=[];for(o in u)e=u[o],r=i.get(e),r||(r=u[o].Create(n,t),i.set(e,r)),f.push(r)}return new ResultListAlterationEngine(f)},n}(),ResultListAlterationEngine=function(){function n(n){this.currentAltererIndex=-1,this.timeout=-1,this.completed=!1,n||(n=[]),this.alterers=n}return n.WrapDeviceItem=function(n){return{deviceItem:n,thumbnail:null,updateCallbacks:[]}},n.WrapDeviceItems=function(t){var r=[],i;for(i in t)r.push(n.WrapDeviceItem(t[i]));return r},n.prototype.IsItemSuppressed=function(n){for(var i=!1,r=this.alterers,u=r.length,t=0;!i&&t<u;t++)i=r[t].IsItemSuppressed(n);return i},n.prototype.AlterResultList=function(n,t,i){if(this.currentAltererIndex>=0)throw new Error("AlterResultList called while alteration already in progress.");else this.callback=t,this.completionTarget=sb_gt()+i,this.currentAltererIndex=0,this.lastResultList=n,this.completed=!1,this.alterers.length>0?(this.alterers[this.currentAltererIndex].AlterResultList(n,sj_dm(this,this.alterationIterationStep)),this.timeout=sb_st(sj_dm(this,this.completeAlteration),i)):this.completeAlteration(n)},n.prototype.completeAlteration=function(n){this.completed||(n||(n=this.alterers[this.currentAltererIndex].GetCurrentResultList()),this.completed=!0,this.currentAltererIndex=0,this.callback(n)),this.timeout&&sb_ct(this.timeout)},n.prototype.alterationIterationStep=function(){var i,t,r;this.timeout&&sb_ct(this.timeout),this.completed||(i=sb_gt(),t=this.alterers[this.currentAltererIndex].GetCurrentResultList(),t?this.lastResultList=t:t=this.lastResultList,i>=this.completionTarget||this.currentAltererIndex===this.alterers.length-1?this.completeAlteration(t):(this.currentAltererIndex++,r=this.completionTarget-i,this.alterers[this.currentAltererIndex].AlterResultList(t,sj_dm(this,this.alterationIterationStep)),this.timeout=sb_st(sj_dm(this,this.completeAlteration),r)))},n}(),ResultListAlterationFactoryInstance=new ResultListAlterationFactory;var AutoSuggest;(function(n){var t;(function(t){function e(n,t,r,u){typeof indexedDB!="undefined"&&new i(n,u,t,r)}function f(n,t,r,u){typeof indexedDB!="undefined"&&new i(n,u,t,r)}function s(n,t,r,u,f){typeof indexedDB!="undefined"&&new i(n,f,t,r,u)}function r(n,t,r,u,f){typeof indexedDB!="undefined"&&new i(n,f,t,r,u)}function u(t){n.safeExecute(function(){return indexedDB.deleteDatabase(t)},"delete "+t)}var o=function(){function n(){}return n.ConnectionNotEstablished="X",n.ErrorWhenQueryingDb="E",n.QuerySucceeded="R",n}(),i;t.StorageState=o,t.instanceWithNumberKeys=e,t.instanceWithStringKeys=f,t.instanceWithNumberKeysAndSecondaryKey=s,t.instanceWithStringKeysAndSecondaryKey=r,t.deleteInstance=u,i=function(){function n(n,t,i,r,u){var f=this;this.database=null,this.closed=!1,this.safeExecute(function(){f.databaseName=n,f.storeName=n+"Store",f.secondaryIndex=u;var e;try{e=indexedDB.open(n,t||1)}catch(o){r(new Error("IndexedDbClientSideStorage.const: Could not open database"));return}e.onsuccess=function(n){f.database=n.target.result,i&&i(f)},e.onupgradeneeded=function(n){var t=n.target.result,i;t.objectStoreNames.contains(f.storeName)&&t.deleteObjectStore(f.storeName),i=t.createObjectStore(f.storeName),f.secondaryIndex&&i.createIndex(f.secondaryIndex,f.secondaryIndex,{unique:!1})},e.onerror=function(t){indexedDB.deleteDatabase(n),f.handleErrorEvent("openDbRequest.onerror",r)(t)},e.onblocked=f.handleErrorEvent("openDbRequest.onblocked",r)},r,!0)}return n.prototype.put=function(n,t,i,r){var u=this;this.safeExecute(function(){var e=u.database.transaction(u.storeName,"readwrite").objectStore(u.storeName),f=e.put(t,n);f.onsuccess=i,f.onerror=u.handleErrorEvent("putRequest.onerror",r)},r)},n.prototype.putMultiple=function(n,t,i){var r=this;this.safeExecute(function(){var e=r.database.transaction(r.storeName,"readwrite").objectStore(r.storeName),u=0,f=function(){if(u<n.length){var o=e.put(n[u].value,n[u].key);u+=1,o.onsuccess=u==n.length-1?t:f,o.onerror=r.handleErrorEvent("putRequest.onerror",i)}};f()},i)},n.prototype.getValue=function(n,t,i){var r=this;this.safeExecute(function(){var f=r.database.transaction(r.storeName,"readonly").objectStore(r.storeName),u=f.get(n);u.onsuccess=function(n){var i=n.target.result;t(i)},u.onerror=r.handleErrorEvent("getRequest.onerror",i)},i)},n.prototype.getRange=function(n,t,i,r){var u=this;this.safeExecute(function(){var o=u.database.transaction(u.storeName,"readonly").objectStore(u.storeName),e=IDBKeyRange.bound(n,t,!1,!0),f=o;u.parseOpenCursorRequest(f.openCursor(e),i,r)},r)},n.prototype.getRangeOnSecondaryKey=function(n,t,i,r){var u=this;this.safeExecute(function(){var e=u.database.transaction(u.storeName,"readonly").objectStore(u.storeName),o=IDBKeyRange.bound(n,t,!1,!0),f;u.secondaryIndex?(f=e.index(u.secondaryIndex),u.parseOpenCursorRequest(f.openCursor(o),i,r)):r(new Error("getRangeOnSecondaryKey: Index name is missing"))},r)},n.prototype.remove=function(n,t,i){var r=this;this.safeExecute(function(){var e=r.database.transaction(r.storeName,"readwrite").objectStore(r.storeName),u=0,f=function(){if(u<n.length){var o=e["delete"](n[u]);o.onsuccess=u==n.length-1?t:f,o.onerror=r.handleErrorEvent("removeRequest.onError",i)}};f()},i)},n.prototype.getAll=function(n,t){var i=this;this.safeExecute(function(){var r=i.database.transaction(i.storeName,"readonly").objectStore(i.storeName);i.parseOpenCursorRequest(r.openCursor(),n,t)},t)},n.prototype.close=function(){this.closed=!0,this.database&&(this.database.close(),this.database=null)},n.prototype.isClosed=function(){return this.closed},n.prototype.parseOpenCursorRequest=function(n,t,i){var r=[];n.onsuccess=function(n){var i=n.target.result;if(!i){t(r);return}r.push({key:i.primaryKey,value:i.value}),i["continue"]()},n.onerror=this.handleErrorEvent("openCursorRequest.onError",i)},n.prototype.safeExecute=function(n,t,i){try{i||this.database?n():this.reportError(t,"Database not initialized")}catch(r){this.reportError(t,r.message)}},n.prototype.handleErrorEvent=function(n,t){var i=this;return function(r){var u=n;try{u+=" "+r.target.error.name}catch(f){}i.reportError(t,u)}},n.prototype.reportError=function(n,t){var i=new Error(t);n(i)},n}()})(t=n.ClientSideStorage||(n.ClientSideStorage={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var r=100,i=function(){function i(n,t,i,r,u,f,e){var o=this;this._storageOpenInProgress=!1,this._pendingQueries=[],this._config=n,this._storageFactory=t,this._createResponse=i,this._dataPopulated=r,this._getProviderState=u,this._responseType=f,e?(e.bindAppVisible(function(){return o.initStorage()}),e.bindDismissed(function(){return o._pendingQueries=[]}),e.bindAppHidden(function(){return o.teardownStorage()})):this.initStorage()}return i.prototype.teardownStorage=function(){this._storage&&(this._storage.close(),this._storage=null)},i.prototype.initStorage=function(){var n=this;!this._storageOpenInProgress&&this._dataPopulated()&&(this._storageOpenInProgress=!0,this._storageFactory(function(t){n._storage=t,n._storageOpenInProgress=!1,n._pendingQueries.forEach(function(n){return n()}),n._pendingQueries=[]},function(t){n.onError(t,"open "+n._responseType+" storage");n._storageOpenInProgress=!1,n._pendingQueries.forEach(function(n){return n()}),n._pendingQueries=[]}))},i.prototype.onError=function(t,i){var r=this;n.reportException(t,i),this.teardownStorage(),setTimeout(function(){return r.initStorage()},0)},i.prototype.reloadStorage=function(){this.teardownStorage(),this.initStorage()},i.prototype.isReady=function(){return!!this._storage},i.prototype.fetch=function(i,r,u,f,e){var s=this,o;n.isResponseTypeEnabled(this._responseType,i,this._config)&&(o=function(n,t){e()&&r(s._responseType,s._createResponse(i,n),s._getProviderState(t))},this.queryStorage(i,function(n){return o(n,t.StorageState.QuerySucceeded)},function(){return o(null,t.StorageState.ErrorWhenQueryingDb)},function(){return o(null,t.StorageState.ConnectionNotEstablished)}))},i.prototype.withStorage=function(n){this._storage&&n(this._storage)},i.prototype.queryStorage=function(n,t,i,u){var e=this,o=null,f=!1,s=function(){f||(f=!0,o&&clearTimeout(o),e._storage?e._storage.getValue(n.queryToFetch,function(n){return t(n)},function(n){e.onError(n,"query "+e._responseType);i()}):u())};this._storage?s():(this.initStorage(),this._storageOpenInProgress?(this._pendingQueries.push(s),o=setTimeout(function(){f||(f=!0,u())},r)):u())},i}();t.StorageBasedDataProvider=i})(t=n.ClientSideStorage||(n.ClientSideStorage={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(n){var f=function(){function n(){}return n.User="SRCHHPGUSR",n.History="_UR",n}(),u,r,t,i;n.CookieNames=f,u=function(){function n(){}return n.AutoSuggest="AS",n.History="OMW",n}(),n.CrumbNames=u,r=function(){function n(){}return n.CursorPosition="cp",n.Options="o",n.ConversationId="cvid",n.SuggestionCount="sc",n.PartialQuery="pq",n.SuggestionPosition="sp",n.SuggestionType="qs",n.PreviewPaneSuggestionType="qsc",n.SkipValue="sk",n.PreviewPaneSkipValue="skc",n.Ghosting="ghc",n.PreviewPaneDisabled="ppd",n.Css="css",n.CssVersion="ver",n.Count="count",n.DataSet="ds",n.SessionId="sid",n.TimeStamp="qt",n.Query="q",n.ImpressionGuid="ig",n.QFQuery="qry",n.FormCode="form",n.HashedMuid="nclid",n}(),n.QueryParams=r,t=function(){function n(){}return n.HistoryEnabled="hs",n.HitHighlighting="h",n.PopularNow="p",n.Local="l",n.Answers="a",n}(),n.Options=t,i=function(){function n(){}return n.Id="id",n.Query="query",n.Url="url",n.Navigation="nav",n.Type="stype",n.Autocomplete="hc",n}(),n.SuggestionAttributes=i})(t=n.Service||(n.Service={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){function et(){return navigator.onLine}function l(n){return n?n.replace(w,"$1").replace(p,"$1 "):n}function ht(n){return n?n.replace(/-/g,"").replace("{","").replace("}","").toLowerCase():null}function ft(t,i){t.query.indexOf(i.queryToFetch)==-1&&t.query.toLowerCase().indexOf(i.queryToFetch.toLowerCase())==0&&(t.query=i.queryToFetch+t.query.substr(i.queryToFetch.length),t.text=n.HitHighlighting.addMarkers(t.query,i.queryToFetch))}function c(n,i,r,u){var f,e;n&&(n=n.slice(0,i)+t+n.slice(i,n.length)),f=r(n),f&&(e=f.indexOf(t),i=e!=-1?e:i,f=f.replace(t,"")),u(f,i)}function rt(n,t){var i,r;return c(n,t,l,function(n,t){i=n,r=t}),{originalQuery:n,originalCursorPosition:t,queryToFetch:i,cursorPosition:r,enabledProviderResponses:null,disabledProviderResponses:[],webResponseNeeded:!0,equals:function(n){return(i?i.toLowerCase():i)==(n.queryToFetch?n.queryToFetch.toLowerCase():n.queryToFetch)}}}function ut(n,t,i){return i.disabledProviderResponses[n]?!1:t&&(t.disabledProviderResponses.some(function(t){return t==n})||t.enabledProviderResponses&&!t.enabledProviderResponses.some(function(t){return t.responseType==n}))?!1:!0}function tt(n){return n=n.trim(),n.replace(/^\/+|^(ht+p(s?)[;:]+)?\/*/i,"http$2://")}function it(n,t){for(var i=0;i<n.length;++i)if(t(n[i]))return i;return-1}function b(n,t){if(n.length!=t.length)return!1;for(var i=0;i<n.length;++i)if(n[i]!=t[i])return!1;return!0}function st(n,t){return n?n.replace(ot,function(n){return t[parseInt(n.substring(1,n.length-1))]}):n}function f(n){var i=n?n.number:null,t=n?n.name:null;return i==-2147023673||t=="Canceled"}function s(t,i,r){var s,e,o,c;f(t)||(s=t?t.number:null,e=(t?(t.stack||t.message||t)+"":"").replace(u,"").replace(h,"\n").split("\n"),e.length>1&&e[0]==e[1]&&(e=e.slice(1)),o="["+i+"] "+(s?s+" ":"")+e[0]+(r?"\n"+r:"")+(e.length>1?"\n"+e.slice(1).join("\n"):""),n.log(o,t),c={Text:o,Meta:_w.location.href,Name:"JSError"},Log2.LogEvent("ClientInst",c,"Error"))}function nt(n,t,i,r){try{return n()}catch(u){return s(u,t,r),i}}function v(n){return o.indexOf(n)!=-1}function d(n){return y.indexOf(n)!=-1}function g(n){return a.indexOf(n)!=-1}function k(n,t){return n==93||n==121&&t}var i=n.Service.QueryParams,t=String.fromCharCode(57346),w=new RegExp("^\\s*("+t+")?\\s*","g"),p=new RegExp("\\s*("+t+")?\\s+","g"),ot=/{[0-9]+}/g,u,h,r,e;n.isBrowserOnline=et,n.cleanQuery=l,n.cleanGuid=ht,n.adjustCasing=ft,n.mantainCursorPositionIn=c,n.parseQuery=rt,n.isResponseTypeEnabled=ut,n.fixUrlProtocol=tt,n.indexOf=it,n.sequenceEqual=b,n.log=function(){},sa_config.th&&(n.log=n.ClientTestHooks.ClientLog),n.formatString=st,n.isCancellation=f,u=/\r/g,h=/\n\n/g,n.reportException=s,n.safeExecute=nt,n.WebResponseType="Web";var o=[38,40,9,],y=o.concat([36,35,33,34,]),a=[3,16,17,18,19,20,45,91,92,93,144,145,];n.isNavigationKey=v,n.isMovingCursorKey=d,n.isModifierKey=g,n.isContextMenuKey=k,r=function(){function n(){this._callbacks={},this._lastId=0}return n.prototype.register=function(n){var t=++this._lastId;return this._callbacks[t]=n,t},n.prototype.unregister=function(n){delete this._callbacks[n]},n.prototype.cancelAll=function(){for(var n in this._callbacks)this._callbacks[n]();this._callbacks={}},n}(),n.CancellationManager=r,e=function(){function t(t,i,u,f,e,o,s,h,c,l){var a=this;if(t.cancellationEnabled&&(this._cancellationManager=new r),this._config=t,this._settings=i,this._host=u,this._suggestionsParser=f,this._rootViewModel=e,this._suggestionsRenderingManager=o,this._webProvider=s,this._otherProviders=h,this._currentQuery=u.getQuery(),this._instrumentationHelper=c,this._sequenceNumberManager=l,u.bindAppVisible(function(){return a.warmUpWebProvider()}),u.bindConversationStart(function(){a._lastQuery=null,a._currentQuery=null,a._lastQueryWithoutHistory=null,a._lastKeyWasEnter=!1,a._instrumentationHelper.reset()}),u.bindDismissed(function(){a.finishPreviousQuery(),a._suggestionsRenderingManager.resetState(),a._sequenceNumberManager.reset(),a._fetchTimer&&(sb_ct(a._fetchTimer),a._fetchTimer=null),a._config.th&&n.ClientTestHooks.resetLog()}),u.bindQueryChanged(function(n){return a.onQueryChanged(n)}),u.bindKeyDown(function(n,t){return a.onKeyDown(n,t)}),this._currentQuery.queryToFetch||this._currentQuery.queryToFetch==""&&i.emptyQueryScenarioEnabled()){e.onQueryChanged(this._currentQuery);this.fetchForQueryChange(0)}else this._lastQuery=this._currentQuery}return t.prototype.warmUpWebProvider=function(){var t=this;this._instrumentationHelper.profileKeystroke(n.InstrumentationCommon.INVALID_SEQUENCE_NUMBER,function(){return"warmUpWeb"},function(){return t._webProvider.warmUp()})},t.prototype.finishPreviousQuery=function(){this.cancelPreviousQuery();var n=this._sequenceNumberManager.getSequenceNumber();n>0&&this._instrumentationHelper.finalizeKeystrokeLog(n)},t.prototype.onKeyDown=function(n,t){var i=n==13;if(i){if(!this._lastKeyWasEnter)this.onSubmit(t)}else(n==8||n==46||n==88&&t.ctrlKey)&&(this._config.forceDefaultTopResultWhenBackspacing||this._host.didLastKeyRemoveAutocompletion())?(this._suggestionsRenderingManager.setDefaultTopResult(this._sequenceNumberManager.getNextSequenceNumber()),this._lastQuery=null):this._suggestionsRenderingManager.setDefaultTopResult(-1);this._lastKeyWasEnter=i},t.prototype.onQueryChanged=function(n){var i=this,t;this._currentQuery=n,this._lastQuery&&!this._lastQuery.equals(this._currentQuery)&&this.cancelPreviousQuery(),this._config.d<=0?this.fetchForQueryChange(0):(this._fetchTimer&&sb_ct(this._fetchTimer),t=Date.now(),this._fetchTimer=sb_st(function(){return i.fetchForQueryChange(Date.now()-t)},this._config.d)),this._lastKeyWasEnter=!1},t.prototype.onSubmit=function(n){this._fetchTimer&&(sb_ct(this._fetchTimer),this.fetchForQueryChange(0)),this._instrumentationHelper.instrumentSubmissionBegin(),this._rootViewModel.submit(this._sequenceNumberManager.getSequenceNumber(),n)},t.prototype.cancelPreviousQuery=function(){this._cancellationManager&&this._cancellationManager.cancelAll()},t.prototype.fetchForQueryChange=function(n){var t,i;if(this._fetchTimer=undefined,!this._lastQuery||!this._currentQuery||!this._lastQuery.equals(this._currentQuery)){for(this.finishPreviousQuery(),this._lastQuery=this._currentQuery,this._sequenceNumberManager.incrementSequenceNumber(),t=this._sequenceNumberManager.getSequenceNumber(),this._instrumentationHelper.instrumentBeginRequest(t,this._currentQuery.queryToFetch,n),this._suggestionsRenderingManager.initiateSequenceNumber(t,this._currentQuery),this._currentQuery.webResponseNeeded&&this.fetch(this._currentQuery,this._webProvider,this._webProvider,t),i=0;i<this._otherProviders.length;++i)this.fetch(this._currentQuery,this._otherProviders[i],null,t);this._rootViewModel.onQueryChanged(this._currentQuery)}},t.prototype.fetch=function(t,r,u,f){var e=this,c=function(){return e._config.d>0?t.equals(e._currentQuery):f==e._sequenceNumberManager.getSequenceNumber()},a=function(n,i,r){return e.onResponseReceived(t,f,n,i,r,c)},l,o,s,h;if(u){this.shouldFetchHistory(t.queryToFetch)&&this._webProvider.addParam(i.Options,n.Service.Options.HistoryEnabled),this._webProvider.addParam(i.CursorPosition,t.cursorPosition.toString()),this._webProvider.addParam(i.ConversationId,this._host.getConversationId()),this._webProvider.addParam(i.ImpressionGuid,this._instrumentationHelper.getImpressionGuid(f)),l=this._host.getCustomUrlParameters();for(o in l)this._webProvider.addParam(o,l[o]);s=this._host.getCustomHeaders();for(h in s)this._webProvider.addHeader(h,s[h]);u.fetch(t,a,f,this._cancellationManager,c)}else r.fetch(t,a,f,this._cancellationManager,c)},t.prototype.onResponseReceived=function(t,i,r,u,f,e){var s=this;if(e()){this._instrumentationHelper.instrumentResponseReceived(i,r,f),r==n.WebResponseType&&this.checkIfResponseHasHistoryItems(t.queryToFetch,u);var o=[],c=!0,h=function(n,t,r){if(e())if(c)o.push({responseType:n,suggestions:t,extraSignals:r});else s.onSuggestionsParsed(i,n,t,r)};this._instrumentationHelper.profileKeystroke(i,function(){return"parseResponse_"+r},function(){return s._suggestionsParser.parse(t,i,r,u,e,h,s._cancellationManager)}),c=!1,o.forEach(function(n){return h(n.responseType,n.suggestions,n.extraSignals)}),o=null}},t.prototype.onSuggestionsParsed=function(n,t,i,r){this._instrumentationHelper.instrumentDataSource(n,t,i),this._suggestionsRenderingManager.queueSuggestions(n,t,i,r)},t.prototype.shouldFetchHistory=function(n){return this.isHistoryEnabled()&&(!this._lastQueryWithoutHistory||n.indexOf(this._lastQueryWithoutHistory)!=0)},t.prototype.checkIfResponseHasHistoryItems=function(n,t){var i=!1;t&&t.Suggestions&&t.Suggestions.length>0&&t.Suggestions[0].Attributes.stype=="HS"&&(i=!0),i||(this._lastQueryWithoutHistory=n)},t.prototype.isHistoryEnabled=function(){return this._config.sid&&this._config.eHS&&sj_cook.get(n.Service.CookieNames.History,n.Service.CrumbNames.History)!="0"},t}(),n.Core=e})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){function nt(n,t){var u,i,r;if(n.length===0)return t.length;if(t.length===0)return n.length;for(u=[],i=0;i<=t.length;i++)u[i]=[i];for(r=0;r<=n.length;r++)u[0][r]=r;for(i=1;i<=t.length;i++)for(r=1;r<=n.length;r++)u[i][r]=t.charAt(i-1)==n.charAt(r-1)?u[i-1][r-1]:Math.min(u[i-1][r-1]+1,Math.min(u[i][r-1]+1,u[i-1][r]+1));return u[t.length][n.length]}function gt(n,t){return n&&(n=n.toLowerCase()),t&&(t=t.toLowerCase()),nt(n,t)}function ti(n,t){if(!n.th)switch(t){case r.LocalMedia:case i.File:case i.PathCompletion:case i.Email:return!0}return!1}function ri(n){switch(n.type){case i.File:case i.Folder:case i.Music:case i.Photo:case i.Video:case i.Email:case i.PathCompletion:return!0;default:return!1}}function ii(n){return n.deviceItem?n.type+"\t"+n.deviceItem.id:n.type+"\t"+n.query}function c(n){return wt.indexOf(n.type)>=0}function tt(n){return pt.indexOf(n.type)>=0}function dt(n){return bt.indexOf(n.type)>=0}function kt(n){return n.kind=="Modern Setting"}function ui(n){return c(n)?n.deviceItem:null}function li(n){return n.handoffType==5?null:n.type==i.Email?null:n.deviceItem}function ci(n){switch(n.type){case i.File:case i.Folder:case i.Photo:case i.Video:case i.Music:return n.deviceItem}return null}function ai(n){return n.handoffType==5&&n.type!=e.Cat1_VCD?n.deviceItem:null}function yi(n){return n.type==i.Email?n.deviceItem:null}function vi(n){return n.type==i.CommandLine?n.deviceItem:null}function ei(n){return n.type==i.PathCompletion?n.deviceItem:null}function fi(n){var i,r;if(!t.prefixesToScope){t.prefixesToScope={};for(i in t.ScopeConfig)r=t.ScopeConfig[i],oi(i,r,n)&&r.prefixes.forEach(function(n){return t.prefixesToScope[n]=parseInt(i)})}}function oi(i,r,u){var f={};return(Object.keys(u.disabledProviderResponses).forEach(function(n){return f[n]=u.disabledProviderResponses[n]}),t.isBingEnabledCache||(f[n.WebResponseType]=!0),r.enabledProviderResponses&&r.enabledProviderResponses.every(function(n){return f[n.responseType]}))?!1:!0}function hi(u,f){var o,s,a,l,h,c;if(fi(f),o=n.parseQuery(u.queryText,u.cursorPosition),o.impressionId=u.impressionId,o.fullPartialQuery=o.queryToFetch,s=o.fullPartialQuery?o.fullPartialQuery.toLowerCase():o.fullPartialQuery,a=n.isResponseTypeEnabled(i.PathCompletion,null,f)?g.test(s):!1,a)o.scope=12;else{if(o.disabledProviderResponses.push(i.PathCompletion),o.scope=0,s)for(l in t.prefixesToScope)if(h=l+":",s.indexOf(h)==0){o.queryToFetch=o.queryToFetch.substr(h.length),o.cursorPosition=Math.max(0,o.cursorPosition-h.length),n.mantainCursorPositionIn(o.queryToFetch,o.cursorPosition,function(t){return n.cleanQuery(t)},function(n,t){o.queryToFetch=n,o.cursorPosition=t}),o.scope=t.prefixesToScope[l];break}o.isProtocol=it.test(s),o.isProtocol&&(o.fixedUrl=n.fixUrlProtocol(o.fullPartialQuery))}return c=t.ScopeConfig[o.scope],o.enabledProviderResponses=o.queryToFetch?c.enabledProviderResponses:[],o.webResponseNeeded=o.queryToFetch&&c.webResponseNeeded,t.isCortanaEnabledCache||o.disabledProviderResponses.push(r.ReactiveAgents,r.AppRelatedReactiveAgents),t.isBingEnabledCache||(o.webResponseNeeded=!1,o.disabledProviderResponses.push(n.WebResponseType,r.OnlineSuggestionsThatMapToApps,e.SpellCorrectedSetting)),o.equals=function(n){return(o.queryToFetch?o.queryToFetch.toLowerCase():o.queryToFetch)==(n.queryToFetch?n.queryToFetch.toLowerCase():n.queryToFetch)&&n.scope==o.scope},o}function si(n){var t=b(n);if(t==null)throw new Error("Suggestion has no group: "+n.type);else return t}function b(n){if(n.isSynthetic)return null;if(c(n))return 0;if(tt(n))return 1;switch(n.type){case i.CommandLine:return 3;case i.PathCompletion:return 12;case i.Photo:return 4;case i.Video:return 5;case i.Music:return 6;case i.PowerBi:return 13;case i.File:return 7;case i.Folder:return 8;case i.Email:return 9;case e.Store:return 10;default:switch(n.handoffType){case 0:case 1:return 11;case 5:case 6:case 4:return 2}throw new Error("Unexpected handoff type: "+n.handoffType);}}function yt(n){switch(n){case 0:return 0;case 7:return 2;case 9:return 7;case 8:return 6;case 6:return 5;case 4:return 3;case 1:return 1;case 5:return 4;default:return 255}}function ht(){o=0}function d(t){var r,i;return o||(r=_ge("root"),o=r.clientHeight,n.safeExecute(function(){var n=_ge("permanentDisambig").firstChild.offsetHeight;a!=n&&(_ge("container").style.height=o-n+"px",a=n)},"getting permanent disambig height")),i=o-t.numberOfTopResultsNonAnswer2lines*ct-t.numberOfTopResultsNonAnswer3lines*vt-t.numberOfTopResultAnswers*at-t.numberOfGroups*lt-t.numberOfSuggestions*p-a}function et(n){for(var r={numberOfTopResultsNonAnswer2lines:n.numberOfTopResultsNonAnswer2lines,numberOfTopResultsNonAnswer3lines:n.numberOfTopResultsNonAnswer3lines,numberOfTopResultAnswers:n.numberOfTopResultAnswers,numberOfGroups:0,numberOfSuggestions:0},u,i=n.numberOfGroups+1;;++i)if(r.numberOfGroups=i-n.numberOfGroups,r.numberOfSuggestions=n.numberOfSuggestions+r.numberOfGroups*t.MinimumNumberOfSuggestionsPerGroup,u=d(r),u<0)return i-1;return 0}function ot(n){var t=d(n);return t>=p}function rt(n,t){return(n+"\t"+t).toLowerCase()}function st(n){return n||(n=new Date),Math.round(n.getTime()/1e3)}function ft(n,t){var u,r,i,e,f;if(!n)return!0;if(!t)return!1;for(u=n.split("."),r=t.split(".");u.length>r.length;)r.push("0");for(i=0;i<u.length;++i){if(e=r[i],f=u[i],e<f)return!1;if(e>f)return!0}return!0}function ut(n,t,i,r,u,f,e,o,s,h,c,l,a,v){return{text:n,secondaryText:t,getIcon:r,icon:u,topResultPrimaryTextClass:null,secondaryTextClass:i,type:f,dataPartnerTag:o,query:e,id:l,click:a,handoffType:c,instItem:s,additionalInfoText:h,answerHtml:null,isSynthetic:v,selected:!1,canAutocomplete:!v,featureStore:undefined}}var ni,f,r,e,i,w,u,it,g;(function(n){n[n.Apps=0]="Apps",n[n.Settings=1]="Settings",n[n.Cortana=2]="Cortana",n[n.Command=3]="Command",n[n.Photos=4]="Photos",n[n.Videos=5]="Videos",n[n.Music=6]="Music",n[n.Documents=7]="Documents",n[n.Folders=8]="Folders",n[n.Emails=9]="Emails",n[n.Store=10]="Store",n[n.Web=11]="Web",n[n.PathCompletion=12]="PathCompletion",n[n.PowerBi=13]="PowerBi"})(t.GroupType||(t.GroupType={})),ni=t.GroupType,f=function(){function n(){}return n.AppsGroupHeader="GA",n.SettingsGroupHeader="GS",n.PhotosGroupHeader="GP",n.VideosGroupHeader="GV",n.MusicGroupHeader="GM",n.DocumentsGroupHeader="GF",n.FoldersGroupHeader="GFD",n.PathCompletionGroupHeader="GPT",n.EmailsGroupHeader="GE",n.StoreGroupHeader="GT",n.WebGroupHeader="GW",n.PersistentSearchMyStuff="PM",n.PersistentSearchTheWeb="PW",n.TopSearchMyStuff="SM",n.TopSearchTheWeb="SW",n.Protocol="PWL",n.Handoffs=function(){var t={};return t[n.AppsGroupHeader]=4,t[n.SettingsGroupHeader]=4,t[n.PhotosGroupHeader]=4,t[n.VideosGroupHeader]=4,t[n.MusicGroupHeader]=4,t[n.DocumentsGroupHeader]=4,t[n.FoldersGroupHeader]=4,t[n.PathCompletionGroupHeader]=4,t[n.EmailsGroupHeader]=4,t[n.StoreGroupHeader]=3,t[n.WebGroupHeader]=0,t[n.PersistentSearchMyStuff]=4,t[n.PersistentSearchTheWeb]=0,t[n.TopSearchMyStuff]=4,t[n.TopSearchTheWeb]=0,t[n.Protocol]=1,t}(),n.Groups=function(){var t={};return t[n.AppsGroupHeader]=104,t[n.SettingsGroupHeader]=104,t[n.PhotosGroupHeader]=104,t[n.VideosGroupHeader]=104,t[n.MusicGroupHeader]=104,t[n.DocumentsGroupHeader]=104,t[n.FoldersGroupHeader]=104,t[n.PathCompletionGroupHeader]=104,t[n.EmailsGroupHeader]=104,t[n.StoreGroupHeader]=104,t[n.WebGroupHeader]=104,t[n.PersistentSearchMyStuff]=101,t[n.PersistentSearchTheWeb]=100,t[n.TopSearchMyStuff]=101,t[n.TopSearchTheWeb]=100,t[n.Protocol]=103,t}(),n}(),t.NonSuggestionQSCodes=f,t.GroupHeaderQSCodes=function(){var n={};return n[0]=f.AppsGroupHeader,n[1]=f.SettingsGroupHeader,n[2]=null,n[3]=null,n[4]=f.PhotosGroupHeader,n[5]=f.VideosGroupHeader,n[6]=f.MusicGroupHeader,n[7]=f.DocumentsGroupHeader,n[8]=f.FoldersGroupHeader,n[9]=f.EmailsGroupHeader,n[10]=f.StoreGroupHeader,n[11]=f.WebGroupHeader,n[12]=f.PathCompletionGroupHeader,n}(),r=function(){function n(){}return n.OnlineSuggestionsThatMapToApps="OSTMA",n.LocalMedia="LM",n.BingContentStore="BCS",n.ReactiveAgents="RAF",n.AppRelatedReactiveAgents="ARAF",n.MRUSignals="MRU",n}(),t.ResponseTypes=r,t.getEditDistance=nt,t.getEditDistanceIgnoreCase=gt,t.isSensitiveResponseType=ti,t.isSensitiveSuggestionType=ri,t.getSuggestionKey=ii,e=function(){function n(){}return n.Store="CS",n.SpellCorrectedApp="QP",n.SpellCorrectedSetting="QS",n.DirectNav="MD",n.Weather="WA",n.LocalCity="LC",n.Cat1_VCD="VCD",n}(),t.OnlineSuggestionTypes=e,i=function(){function n(){}return n.App="PP",n.Setting="ST",n.Music="MU",n.Photo="LI",n.Video="LV",n.File="FL",n.Folder="FD",n.PathCompletion="PT",n.CommandLine="CG",n.Email="LE",n.BCSApp="BQP",n.BCSSetting="BQS",n.Cat1_LaunchApp="ALC",n.PowerBi="PBI",n}(),t.LocalSuggestionTypes=i;var wt=[i.App,i.BCSApp,e.SpellCorrectedApp],pt=[i.Setting,i.BCSSetting,e.SpellCorrectedSetting],bt=[i.Photo,i.Video,i.Music];t.isApp=c,t.isSetting=tt,t.isMedia=dt,t.isModernSetting=kt,t.getAppItem=ui,t.getItemWithFileMetadata=li,t.getFileItem=ci,t.getRafItem=ai,t.getEmailItem=yi,t.getCommandLineItem=vi,t.getPathCompletionItem=ei,w=function(){function n(){}return n.GroupHeader="WNSHED",n.PersistentDisambig="WNSMYS",n}(),t.MyStuffFormCodes=w,function(n){n.GlobalNavButton="&#xE700",n.Wifi="&#xE701",n.Bluetooth="&#xE702",n.QuietHours="&#xE708",n.Airplane="&#xE709",n.ChevronDown="&#xE70D",n.ChevronUp="&#xE70E",n.Edit="&#xE70F",n.Add="&#xE710",n.Cancel="&#xE711",n.More="&#xE712",n.Settings="&#xE713",n.Mail="&#xE715",n.Phone="&#xE717",n.Shop="&#xE719",n.AllApps="&#xE71D",n.Microphone="&#xE720",n.Search="&#xE721",n.Attach="&#xE723",n.Forward="&#xE72A",n.Back="&#xE72B",n.Lock="&#xE72E",n.Blocked="&#xE733",n.FavoriteStar="&#xE734",n.FavoriteStarFill="&#xE735",n.Remove="&#xE738",n.OEM="&#xE74C",n.Delete="&#xE74D",n.Play="&#xE768",n.ChevronLeft="&#xE76B",n.ChevronRight="&#xE76C",n.Emoji2="&#xE76E",n.ContactInfo="&#xE779",n.WindowsLogo="&#xE782",n.Unlock="&#xE785",n.Calendar="&#xE787",n.Financial="&#xE7BB",n.Train="&#xE7C0",n.Flag="&#xE7C1",n.Page="&#xE7C3",n.HalfStarLeft="&#xE7C6",n.HalfStarRight="&#xE7C7",n.Record="&#xE7C8",n.Ferry="&#xE7E3",n.Game="&#xE7FC",n.Car="&#xE804",n.Bus="&#xE806",n.EatDrink="&#xE807",n.Home="&#xE80F",n.IncidentTriangle="&#xE814",n.MapDirections="&#xE816",n.History="&#xE81C",n.Accident="&#xE81F",n.Work="&#xE821",n.Recent="&#xE823",n.MapApp="&#xE828",n.News="&#xE900",n.Help="&#xE897",n.Document="&#xE8A5",n.Folder="&#xE8B7",n.Message="&#xE8BD",n.CalendarDay="&#xE8BF",n.Important="&#xE8C9",n.GotoToday="&#xE8D1",n.Audio="&#xE8D6",n.CellPhone="&#xE8EA",n.Calculator="&#xE8EF",n.Library="&#xE8F1",n.AlarmClock="&#xE919",n.Movies="&#xE8B2",n.FeedbackApp="&#xE939",n.UniversalApp="&#xE8CC",n.ChatBubbles="&#xE8F2",n.Info="&#xE946",n.Health="&#xE95E",n.Dictionary="&#xE82D",n.Sunny="&#xE9BD",n.CloudWeather="&#xE9BE",n.CloudyDay="&#xE9BF",n.PartlyCloudyDay="&#xE9C0",n.PartlyCloudyNight="&#xE9C1",n.ClearNight="&#xE9C2",n.RainShowersDay="&#xE9C3",n.RainDay="&#xE9C4",n.HeavyRainDay="&#xE9C5",n.ThunderstormsDay="&#xE9C6",n.RainSnowDay="&#xE9C7",n.SnowDay="&#xE9C8",n.BlowingSnowDay="&#xE9C9",n.Frigid="&#xE9CA",n.FogDay="&#xE9CB",n.SquallsDay="&#xE9CC",n.DuststormDay="&#xE9CD",n.Precipitation="&#xE9CF",n.StoreLogo="&#xEA96",n.ContactInfoMirrored="&#xEA4A",n.HelpMirrored="&#xEA51",n.DietPlanNotebook="&#xEAC8",n.Running="&#xEADA",n.Trackers="&#xEADF",n.MoreSports="&#xEB22",n.PopularAthletes="&#xEB2B",n.ReminderFill="&#xEB4F",n.Reminder="&#xEB50",n.Ticket="&#xEB54",n.BingLogo="&#xEB6B",n.SkypeLogo="&#xEB6F",n.CortanaNotebook="&#xEB7F",n.ReminderReactivated="&#xEB80",n.Photo2="&#xEB9F",n.Transportation="&#xEBF1",n.MeetingPlanner="&#xEBF2",n.Leisure="&#xEBF3",n.DeliveryTruck="&#xEBF4",n.HomeAutomation="&#xEBF5",n.HeadphoneAudio="&#xEBF6",n.ReminderPerson="&#xEBF7",n.ReminderGroup="&#xEBF8",n.ReminderTime="&#xEBF9",n.ReminderPlace="&#xEBFA",n.ServiceBell="&#xEC1D",n.Commitments="&#xEC4D",n.MusicInCollection="&#xE940",n.MusicInfo="&#xE90B"}(u=t.ClientFontIcons||(t.ClientFontIcons={})),t.ScopeConfig=function(){var t={};return t[0]={prefixes:[],enabledProviderResponses:null,webResponseNeeded:!0,myStuffLocString:"SearchMyStuff",myStuffIcon:u.WindowsLogo,myStuffPivot:""},t[1]={prefixes:["apps","app"],enabledProviderResponses:[{responseType:r.BingContentStore},{responseType:i.App},{responseType:i.BCSApp},{responseType:r.OnlineSuggestionsThatMapToApps}],webResponseNeeded:!0,myStuffLocString:"SearchApps",myStuffIcon:u.AllApps,myStuffPivot:"apps"},t[2]={prefixes:["settings","setting"],enabledProviderResponses:[{responseType:r.BingContentStore},{responseType:i.Setting},{responseType:i.BCSSetting},{responseType:e.SpellCorrectedSetting}],webResponseNeeded:!0,myStuffLocString:"SearchSettings",myStuffIcon:u.Settings,myStuffPivot:"settings"},t[3]={prefixes:["photos","photo","images","image","pictures","picture"],enabledProviderResponses:[{responseType:r.LocalMedia,suggestionIsEnabled:function(n){return n.type==i.Photo}}],webResponseNeeded:!1,myStuffLocString:"SearchPhotos",myStuffIcon:u.Photo2,myStuffPivot:"pictures"},t[4]={prefixes:["videos","video","movies","movie","films","film"],enabledProviderResponses:[{responseType:r.LocalMedia,suggestionIsEnabled:function(n){return n.type==i.Video}}],webResponseNeeded:!1,myStuffLocString:"SearchVideos",myStuffIcon:u.Movies,myStuffPivot:"videos"},t[5]={prefixes:["music","songs","song"],enabledProviderResponses:[{responseType:r.LocalMedia,suggestionIsEnabled:function(n){return n.type==i.Music}}],webResponseNeeded:!1,myStuffLocString:"SearchMusic",myStuffIcon:u.Audio,myStuffPivot:"music"},t[6]={prefixes:["documents","document","docs","doc"],enabledProviderResponses:[{responseType:i.File,suggestionIsEnabled:function(n){return n.type==i.File}}],webResponseNeeded:!1,myStuffLocString:"SearchDocuments",myStuffIcon:u.Document,myStuffPivot:"files"},t[7]={prefixes:["files","file"],enabledProviderResponses:[{responseType:i.File,suggestionIsEnabled:function(n){return n.type==i.File}},{responseType:r.LocalMedia}],webResponseNeeded:!1,myStuffLocString:"SearchFiles",myStuffIcon:u.WindowsLogo,myStuffPivot:""},t[8]={prefixes:["folders","folder"],enabledProviderResponses:[{responseType:i.File,suggestionIsEnabled:function(n){return n.type==i.Folder}}],webResponseNeeded:!1,myStuffLocString:"SearchFolders",myStuffIcon:u.Folder,myStuffPivot:"folders"},t[9]={prefixes:["emails","email"],enabledProviderResponses:[{responseType:i.Email}],webResponseNeeded:!1,myStuffLocString:"SearchEmails",myStuffIcon:u.Mail,myStuffPivot:"emails"},t[10]={prefixes:["mystuff","device"],enabledProviderResponses:[{responseType:r.BingContentStore},{responseType:i.App},{responseType:i.BCSApp},{responseType:r.OnlineSuggestionsThatMapToApps},{responseType:i.Setting},{responseType:i.BCSSetting},{responseType:e.SpellCorrectedSetting},{responseType:r.LocalMedia},{responseType:i.File},{responseType:i.PathCompletion},{responseType:i.Email},{responseType:r.ReactiveAgents},{responseType:n.WebResponseType,suggestionIsEnabled:function(n){return n.handoffType==4||n.handoffType==5}}],webResponseNeeded:!0,myStuffLocString:"SearchMyStuff",myStuffIcon:u.WindowsLogo,myStuffPivot:""},t[11]={prefixes:["web","bing"],enabledProviderResponses:[{responseType:n.WebResponseType,suggestionIsEnabled:function(n){return n.handoffType==6||n.handoffType==0||n.handoffType==1}}],webResponseNeeded:!0,myStuffLocString:null,myStuffIcon:null,myStuffPivot:null},t[12]={prefixes:[],enabledProviderResponses:[{responseType:i.PathCompletion},{responseType:i.CommandLine},],webResponseNeeded:!1,myStuffLocString:"SearchMyStuff",myStuffIcon:u.WindowsLogo,myStuffPivot:""},t}(),t.prefixesToScope,it=/^https?:|^www\.|^\/+/,g=/^[a-z]:\\|^%[^%]+%\\|^\\/,t.isCortanaEnabledCache=CortanaApp.isCortanaEnabled,t.isBingEnabledCache=CortanaApp.isBingEnabled,t.isMyStuffEnabled=!CortanaApp.isMobile,t.regionCache=CortanaApp.region,t.uiLanguageCache=CortanaApp.uiLanguage,t.parseQuery=hi,t.CssClass_Annotation="annotation",t.CssClass_Action="action",t.getGroupType=si,t.tryGetGroupType=b,t.getSectionType=yt,t.MinimumNumberOfSuggestionsPerGroup=3,t.IconSize_SingleLineSuggestion=16,t.IconSize_Suggestion=16,t.IconSize_TopResult=32;var k=8,s=12,y=3,l=1,h=20,v=16,p=h+2*k,lt=v+2*k,ct=h+v+y+l+2*s,vt=h+2*(v+y)+l+2*s,at=80+2*s,a=h+2*s+l,o=0;t.resetPaneSizeCaches=ht,t.getMaxNumberOfGroups=et,t.canFitSuggestion=ot,t.getEngagementSignalKey=rt,t.getUnixTime=st,t.compliesWithMinVersion=ft,t.createSuggestion=ut})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var i;(function(i){var r=function(){function i(){this._countTasks=0,this._numTasks=-1,this._partialChunkFromPreviousBatch="",this._taskCache={},this._version=-1,this._prefixCount=-1}return i.prototype.getVersion=function(){return this._version},i.prototype.getPrefixCount=function(){return this._prefixCount},i.prototype.parse=function(n){return this.parseLines(this.splitToCompleteData(n))},i.prototype.flush=function(){return this._partialChunkFromPreviousBatch?this.parseLines([this._partialChunkFromPreviousBatch]):[]},i.prototype.splitToCompleteData=function(n){if(n.length>0){var t=n.split("\n").map(function(n){return n.trim()});return t.length>0&&(t[0]=this._partialChunkFromPreviousBatch+t[0],this._partialChunkFromPreviousBatch=t.pop()),t}return[]},i.prototype.parseLines=function(t){for(var s=[],r,f,o,h,e,u=0;u<t.length;u++){if(r=n.safeExecute(function(){return JSON.parse(t[u])},"BCSParser JSON.parse",null,t[u]),!r)return null;if(this._numTasks==-1)if(f=i.unpackContentHeader(r),f)this._numTasks=f.taskCount,this._version=f.version,this._prefixCount=f.prefixCount;else return n.reportException(new Error("Malformed BCS header"),"BCSParser unpackContentHeader",t[u]),null;else this._countTasks<this._numTasks?(this._countTasks++,o=i.unpackTask(r),o&&(h=Object.keys(r)[0],this._taskCache[+h]=o)):(e=i.unpackPrefix(r,this._taskCache),e&&s.push(e))}return s},i.unpackTask=function(n){var r=Object.keys(n)[0],t=n[r],i;return t&&t.length==2?i={id:t[0],type:parseInt(t[1])}:null},i.unpackPrefix=function(n,t){var o=Object.keys(n)[0],u=n[o],e={prefix:o,tasks:[],suppressions:[],engagementSignals:{}},r,f;if(u.TSK)for(r=0;r<u.TSK.length;r++)f=u.TSK[r],f in t&&e.tasks.push(t[f]);if(u.SUP)for(r=0;r<u.SUP.length;r++)f=n[o].SUP[r],f in t&&e.suppressions.push(t[f]);return u.LL&&(e.engagementSignals=i.unPackSignal(u.LL)),e},i.unPackSignal=function(n){for(var e={},i,f,u,r=0;r<n.length;r++)i=n[r],i.length==3&&(f=t.getEngagementSignalKey(i[0],String(i[1])),u={SuggestionGroup:i[1],ProbSugClickGivenPref:i[2]},e[f]=u);return e},i.unpackContentHeader=function(n){return n.length==3?{version:parseInt(n[0]),taskCount:parseInt(n[1]),prefixCount:parseInt(n[2])}:null},i}();i.BCSParser=r})(i=t.Bcs||(t.Bcs={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var i;(function(i){var f=65536,u=500,r=function(){function i(n,i,r,u,f,e){var o=this;this._bcsDataReader=i,this._parser=r,this._rowsToSkip=u,this._onLoadingStopped=e,this._progress=u,t.Promise.safeChain("bcsDataReader.tryOpenFileAsync",function(){return i.tryOpenFileAsync(n)},function(n){n?f(function(n){o._storage=n,setTimeout(function(){return o.loadBatch()},0)}):o.close()},function(){return o.close()})}return i.prototype.cancel=function(){this._cancelRequested=!0},i.prototype.loadBatch=function(){var n=this;if(this._cancelRequested){this.close();return}t.Promise.safeChain("bcsDataReader.loadAsync",function(){return n._bcsDataReader.loadAsync(f)},function(t){if(t<=0){n.addToDatabase(n._parser.flush(),function(){return n.close()});return}if(n._cancelRequested){n.close();return}var i=n._bcsDataReader.readString(t);n.addToDatabase(n._parser.parse(i),function(){return n.loadBatch()})},function(){return n.close()})},i.prototype.addToDatabase=function(t,i){var r=this,f;if(!t){this.close();return}this._rowsToSkip&&(t.length>this._rowsToSkip?(t=t.slice(this._rowsToSkip),this._rowsToSkip=0):(this._rowsToSkip-=t.length,t=[])),t.length>0?(f=t.map(function(n){return{key:n.prefix,value:n}}),this._storage.putMultiple(f,function(){if(r._progress+=f.length,r._cancelRequested){r.close();return}setTimeout(function(){return i()},u)},function(t){n.reportException(t,"BCSDataLoader addToDatabase"),r.close()})):i()},i.prototype.close=function(){this._bcsDataReader&&(this._bcsDataReader.close(),this._bcsDataReader=null),this._storage=null,this._onLoadingStopped&&(this._onLoadingStopped(this._progress),this._onLoadingStopped=null)},i}();i.BCSDataLoader=r})(i=t.Bcs||(t.Bcs={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var i;(function(i){var s="BingClientStore",l="BingClientStore2",h="bcs_population_status",f=" ",o=2,e=function(){function n(){}return n.Populated="P",n.NotPopulated="X",n}(),u=function(){function n(){}return n.LoadingFromClient="C",n.LoadingFromServer="S",n.NotLoading="X",n}(),a=e.Populated+u.NotLoading+n.ClientSideStorage.StorageState.QuerySucceeded,r=function(){function n(){}return n.Start="S",n.Pause="P",n.Resume="R",n.Complete="C",n.Active="A",n.Inactive="I",n}(),c=function(){function c(n,t,i,r,u,f,e){var o=this;this._status=null,this._allowPopulation=!1,this._config=n,this._clientSideStorageFactory=t,this._bcsDataReader=i,this._lightweightStorage=r,this._onDataPopulated=u,this._instrumentationHelper=e,f?(f.bindConversationStart(function(){o._allowPopulation=!0,o.checkStatus()}),f.bindDismissed(function(){o._allowPopulation=!1,o._loader&&o._loader.cancel()})):this.checkStatus()}return c.prototype.dbPopulatedForCurrentLanguage=function(){if(!this._status)return!1;var n=this.getActiveDb();return this.isFullyPopulated(n)&&n.language==t.uiLanguageCache.toLowerCase()},c.prototype.getProviderState=function(n){var i=this.dbPopulatedForCurrentLanguage()?e.Populated:e.NotPopulated,r=this._dbBeingPopulated?this._dbBeingPopulated.source==0?u.LoadingFromClient:u.LoadingFromServer:u.NotLoading,t=i+r+n;return t==a?undefined:t},c.prototype.getActiveBCSStorage=function(n,t){this.getStorage(n,t,this.getActiveDb(),!0)},c.prototype.getActiveDb=function(){return this._status.activeDb==this._status.dbA.name?this._status.dbA:this._status.dbB},c.prototype.getInactiveDb=function(){return this._status.activeDb==this._status.dbA.name?this._status.dbB:this._status.dbA},c.prototype.resetDbStatus=function(n){n.version=-1,n.language=null,n.source=null,n.populatedRecords=0,n.totalRecords=-1,n.schemaVersion=n.schemaVersion?n.schemaVersion+1:1},c.prototype.deleteDb=function(t){this.resetDbStatus(t),n.ClientSideStorage.deleteInstance(t.name),t.schemaVersion=0},c.prototype.isFullyPopulated=function(n){return n.totalRecords>0&&n.populatedRecords==n.totalRecords},c.prototype.isPopulationInProgress=function(n){return n.totalRecords>0&&n.populatedRecords>0&&n.populatedRecords<n.totalRecords},c.prototype.checkStatus=function(){var e,c,i,f,u;this._loader||(this._status||(e=this._lightweightStorage()[h],e&&(c=n.safeExecute(function(){return JSON.parse(e)},"parse BCS metadata"),c.schemaVersion==o&&(this._status=c)),!this._status&&this._allowPopulation&&(this._status={dbA:{name:s},dbB:{name:l},activeDb:s,schemaVersion:o},this.resetDbStatus(this._status.dbA),this.resetDbStatus(this._status.dbB),this.saveStatus())),this._allowPopulation)&&(i=this.getActiveDb(),f=t.uiLanguageCache.toLowerCase(),this.isFullyPopulated(i)?(u=this.getInactiveDb(),this.isPopulationInProgress(u)&&u.language==f?(this.instrument(u,r.Resume),this.load(u)):(i.version<this._config.serverBcsVersion||i.language!=f)&&this._config.serverBcsSupportedMarkets[f]&&(this.resetDbStatus(u),u.version=this._config.serverBcsVersion,u.source=1,u.language=f,this.instrument(u,r.Start),this.saveStatus(),this.load(u))):this.isPopulationInProgress(i)&&i.language==f?(this.instrument(i,r.Resume),this.load(i)):f=="en-us"?(this.resetDbStatus(i),i.source=0,i.language=f,this.instrument(i,r.Start),this.saveStatus(),this.load(i)):this._config.serverBcsSupportedMarkets[f]&&(this.resetDbStatus(i),i.version=this._config.serverBcsVersion,i.source=1,i.language=f,this.instrument(i,r.Start),this.saveStatus(),this.load(i)))},c.prototype.saveStatus=function(){this._lightweightStorage()[h]=JSON.stringify(this._status)},c.prototype.getStorage=function(n,t,i,r){var e=this,u=function(n){r&&(e.deleteDb(i),e.saveStatus(),setTimeout(function(){return e.checkStatus()},0)),t(n)};if(r&&!this.isFullyPopulated(i))return t(new Error("Tried to open unpopulated db: "+i.name)),null;this._clientSideStorageFactory(i.name,function(t){r?t.getValue(f,function(r){r&&r.prefix==f&&r.count==i.totalRecords?n(t):(t.close(),u(new Error("Not all records present")))},function(n){t.close(),u(n)}):n(t)},u,i.schemaVersion)},c.prototype.load=function(t){var u=this,s=new i.BCSParser,o,e=function(){o&&o.close(),u._dbBeingPopulated=null,u._loader=null},c=function(i){u.getStorage(function(n){o=n,i(n)},function(i){n.reportException(i,"open "+t.name+" db"),e(),setTimeout(function(){return u.checkStatus()},0)},t,!1)},h=function(i){var c,h;if(t.populatedRecords==i){u.instrument(t,r.Pause),e();return}c={prefix:f,engagementSignals:null,tasks:[],suppressions:[],count:i},t.populatedRecords=i,t.totalRecords=s.getPrefixCount(),t.source==0&&(t.version=s.getVersion()),u.isFullyPopulated(t)?(h=u.dbPopulatedForCurrentLanguage(),u.instrument(t,r.Complete),u._status.activeDb=t.name,u.saveStatus(),o.put(f,c,function(){n.safeExecute(function(){return u._bcsDataReader.cleanupFilesAsync()},"cleanupFilesAsync"),e(),h||u._onDataPopulated(),setTimeout(function(){return u.checkStatus()},0)},function(t){n.reportException(t,"saving BCS populated records count"),e()})):(u.instrument(t,r.Pause),u.saveStatus(),e())};this._dbBeingPopulated=t,this._loader=new i.BCSDataLoader(this.getUrl(t),this._bcsDataReader,s,t.populatedRecords,c,h)},c.prototype.getUrl=function(n){return n.source==0?"http://BuiltInBcs":_w.location.protocol+"//"+_w.location.host+"/bcs/"+n.version+"/"+n.language+".js"},c.prototype.instrument=function(n,t){if(this._instrumentationHelper){var i=(n.source==0?u.LoadingFromClient:u.LoadingFromServer)+(n.version==-1?"":n.version);t+=this._status.activeDb==n.name?r.Active:r.Inactive,this._instrumentationHelper.instrumentBcsPopulationEvent(i,t)}},c}();i.BCSPopulationManager=c})(i=t.Bcs||(t.Bcs={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},AutoSuggest;(function(n){var t;(function(t){var i;(function(i){i.appLimits={maxUpTo3chars:2,maxAfter3chars:4,maxAfter8chars:9},i.settingLimits={maxUpTo3chars:3,maxAfter3chars:5,maxAfter8chars:11};var r=function(r){function u(n,f,e,o){var a=this,v=function(){return _w.localStorage},y=function(){return a.reloadStorage()},s=new i.BCSPopulationManager(n,f,CortanaApp.bcsDataReader,v,y,e,o),c=function(n,t){return s.getActiveBCSStorage(n,t)},l=function(){return s.dbPopulatedForCurrentLanguage()},h=function(n){return s.getProviderState(n)};r.call(this,n,c,u.createBcsResponse,l,h,t.ResponseTypes.BingContentStore,e)}return __extends(u,r),u.getMaxSuggestions=function(n,t,i){return t!=0&&t!=10?i.maxAfter8chars:n.length>8?i.maxAfter8chars:n.length>3?i.maxAfter3chars:i.maxUpTo3chars},u.createBcsResponse=function(t,r){return r?n.safeExecute(function(){for(var c=[],h=[],a=u.getMaxSuggestions(t.queryToFetch,t.scope,i.appLimits),v=u.getMaxSuggestions(t.queryToFetch,t.scope,i.settingLimits),e,o,s,f,l,n=0;n<r.suppressions.length;n++)e=r.suppressions[n],e.type==1?c.push(e.id):h.push(e.id);for(o=[],s=[],n=0;n<r.tasks.length;n++)f=r.tasks[n],f.type==1?o.length<a&&c.indexOf(f.id)<0&&o.push(f.id):s.length<v&&h.indexOf(f.id)<0&&s.push(f.id);return l={appIds:o,settingIds:s,suppressedAppIds:c,suppressedSettingIds:h,engagementSignals:r.engagementSignals}},"createBcsResponse"):{appIds:[],settingIds:[],suppressedAppIds:[],suppressedSettingIds:[],engagementSignals:{}}},u}(n.ClientSideStorage.StorageBasedDataProvider);i.BCSDataProvider=r})(i=t.Bcs||(t.Bcs={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest,BcsResultListAlterer;(function(n){var t;(function(n){n.instanceWithStringKeys})(t=n.ClientSideStorage||(n.ClientSideStorage={}))})(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(n){var t;(function(){})(t=n.Bcs||(n.Bcs={}))})(t=n.Windows||(n.Windows={}))}(AutoSuggest||(AutoSuggest={})),BcsResultListAlterer=function(){function n(t,i){if(this.itemsToAdd=[],this.itemTracker=new CompletionTracker,this.query=t,this.sectionType=i,t){var r={queryToFetch:t,scope:0,disabledProviderResponses:[]};n.BcsDataProvider.fetch(r,sj_dm(this,this.bcsResponseReceived),0,null,function(){return!0})}else this.fetchesComplete=!0}return n.prototype.Create=function(t,i){return new n(t,i)},n.prototype.IsItemSuppressed=function(n){var t=this.bcsResponse;return t&&(t.suppressedAppIds&&t.suppressedAppIds.indexOf(n.id)>=0||t.suppressedSettingIds&&t.suppressedSettingIds.indexOf(n.id)>=0)},n.prototype.AlterResultList=function(n,t){this.resultList=n,this.callback=t,this.fetchesComplete&&t(!0)},n.prototype.GetCurrentResultList=function(){var r=this.itemsToAdd,u=this.resultList.filter(this.filterRemoveSuppressedItems,this),f=[],i,t;for(i in r)t=r[i],n.deviceItemPresent(t,u)||f.push(t);return this.resultList=f.concat(u)},n.deviceItemPresent=function(n,t){for(var i in t)if(t[i].deviceItem.id===n.deviceItem.id)return!0;return!1},n.prototype.bcsResponseReceived=function(n,t){this.bcsResponse=t,console.log("bcsResponseReceived "+JSON.stringify(t));var i=!1,r=SearchAppWrapper.CortanaApp.searchResultsView.deviceSearch;this.sectionType==="settings"?t.settingIds&&t.settingIds.length>0&&(SearchAppWrapper.Utils.wrapApiCallWithTimeout(r,"findSettingsAsync","FSA",null,500,null,t.settingIds).then(sj_dm(this,this.itemFetcher)),i=!0):t.appIds&&t.appIds.length>0&&(SearchAppWrapper.Utils.wrapApiCallWithTimeout(r,"findAppsAsync","FAA",null,500,null,t.appIds).then(sj_dm(this,this.itemFetcher)),i=!0),i||this.completeSuccessfully()},n.prototype.itemFetcher=function(n){var f=this.itemTracker,u,t,i,r;for(u in n)t=n[u],t&&t.displayName&&t.displayName!==""&&(i=ResultListAlterationEngine.WrapDeviceItem(t),f.Start(i),this.itemsToAdd.push(i),r=sj_dm(this,this.processItemWithImage,i),SearchAppWrapper.Utils.wrapApiCallWithTimeout(t,"getImageAsync",null,t.displayName,500,function(){r(null)},32).then(r));f.IsFullyComplete()&&this.completeSuccessfully()},n.prototype.processItemWithImage=function(n,t){n&&typeof n!="string"&&(n=URL.createObjectURL(n)),t.thumbnail=n;var i=this.itemTracker;i.Complete(t),i.IsFullyComplete()&&this.completeSuccessfully()},n.prototype.filterRemoveSuppressedItems=function(n){return!this.IsItemSuppressed(n.deviceItem)},n.prototype.completeSuccessfully=function(){this.fetchesComplete=!0,this.callback&&this.callback(!0)},n.BcsDataProvider=new AutoSuggest.Windows.Bcs.BCSDataProvider({disabledProviderResponses:{}},AutoSuggest.ClientSideStorage.instanceWithStringKeys),n}();var Threshold;(function(n){function t(n,t,i){var u=0,r=0,e=n.deviceItem,f=t.deviceItem;return u+=e.totalLaunches*1e3,r+=f.totalLaunches*1e3,n.deviceItem.displayName.toLowerCase().indexOf(i)==0&&(u+=100),t.deviceItem.displayName.toLowerCase().indexOf(i)==0&&(r+=100),n.deviceItem.displayName.length-u-(t.deviceItem.displayName.length-r)}n.AppLaunchCountSorter=t})(Threshold||(Threshold={}));var AppLaunchCountReRanker=function(){function n(n){this.query=n}return n.prototype.Create=function(t){return new n(t)},n.prototype.IsItemSuppressed=function(){return!1},n.prototype.AlterResultList=function(n,t){this.resultList=n,t(!0)},n.prototype.GetCurrentResultList=function(){return this.resultList.sort(sj_df(Threshold.AppLaunchCountSorter,this.query))},n}();(function(){var n="apps",t="settings",i=new AppLaunchCountReRanker(null);ResultListAlterationFactoryInstance.RegisterAlterer(n,new BcsResultListAlterer(null,n)),ResultListAlterationFactoryInstance.RegisterAlterer(n,i),ResultListAlterationFactoryInstance.RegisterAlterer(t,new BcsResultListAlterer(null,t))})();var PropertiesFormatter;(function(n){function f(n,t,u){var f=undefined,e;return r(t)&&(f=i(n,t),u&&u.label&&(e=MyStuffLocalization.AllStrings[u.label],e&&(f=e.replace("{0}",f)))),f}function i(n,t){var i=t,f;if(r(t))if(n==="System.Size")i=o(t);else if((n==="System.DateModified"||n==="System.DateCreated"||n==="System.DateAccessed")&&t.toLocaleString)i=new Date(t).toLocaleString();else if(n==="System.Media.Duration")i=u(t);else if(n==="lastAccessed"&&t.toLocaleDateString)i=t.toLocaleDateString();else{if(n==="System.Music.Artist"&&typeof t=="object"&&t.length)for(i="",f=0;f<t.length;f++)i+=t[f],f!=t.length-1&&(i+=", ");i&&(i.replace||(i=t.toString()),i=i.replace(e," "))}return i}function r(n){return typeof n!="undefined"&&n!=null}function o(n){var r=n,i=1024,f=["bytes","KB","MB","GB","TB"],t=0,u=0;if(n&&n>0){while(r>=i&&t<f.length-1)r=r/i,t++;u=Math.round(n/Math.pow(i,t))}return u.toLocaleString()+" "+f[t]}function u(n){var i=Math.floor(n/1e7),f=n,r,u;return isNaN(i)||(i=Math.max(i,0),r=i/60,u=Math.floor(r/60),r=Math.floor(r%60),i=Math.floor(i%60),f=t(u,2)+":"+t(r,2)+":"+t(i,2)),f}function t(n,t){var i=n.toString(),u=[],f=t-i.length,r;if(f>0){for(r=0;r<f;r++)u.push(0);u.push(i),i=u.join("")}return i}var e=/\s+/g;n.format=f,n.formatProperty=i})(PropertiesFormatter||(PropertiesFormatter={}));var PromiseProvider;(function(n){function f(n){return Promise.promise?Promise.promise(n):new Promise(n)}function r(n,i){return t(n,function(){return f(i)})}function t(n,t,r){r||(r=i);var u=r.GetPromise(n);return u||(u=t(),r.SetPromise(n,u)),u}var o=function(){function n(n){this.cache={},this.cacheIndex=[],this.maxCacheSize=0,this.maxCacheSize=n}return n.prototype.Add=function(n,t){if(this.cacheIndex.length==this.maxCacheSize){var i=this.cacheIndex[0];this.cacheIndex.splice(0,1),delete this.cache[i]}this.cacheIndex.push(n),this.cache[n]=t},n.prototype.Get=function(n){return this.cache[n]},n}(),e=function(){function n(){this.promiseCache=new o(10)}return n.prototype.GetPromise=function(n){return this.promiseCache.Get(n)},n.prototype.SetPromise=function(n,t){this.promiseCache.Add(n,t)},n}(),u=function(){function n(){}return n.prototype.GetPromise=function(n){return n==this.lastKey?this.lastPromise:null},n.prototype.SetPromise=function(n,t){this.lastKey=n,this.lastPromise=t},n}(),i;n.SingleInstanceLifeTimeManager=u,i=new e,n.CreatePromise=r,n.GetCachedPromise=t})(PromiseProvider||(PromiseProvider={}));var LocalResultsProvider;(function(n){n.LocalApiTimeout=-1,n.GetImageTimeout=1e4;var i=new PromiseProvider.SingleInstanceLifeTimeManager,t=function(){function t(n,t,i,r){this.Key="local",this.State=0,this.Title=MyStuffLocalization.AllStrings.ThisPC,this.InstRegionName="LocalFiles",this.IsIndexed=!0,this.sectionCompleteCallback=null,this.sectionUpdateCallback=null,this.thumbnailTracker=new CompletionTracker,this.isOemEnabled=DCPageConfig.OemEnabled,this.subSectionsCreated=!1,this.SectionKey=n,this.Config=t,this.service=r,this.dataSources=[],this.currentFirstindex=0,this.HoldCompleteForThumbnails=!1}return t.prototype.Initialize=function(n,t,i,r){var s=n.GetQuery(),l=n.GetSortBy(),f=n.GetFirstItemNumber(),e,u,o,c,h;this.dimensions=t,this.ShowResultCount=ResultCountConfig.IsEnabled,n.GetProvider()!==0&&(this.Title=null),e=this.GetMaxItems(t),this.State===0||s!==this.currentQuery||e!==this.maxItemsCount||l!==this.currentSort||this.currentFirstindex!==f?(this.currentQuery=s,this.currentSort=l,this.currentFirstindex=f,this.maxItemsCount=e,this.fetchedItemsCount=0,this.discardItemsCount=0,this.ViewModel={View:"itemlist",Items:[]},this.dataSourceRoot=ThresholdInst.CreateDataSourcesRoot(this.SectionKey,this.Key),this.InstItem=ThresholdInst.CreateInstrumentedItemFromDs(this.dataSourceRoot),u=ThresholdUtilities.setUrlParameter(n.GetUrl(),"source",this.Key),u=ThresholdUtilities.setUrlParameter(u,"form","WNSMSA"),u=ThresholdUtilities.setUrlParameter(u,"scope",this.SectionKey),u=ThresholdUtilities.setUrlParameter(u,"first",null),o=this.service,o&&typeof o.provider!="undefined"&&LocalOnlyProviders&&LocalOnlyProviders.indexOf(this.Config.resultKey)<0&&(u=ThresholdUtilities.setUrlParameter(u,"provider",o.provider.toString())),this.SeeAllInstItem=this.createInstrumentedItem(u,"SeeAll"),this.sectionCompleteCallback=i,this.sectionUpdateCallback=r,this.State=1,f=f-1,c={itemCount:0,itemList:[],subSection:this,deviceItems:[],resultListAlterationEngine:ResultListAlterationFactoryInstance.GetAlterationEngine(s,this.SectionKey)},h=f+e,this.getLocalResults(n,c,f,h)):this.State!==1&&i&&i(this)},t.prototype.GetNewDataSources=function(){var t=null,n=this.dataSources.length;return n&&(t=this.dataSources.splice(0,n)),t},t.prototype.GetLastRenderedItemNumber=function(){return this.currentFirstindex+this.ViewModel.Items.length+this.discardItemsCount-1},t.prototype.GetMaxRenderItemsNumber=function(){return this.maxItemsCount},t.prototype.GetTotalEstimatedResultsCount=function(){if(this.ItemCount>0)return this.ItemCount;var i=this.fetchedItemsCount-this.maxItemsCount,n=this.currentFirstindex+this.fetchedItemsCount;return i>0&&(n+=t.EstimatedResultCount),n},t.prototype.CreateSubSections=function(n,t,i){if(i||(this.subSectionsCreated=!1),this.isOemEnabled){ThresholdUtilities.recordApiTime(this.Key+"_AS");var r=sj_dm(this,this.oemSubSectionCreationFallback,n,t);this.getCachedExecuteSearchAsync(n,r).then(sj_dm(this,this.createSubSectionsCallback,n,t),r)}else this.subSectionsCreated||(t.AddSections(this,[this]),this.subSectionsCreated=!0)},t.prototype.HasResults=function(){return this.ViewModel.Items.length>0},t.prototype.PrerenderingProcess=function(){},t.prototype.CreateResultItem=function(t){var i=t.deviceItem,r=n.createPositions(i,this.Config.prfConfig);return{DisplayName:i.displayName,Id:i.id,Type:this.Config.itemType,Positions:r,Thumbnail:t.thumbnail,ThumbnailBackground:"",InstItem:null,ClickUrl:n.clickUrlPrefix+i.id,DataSource:i,ContextMenu:sj_df(MyStuffContextMenu.Handler,i),ThumbnailDimensions:this.Config.imageSize,TooltipText:ResultPRF.GetTooltip(r)}},t.prototype.GetMaxItems=function(n){return Math.floor(n.height/this.Config.itemHeight)},t.prototype.GetThumbnailColor=function(){return""},t.prototype.getCachedExecuteSearchAsync=function(n,t){var r=n.GetQueryKey();return PromiseProvider.GetCachedPromise(r,sj_df(this.getExecuteSearchAsyncPromise,n,t),i)},t.prototype.getExecuteSearchAsyncPromise=function(t,i){var r=!DCPageConfig.PassCustomTaskFrames&&t.TaskFrame.CustomTaskFrame?"":JSON.stringify(t.TaskFrame);return SearchAppWrapper.Utils.wrapApiCallWithTimeout(SearchAppWrapper.CortanaApp.searchResultsView,"executeSearchAsync","ES","DeviceContent",n.LocalApiTimeout,i,t.GetQuery(),r,null,t.GetSortBy())},t.prototype.oemSubSectionCreationFallback=function(n,t,i){this.isOemEnabled=!1,this.CreateSubSections(t,i,!0)},t.prototype.createSubSectionsCallback=function(t,i,r){var o,f,l,a,v,u,c,e,s,y,h;if(!this.subSectionsCreated){o=[],f=null;try{f=t[this.Config.resultKey]}catch(p){SharedLogHelper.LogWarning("executeSearchAsync","Unhandled exception accessing a member of IMyStuffResultsFolders: "+this.Config.resultKey,p)}if(f){if(l=f.getProviders,a=!0,l&&(v=l.apply(f),v))for(a=!1,u=v.first(),c=i.GetProvider();u.hasCurrent;){if(c===null||c===u.current.key||LocalOnlyProviders&&u.current.key===0&&LocalOnlyProviders.indexOf(this.Config.resultKey)>=0){e=u.current.value;for(s in e)e.hasOwnProperty(s)&&(y=e[s],h=n.CreateSubSection(this.SectionKey,y),h.myStuffResultFolders=t,o.push(h))}u.moveNext()}a&&o.push(this)}r.AddSections(this,o),this.subSectionsCreated=!0}},t.prototype.addToDataSources=function(n){this.dataSources.push(n)},t.prototype.getLocalResults=function(n,t,i,r){var f=t.subSection,u;this.myStuffResultFolders?this.getItemCount(this.myStuffResultFolders,n,f,t,i,r):(ThresholdUtilities.recordApiTime(this.Key+"_AS"),u=sj_dm(this,this.failureCallback),this.getCachedExecuteSearchAsync(n,u).then(sj_dm(this,this.getItemCount,n,f,t,i,r),u))},t.prototype.getItemCount=function(n,i,r,u,f,e){var s=sj_dm(this,this.setItemCount,n,i,r,u,f,e),o=null;o=this.isOemEnabled?SearchAppWrapper.Utils.wrapApiCallWithTimeout(n[this.Config.resultKey],"getItemCountAsync","IC"+r.SectionKey,r.SectionKey,t.OptionalApiTimeout,s,this.service.provider,[]):SearchAppWrapper.Utils.wrapApiCallWithTimeout(n[this.Config.resultKey],"getItemCountAsync","IC"+r.SectionKey,r.SectionKey,t.OptionalApiTimeout,s),o.then(s)},t.prototype.setItemCount=function(n,t,i,r,u,f,e){n?(this.ItemCount=n,this.ItemCount<0&&e++):this.ItemCount=-1,this.fetchLocalContentProcessor(t,i,r,u,f,e)},t.prototype.failureCallback=function(){this.State=3;this.onProcessingComplete(this);SharedLogHelper.LogError("MyStuffApiCallError","Api call failed for subSection "+this.Key)},t.prototype.fetchLocalContentProcessor=function(t,i,r,u,f,e){var o,s=sj_dm(this,this.failureCallback);o=this.isOemEnabled?SearchAppWrapper.Utils.wrapApiCallWithTimeout(t[this.Config.resultKey],"getItemsAsync","FLC"+r.SectionKey,r.SectionKey,n.LocalApiTimeout,s,f,e,this.service.provider,[]):SearchAppWrapper.Utils.wrapApiCallWithTimeout(t[this.Config.resultKey],"getItemsAsync","FLC"+r.SectionKey,r.SectionKey,n.LocalApiTimeout,s,f,e),o.then(sj_dm(this,this.fetchContent,u))},t.prototype.createInstrumentedItem=function(n,t){var i=ThresholdInst.CreateInstrumentedItem(n,t,this.dataSourceRoot);return InstrumentationConfig.ManagedDataSources||this.dataSources.push(i.GetDataSource()),i},t.prototype.fetchContent=function(n,t){var r,i,f,u,e;if(this.IsIndexed=n.state!==1&&n.state!==2,r=n.resultSet,r||(r=n),this.fetchedItemsCount=n?r.length:0,i=Math.min(this.fetchedItemsCount,this.maxItemsCount),i!==0)for(t.itemCount=i,f=0;f<i;f++)u=r[f],u.displayName===""||t.resultListAlterationEngine.IsItemSuppressed(u)||(e=ResultListAlterationEngine.WrapDeviceItem(u),t.deviceItems.push(e));this.processDeviceItems(t),this.discardItemsCount=i-t.deviceItems.length},t.prototype.processFinalResults=function(n,t){var i=t.subSection,u;if(i.State!==2){for(u in n){var e=n[u],r=n[u].deviceItem,f=i.CreateResultItem(e);Instrumentation.CreateLocalDataSourceResult(f,i.dataSourceRoot),t.itemList.push(f),CachedDeviceItems&&!CachedDeviceItems[r.id]&&(CachedDeviceItems[r.id]=r)}if(i.ViewModel.Items=t.itemList,this.updateViewModelAndRequestThumbnails(),!this.HoldCompleteForThumbnails)this.onProcessingComplete(i)}},t.prototype.onProcessingComplete=function(n){var t=n.ViewModel.Items;n.State!==3&&(n.State=t.length>0?6:5),ThresholdUtilities.recordApiTime(n.SectionKey+"_AC"),InstrumentationConfig.ManagedDataSources||ThresholdUtilities.pushOntoArray(n.dataSources,Instrumentation.createLocalDataSources(t,n.SectionKey,n.Key,{indexed:this.IsIndexed,count:this.ItemCount})),this.sectionCompleteCallback?this.sectionCompleteCallback(this):sj_evt.fire("ajax.subSectionComplete",n)},t.prototype.UpdateItemThumbnail=function(n,t){n&&typeof n!="string"&&(n=URL.createObjectURL(n)),t.Thumbnail=n,t.ThumbnailBackground=this.GetThumbnailColor(t.DataSource);var i=this.thumbnailTracker;if(i.Complete(t.DataSource),this.HoldCompleteForThumbnails&&i.IsFullyComplete())this.onProcessingComplete(this);else this.sectionUpdateCallback(this)},t.prototype.UpdateViewModel=function(){},t.prototype.updateViewModelAndRequestThumbnails=function(){if(this.UpdateViewModel(),this.RequestThumbnails(),this.HoldCompleteForThumbnails&&this.thumbnailTracker.IsFullyComplete())this.onProcessingComplete(this);else this.sectionUpdateCallback(this)},t.prototype.RequestThumbnails=function(){for(var f=this.Config.imageSize,u,t,r,i=0;i<this.ViewModel.Items.length;i++)u=this.ViewModel.Items[i],t=u.DataSource,t.getImageAsync&&(this.thumbnailTracker.Start(t),r=sj_dm(this,this.UpdateItemThumbnail,u),SearchAppWrapper.Utils.wrapApiCallWithTimeout(t,"getImageAsync",null,t.displayName,n.GetImageTimeout,r,Math.max(f.height,f.width)).then(r))},t.prototype.processDeviceItems=function(n){var t=n.subSection;n.resultListAlterationEngine.AlterResultList(n.deviceItems,sj_dm(this,t.processFinalResults,n),200)},t.getProperty=function(n,t){var r,i;try{i="getMarkedProperty",n[i]||(i="getProperty"),r=n[i](t)}catch(u){SharedLogHelper.LogWarning("GetPropertyException",t,u)}return r},t.DefaultImageSize={height:32,width:32},t.MediumImageSize={height:60,width:60},t.LargeSquareImageSize={height:96,width:96},t.LargeImageSize={height:96,width:172},t.OptionalApiTimeout=1e3,t.EstimatedResultCount=100,t}();n.LocalSubSection=t})(LocalResultsProvider||(LocalResultsProvider={}));var LocalResultsProvider;(function(n){function u(n,r){var e=null,u;return r||(r=f),u=t[n],u||(u=t[n]=new WeakMap),u.has(r)?e=u.get(r):(e=new i[n](n,r),u.set(r,e)),e}function r(n,t){i[n]=t}var i={},t={},f={id:null,displayName:null,account:null,provider:0};n.CreateSubSection=u,n.RegisterSubSection=r})(LocalResultsProvider||(LocalResultsProvider={}));var ResultPRF;(function(n){function s(t,i,r,u){var h=i.positions,c={positions:h,isItemPlaced:[]},s=o(t,i,r,u),f=new n.ResultPositionController;return f.execute(i.classifiers,i.filters,s,c)}function h(n){for(var e=[],u,f,i,t,r=0;r<n.length;r++)if(u=n[r],!u.isInstrumentationPosition)for(f=u.positionItems,i=0;i<f.length;i++)e.push(f[i].value);return t=e.join("\n"),t=HitHighlightingParser.RemoveHitHighlighting(t)}function r(n,t){var r=n.positions;return r.filter(function(n){return n.key==t.key})[0]}function o(n,t,i,r){for(var y=n.propertyHits?n.propertyHits:[],h=[],c=t.positions,l,o,e,f=0;f<c.length;f++)for(l=c[f],o=l.compatiblePositionItems,e=0;e<o.length;e++){var u=o[e],s=u.key,a=u.view,v=i(n,u);h.push({id:u.id,key:s,value:v,isHit:r(n,s),isSecondary:u.isSecondary,view:a})}return h}var f,e,u,t,i;n.createPositions=s,f=function(){function n(){}return n.prototype.execute=function(n,t,i){for(var o=i.positions,r,s,f,e,u=0;u<o.length;u++)(r=o[u],n.value||r.isInstrumentationPosition)&&(s=r.compatiblePositionItems,s.some(function(t){return n.id===t.id})&&(f=t.filter(function(n){return n.key==r.key}),f.length!=0?f[0].positionItems.push(n):(e={key:r.key,positionItems:[n],isInstrumentationPosition:r.isInstrumentationPosition},t.push(e))))},n}(),n.ResultPositionClassifier=f,e=function(){function n(){}return n.prototype.execute=function(n,t,i){for(var u,o,f,e=0;e<n.length;e++)for(u=n[e],o=r(i,u),u.positionItems=u.positionItems.filter(function(n){return!i.isItemPlaced[n.key]}),u.positionItems.length>o.capacity&&u.positionItems.splice(o.capacity,u.positionItems.length),f=0;f<u.positionItems.length;f++)i.isItemPlaced[u.positionItems[f].key]=!0},n}(),n.ResultPositionFilter=e,u=function(){function n(){}return n.prototype.execute=function(n,t,i){function o(n,t){for(var u=n.compatiblePositionItems,r,i=0;i<u.length;i++)if(r=u[i],r.key==t.key)return r.isSecondary;throw new Error("Unable to find classified property in position config.");}for(var u=0;u<n.length;u++){var f=n[u],s=r(i,f),e=!1;f.positionItems=f.positionItems.filter(function(n){return o(s,n)?!e&&n.isHit?(e=!0,!0):!1:!0})}},n}(),n.ResultPositionHitPropertyFilter=u,t=function(){function n(){}return n.prototype.execute=function(n){for(var f=!1,r,u=0;u<n.length;u++)(r=n[u],r.key=="Primary")&&(r.positionItems=r.positionItems.filter(function(n){return f||n.view!="title"?n.view!="title":(f=!0,!0)}))},n}(),n.ResultPositionTitleFilter=t,i=function(){function n(){}return n.prototype.RunClassification=function(n,t,i){for(var s=i.positions,o=[],u,e,f,r=0;r<t.length;r++){u=t[r],i.isItemPlaced[u.key]=!1;for(e in n)f=n[e],f.execute(u,o,i)}return o},n.prototype.RunFilters=function(n,t,i,r){if(i)for(var u=0;u<i.length;u++)i[u].execute(n,t,r)},n.prototype.execute=function(n,t,i,r){var u=this.RunClassification(n,i,r);return this.RunFilters(u,i,t,r),u},n}(),n.ResultPositionController=i,n.GetTooltip=h})(ResultPRF||(ResultPRF={}));var ResultPRFConfig;(function(n){var i=[new ResultPRF.ResultPositionClassifier],t=[new ResultPRF.ResultPositionTitleFilter,new ResultPRF.ResultPositionHitPropertyFilter,new ResultPRF.ResultPositionFilter],h=[{key:"Primary",capacity:2,compatiblePositionItems:[{id:"primary1",key:"System.ItemNameDisplay",isSecondary:!1,view:"title"},{id:"primary2",key:"displayName",isSecondary:!1,view:"title"},{id:"primary3",key:"System.ItemFolderPathDisplay",isSecondary:!1,view:"ltr"}]},{key:"Secondary",capacity:1,compatiblePositionItems:[{id:"secondary1",key:"System.Search.Contents",isSecondary:!0,label:null,view:"normal"},{id:"secondary2",key:"System.Author",isSecondary:!0,label:"MetadataLabelAuthor",view:"normal"},{id:"secondary3",key:"System.FileOwner",isSecondary:!0,label:"MetadataLabelFileOwner",view:"normal"},{id:"secondary4",key:"System.Keywords",isSecondary:!0,label:"MetadataLabelTags",view:"normal"},{id:"secondary5",key:"System.DateCreated",isSecondary:!0,label:"MetadataLabelDateCreated",view:"ltr"},{id:"secondary6",key:"System.DateAccessed",isSecondary:!0,label:"MetadataLabelDateAccessed",view:"ltr"},{id:"secondary7",key:"System.Title",isSecondary:!0,label:"MetadataLabelTitle",view:"normal"}]},{key:"WideColumn",capacity:1,compatiblePositionItems:[{id:"wideColumn1",key:"System.DateModified",isSecondary:!1,view:"ltr"}]},{key:"PrimaryPropertiesMissing",capacity:2,isInstrumentationPosition:!0,compatiblePositionItems:[{id:"primaryPropertiesMissing1",key:"System.ItemNameDisplay",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing2",key:"System.ItemFolderPathDisplay",isSecondary:!1,view:"none"}]}],o,s,e,r,u,f;n.documentPositionConfig={classifiers:i,filters:t,positions:h},o=[{key:"Primary",capacity:1,compatiblePositionItems:[{id:"primary1",key:"System.ItemNameDisplay",isSecondary:!1,view:"title"},{id:"primary2",key:"displayName",isSecondary:!1,view:"title"}]},{key:"PrimaryPropertiesMissing",capacity:1,isInstrumentationPosition:!0,compatiblePositionItems:[{id:"primaryPropertiesMissing1",key:"System.ItemNameDisplay",isSecondary:!1,view:"none"}]}],n.appPositionConfig={classifiers:i,filters:t,positions:o},s=[{key:"Primary",capacity:1,compatiblePositionItems:[{id:"primary1",key:"System.ItemNameDisplay",isSecondary:!1,view:"title"},{id:"primary2",key:"displayName",isSecondary:!1,view:"title"}]},{key:"PrimaryPropertiesMissing",capacity:1,isInstrumentationPosition:!0,compatiblePositionItems:[{id:"primaryPropertiesMissing1",key:"System.ItemNameDisplay",isSecondary:!1,view:"none"}]}],n.settingPositionConfig={classifiers:i,filters:t,positions:s},e=[{key:"Primary",capacity:4,compatiblePositionItems:[{id:"primary1",key:"System.ItemNameDisplay",isSecondary:!1,view:"title"},{id:"primary2",key:"displayName",isSecondary:!1,view:"title"},{id:"primary3",key:"System.ItemFolderPathDisplay",isSecondary:!1,view:"normal"},{id:"primary4",key:"System.DateModified",isSecondary:!1,view:"ltr"},{id:"primary5",key:"System.Size",isSecondary:!1,view:"normal"}]},{key:"PrimaryPropertiesMissing",capacity:4,isInstrumentationPosition:!0,compatiblePositionItems:[{id:"primaryPropertiesMissing1",key:"System.ItemNameDisplay",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing2",key:"System.ItemFolderPathDisplay",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing3",key:"System.DateModified",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing4",key:"System.Size",isSecondary:!1,view:"none"}]}],n.imagePositionConfig={classifiers:i,filters:t,positions:e},r=[{key:"Primary",capacity:4,compatiblePositionItems:[{id:"primary1",key:"System.Title",isSecondary:!1,view:"title"},{id:"primary2",key:"System.ItemNameDisplay",isSecondary:!1,view:"title"},{id:"primary3",key:"displayName",isSecondary:!1,view:"title"},{id:"primary4",key:"System.Media.Duration",isSecondary:!1,view:"normal"},{id:"primary5",key:"System.DateModified",isSecondary:!1,view:"ltr"},{id:"primary6",key:"System.ItemFolderPathDisplay",isSecondary:!1,view:"normal"}]},{key:"Secondary",capacity:1,compatiblePositionItems:[{id:"secondary1",key:"System.Keywords",isSecondary:!0,label:"MetadataLabelTags",view:"normal"},{id:"secondary2",key:"System.DateCreated",isSecondary:!0,label:"MetadataLabelDateCreated",view:"ltr"},{id:"secondary3",key:"System.DateAccessed",isSecondary:!0,label:"MetadataLabelDateAccessed",view:"ltr"}]},{key:"PrimaryPropertiesMissing",capacity:5,isInstrumentationPosition:!0,compatiblePositionItems:[{id:"primaryPropertiesMissing1",key:"System.Title",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing2",key:"System.ItemNameDisplay",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing3",key:"System.Media.Duration",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing4",key:"System.DateModified",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing5",key:"System.ItemFolderPathDisplay",isSecondary:!1,view:"none"}]},],n.videoPositionConfig={classifiers:i,filters:t,positions:r},u=[{key:"Primary",capacity:3,compatiblePositionItems:[{id:"primary1",key:"System.Title",isSecondary:!1,view:"title"},{id:"primary2",key:"System.ItemNameDisplay",isSecondary:!1,view:"title"},{id:"primary3",key:"displayName",isSecondary:!1,view:"title"},{id:"primary4",key:"System.Music.Artist",isSecondary:!1,view:"normal"},{id:"primary5",key:"System.Music.AlbumTitle",isSecondary:!1,view:"normal"},{id:"primary6",key:"System.ItemFolderPathDisplay",isSecondary:!1,view:"normal"}]},{key:"Secondary",capacity:2,compatiblePositionItems:[{id:"secondary1",key:"System.Media.Duration",isSecondary:!1,view:"normal"},{id:"secondary2",key:"System.Music.Genre",isSecondary:!0,label:"MetadataLabelGenre",view:"normal"}]},{key:"PrimaryPropertiesMissing",capacity:5,isInstrumentationPosition:!0,compatiblePositionItems:[{id:"primaryPropertiesMissing1",key:"System.Title",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing2",key:"System.ItemNameDisplay",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing3",key:"System.Music.Artist",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing4",key:"System.Music.AlbumTitle",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing5",key:"System.Media.Duration",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing6",key:"System.ItemFolderPathDisplay",isSecondary:!1,view:"normal"}]}],n.musicPositionConfig={classifiers:i,filters:t,positions:u},f=[{key:"Primary",capacity:3,compatiblePositionItems:[{id:"primary1",key:"System.Message.SenderName",isSecondary:!1,view:"title"},{id:"primary2",key:"System.Message.SenderAddress",isSecondary:!1,view:"title"},{id:"primary3",key:"System.Subject",isSecondary:!1,view:"normal"},{id:"primary4",key:"System.Communication.AccountName",isSecondary:!1,label:"MetadataLabelEmailAccountName",view:"normal"}]},{key:"WideColumn",capacity:1,compatiblePositionItems:[{id:"wideColumn1",key:"System.Message.DateSent",isSecondary:!1,view:"normal"}]},{key:"PrimaryPropertiesMissing",capacity:4,isInstrumentationPosition:!0,compatiblePositionItems:[{id:"primaryPropertiesMissing1",key:"System.Message.SenderName",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing2",key:"System.Message.SenderAddress",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing3",key:"System.Subject",isSecondary:!1,view:"none"},{id:"primaryPropertiesMissing4",key:"System.Communication.AccountName",isSecondary:!1,view:"none"}]}],n.emailPositionConfig={classifiers:i,filters:t,positions:f},n.onedrivePrfPropertyMapping={"System.ItemNameDisplay":"Name","System.ItemFolderPathDisplay":"Path","System.Size":"Size","System.Keywords":"TagXSchema","System.DateCreated":"DateCreated","System.Title":"OneDriveTitle","System.DateModified":"DateModified","System.Media.DateModified":"DateModified","System.Media.Duration":"Duration","System.Music.Artist":"Artist","System.Music.AlbumTitle":"Album"}})(ResultPRFConfig||(ResultPRFConfig={}));var DenseTileLayout;(function(n){function u(n){var r=n.width,i,t;r>c?(i=156,t=164):r>o?(i=116,t=124):(i=96,t=104);var e=Math.max(h,Math.floor(n.height/t)),f=Math.min(r,s);return{minHeight:i,maxHeight:t,maxRows:e,rowWidth:f}}function r(t){var i=n.GetDimensionParameters(t);return Math.min(i.maxRows*12,30)}function e(n,r){var l={View:n.View,Items:n.Items,Rows:[],Width:0},a=0,f=0,y,o,e,w,p,s,u,c;l.Width=r.rowWidth,l.Rows[a]={Height:r.maxHeight,Images:[]};var h=l.Rows[a],v=0,d=n.Items;for(y=0;y<d.length;y++)if(o=d[y],h.Images.push(o),o.OriginalImageWidth=o.OriginalImageWidth||r.maxHeight,o.OriginalImageHeight=o.OriginalImageHeight||r.maxHeight,w=!1,r.minHeight>o.OriginalImageHeight?(e=o.OriginalImageWidth,w=!0):e=Math.round(r.maxHeight*o.OriginalImageWidth/o.OriginalImageHeight),e<t&&(e=t,w=!0),f+=e,v+=w?e:0,f>=r.rowWidth||y===n.Items.length-1){for(p=Math.min(r.rowWidth,f),s=f===v?r.maxHeight:Math.round(r.maxHeight*(p-v)/(f-v)),s=Math.max(s,r.minHeight),h.Height=s,f=0,c=0;c<h.Images.length;c++)u=h.Images[c],u.OriginalImageHeight>s?(e=Math.round(s*u.OriginalImageWidth/u.OriginalImageHeight),u.ContainerHeight=s):(e=u.OriginalImageWidth,u.ContainerHeight=u.OriginalImageHeight),u.ContainerWidth=e,f+=Math.max(e,t);for(p-=(h.Images.length-1)*i,c=0;c<h.Images.length;c++){var u=h.Images[c],k=u.ContainerWidth,b=Math.max(k,t);u.ContainerWidth=Math.round(p*b/f),u.HorizontalOffset=Math.round((k-u.ContainerWidth)/2),u.VerticalOffset=Math.round((s-u.ContainerHeight)/2),f-=b,p-=u.ContainerWidth}if(a++,a>=r.maxRows||y===n.Items.length-1)break;l.Rows[a]={Height:r.maxHeight,Images:[]},h=l.Rows[a],f=0,v=0}else f+=i,v+=i;return l.View="densetilelayout",l}function f(n,t){return n&&n.naturalHeight&&n.naturalWidth&&(!t.OriginalImageHeight||!t.OriginalImageWidth||Math.abs(n.naturalHeight-n.naturalWidth*t.OriginalImageHeight/t.OriginalImageWidth)/n.naturalHeight>.05)?(t.OriginalImageHeight=n.naturalHeight,t.OriginalImageWidth=n.naturalWidth,!0):!1}n.MaxItemsToFetch=30;var i=4,l=4,t=64,s=976,h=2,c=900,o=460;n.GetDimensionParameters=u,n.GetItemCountToRequest=r,n.ComputeItemLayout=e,n.IsReLayoutRequired=f})(DenseTileLayout||(DenseTileLayout={}));var DenseTileLayoutConfig={IsRelayoutEnabled:!1};var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},LocalResultsProvider;(function(n){var t=function(t){function i(n,r){t.call(this,n,i.Configuration,MyStuffLocalization.getLocalStringForScope(n),r),this.requireRelayout=!1,this.thumbnailApiTimeout=15e3,this.HoldCompleteForThumbnails=!0}return __extends(i,t),i.prototype.Initialize=function(n,i,r,u){t.prototype.Initialize.call(this,n,i,r,u)},i.prototype.CreateResultItem=function(t){var u=this,i=t.deviceItem,f=i,e=n.createPositions(i,ResultPRFConfig.imagePositionConfig),r={DisplayName:i.displayName,Id:i.id,Type:"photo",Positions:e,Thumbnail:t.thumbnail,InstItem:null,ClickUrl:"http://ms-smartsearch/app?"+i.id,DataSource:i,ContextMenu:sj_df(MyStuffContextMenu.Handler,i),OriginalImageHeight:n.LocalSubSection.getProperty(f,"System.Image.VerticalSize"),OriginalImageWidth:n.LocalSubSection.getProperty(f,"System.Image.HorizontalSize"),ContainerWidth:0,ContainerHeight:0,HorizontalOffset:0,VerticalOffset:0,TooltipText:ResultPRF.GetTooltip(e),IsVisible:!0,ThumbnailFetched:!1};return DenseTileLayoutConfig.IsRelayoutEnabled&&(r.OnLoad=function(n){delete r.OnLoad,r.IsVisible=!0,DenseTileLayout.IsReLayoutRequired(n.target,r)&&(u.requireRelayout=!0,u.sectionUpdateCallback&&u.sectionUpdateCallback(u))}),r},i.prototype.PrerenderingProcess=function(){this.requireRelayout&&(this.requireRelayout=!1,this.UpdateViewModel(),this.RequestThumbnails())},i.prototype.GetMaxItems=function(n){return DenseTileLayout.GetItemCountToRequest(n)},i.prototype.UpdateViewModel=function(){this.dimensionParameters||(this.dimensionParameters=DenseTileLayout.GetDimensionParameters(this.dimensions)),this.ViewModel=DenseTileLayout.ComputeItemLayout(this.ViewModel,this.dimensionParameters)},i.prototype.RequestThumbnails=function(){for(var o=this.ViewModel.Rows,i,e,t,n,r=0;r<o.length;r++)for(i=o[r],e=i.Height,t=0;t<i.Images.length;t++)if(n=i.Images[t],!n.ThumbnailFetched){n.ThumbnailFetched=!0;var f=n.DataSource,s=n.ContainerWidth,u=sj_dm(this,this.UpdateItemThumbnail,n);SearchAppWrapper.Utils.wrapApiCallWithTimeout(f,"getImageAsync",null,n.DisplayName,this.thumbnailApiTimeout,u,Math.max(s,e)).then(u),this.thumbnailTracker.Start(f)}},i.Properties=["System.ItemFolderPathDisplay","System.DateModified","System.Size"],i.Configuration={resultKey:"pictures",itemType:"photo",itemHeight:TemplateConfig.LargeItemHeight,imageSize:n.LocalSubSection.LargeImageSize,prfConfig:ResultPRFConfig.imagePositionConfig},i}(n.LocalSubSection);n.ImagesSubSectionDTL=t})(LocalResultsProvider||(LocalResultsProvider={}));var IconConfig={SmallerIcons:!0};var ResultsProviderConfig;(function(n){var t={height:32,width:32},i=IconConfig.SmallerIcons?{height:72,width:72}:{height:96,width:96},r=IconConfig.SmallerIcons?{height:72,width:128}:{height:96,width:172};n.documentsTypeConfig={resultKey:"files",itemType:"doc",itemHeight:TemplateConfig.ItemHeight,imageSize:t,prfConfig:ResultPRFConfig.documentPositionConfig},n.foldersTypeConfig={resultKey:"folders",itemType:"folder",itemHeight:TemplateConfig.ItemHeight,imageSize:t,prfConfig:ResultPRFConfig.documentPositionConfig},n.appsTypeConfig={resultKey:"apps",itemType:"app",itemHeight:TemplateConfig.ItemHeight,imageSize:t,prfConfig:ResultPRFConfig.appPositionConfig},n.settingsTypeConfig={resultKey:"settings",itemType:"setting",itemHeight:TemplateConfig.ItemHeight,imageSize:t,prfConfig:ResultPRFConfig.settingPositionConfig},n.videosTypeConfig={resultKey:"video",itemType:"video",itemHeight:TemplateConfig.LargeItemHeight,imageSize:r,prfConfig:ResultPRFConfig.videoPositionConfig},n.picturesTypeConfig={resultKey:"pictures",itemType:"photo",itemHeight:TemplateConfig.LargeItemHeight,imageSize:i,prfConfig:ResultPRFConfig.imagePositionConfig},n.musicTypeConfig={resultKey:"music",itemType:"music",itemHeight:TemplateConfig.ItemHeight,imageSize:i,prfConfig:ResultPRFConfig.musicPositionConfig},n.emailsTypeConfig={resultKey:"windowsDeviceSearchEmails",itemType:"email",itemHeight:TemplateConfig.ItemHeight,imageSize:t,prfConfig:ResultPRFConfig.emailPositionConfig},n.resultTypeConfigurations={files:n.documentsTypeConfig,videos:n.videosTypeConfig,music:n.musicTypeConfig,pictures:n.picturesTypeConfig,folders:n.foldersTypeConfig},n.sectionFilterFormCode="WNSMD",n.sectionKeyToSectionFilterFormCodeSuffix={all:"L",apps:"A",files:"F",folders:"O",music:"M",pictures:"P",settings:"S",videos:"V"}})(ResultsProviderConfig||(ResultsProviderConfig={}));var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},LocalResultsProvider;(function(n){function c(n,t){var i=t.key,u,r;if(!i)return undefined;if(u=null,n[i])u=n[i];else try{r="getMarkedProperty",n[r]||(r="getProperty"),u=n[r](i)}catch(f){SharedLogHelper.LogWarning("GetPropertyException",i,f)}return PropertiesFormatter.format(i,u,t)}function l(n,t){var r=n.propertyHits?n.propertyHits:[],i=r.indexOf(t);return typeof i=="object"&&typeof i.returnValue!="undefined"?i.returnValue:i>=0}function r(n,t){return ResultPRF.createPositions(n,t,c,l)}var o,e,h,s,f,i,t,u;n.clickUrlPrefix="http://ms-smartsearch/app?",o=function(n){function t(t,i){n.call(this,t,ResultsProviderConfig.documentsTypeConfig,MyStuffLocalization.getLocalStringForScope(t),i)}return __extends(t,n),t}(n.LocalSubSection),n.DocumentsSubSectionScroll=o,e=function(n){function t(t,i){n.call(this,t,ResultsProviderConfig.foldersTypeConfig,MyStuffLocalization.getLocalStringForScope(t),i)}return __extends(t,n),t}(n.LocalSubSection),n.FoldersSubSectionScroll=e,h=function(n){function t(t,i){n.call(this,t,ResultsProviderConfig.appsTypeConfig,MyStuffLocalization.getLocalStringForScope(t),i)}return __extends(t,n),t.prototype.GetThumbnailColor=function(n){var t=n;return t.isImmersive?t.logoBackgroundColor:null},t}(n.LocalSubSection),n.AppsSubSectionScroll=h,s=function(n){function t(t,i){n.call(this,t,ResultsProviderConfig.settingsTypeConfig,MyStuffLocalization.getLocalStringForScope(t),i)}return __extends(t,n),t}(n.LocalSubSection),n.SettingsSubSectionScroll=s,f=function(n){function t(t,i){n.call(this,t,ResultsProviderConfig.videosTypeConfig,MyStuffLocalization.getLocalStringForScope(t),i)}return __extends(t,n),t}(n.LocalSubSection),n.VideosSubSectionScroll=f,i=function(n){function t(t,i){n.call(this,t,ResultsProviderConfig.musicTypeConfig,MyStuffLocalization.getLocalStringForScope(t),i)}return __extends(t,n),t}(n.LocalSubSection),n.MusicSubSectionScroll=i,t=function(n){function t(t,i){n.call(this,t,ResultsProviderConfig.picturesTypeConfig,MyStuffLocalization.getLocalStringForScope(t),i)}return __extends(t,n),t}(n.LocalSubSection),n.ImagesSubSectionScroll=t,u=function(t){function i(n,i){t.call(this,n,ResultsProviderConfig.emailsTypeConfig,MyStuffLocalization.getLocalStringForScope(n),i)}return __extends(i,t),i.prototype.CreateResultItem=function(t){var u=t.deviceItem,i=u,f=r(u,ResultPRFConfig.emailPositionConfig);return{DisplayName:i.displayName,Id:i.id,Type:this.Config.itemType,Positions:f,Thumbnail:"",InstItem:null,ClickUrl:n.clickUrlPrefix+u.id,DataSource:i,Read:i.isRead,ContextMenu:function(){},TooltipText:ResultPRF.GetTooltip(f)}},i}(n.LocalSubSection),n.EmailsSubSectionScroll=u,n.createPositions=r})(LocalResultsProvider||(LocalResultsProvider={}));var OneDriveConfig={EnablePromise:!0};var MyStuffOnlineFederator;(function(n){function u(n){var r=n.GetQuery();r!==t&&(t=r,i(null,n,1,f))}function r(n,t){t===void 0&&(t=20);var r=n.GetFirstItemNumber(),u=["mystuffonline",n.GetQuery(),n.GetSortBy(),r,t].join("|");return PromiseProvider.CreatePromise(u,function(u){return i(u,n,r,t)})}function i(n,t,i,r){var f=sj_gx(),a=_w.location.search,l=t.GetQuery(),v=t.GetSortBy(),u,h,s,c;n==null&&(n=function(n){return sj_evt.fire(o,l,n)}),u=ThresholdUtilities.setUrlParameter(e,"q",ThresholdUtilities.getUrlReadyQuery(l)),u=ThresholdUtilities.setUrlParameter(u,"sortby",v.toString()),u=ThresholdUtilities.setUrlParameter(u,"first",i.toString()),u=ThresholdUtilities.setUrlParameter(u,"count",r.toString()),_G.IG&&(u=ThresholdUtilities.setUrlParameter(u,"IG",_G.IG),h=ThresholdInst.CreateDataSourceItem(null,"MyStuffOnlineInsertionPoint"),u=ThresholdUtilities.setUrlParameter(u,"IID",h.AppNS+"."+h.K)),s=_w.CopyTestParameters,typeof s!="undefined"&&(u=s(a,u)),f.open("POST",u,!0),f.onreadystatechange=function(){if(f.readyState===f.DONE)if(f.status===200){var t=ThresholdUtilities.parseJSON(f.response);t?n(t):(SharedLogHelper.LogError("MyStuffOnlineFederationError","invalid response json: "+(f.response?f.response.length:0)+" characters"),n(null))}else SharedLogHelper.LogError("MyStuffOnlineFederationError","failed response code: "+f.status),n(null)},c=t.TaskFrame.CustomTaskFrame?"":JSON.stringify(t.TaskFrame),f.send(c)}var o="ajax.MyStuffOnlineFederator.completed",e="/mystuffonline",t=null,h=0,s=0,c,l=null,f=6;n.FetchMyStuffOnlineM2=u,n.FetchMyStuffOnline=r})(MyStuffOnlineFederator||(MyStuffOnlineFederator={}));var Recourse=function(){function n(t){var i;this.Items=[],this.dataSources=[];var o=t.GetQuery(),e=t.GetScope(),f=n.typeToDestinationMapping[e],r=typeof f=="undefined"?255:f,u=n.GetOneDriveUrl(o,e);this.LayoutInstItem=this.createInstrumentedItem(null,"RecourseRegion"),InstrumentationConfig.ManagedDataSources&&(this.dataSourcesRoot=ThresholdInst.CreateDataSourcesRoot("Recourse","DeviceContent")),this.Items=[{Title:MyStuffLocalization.AllStrings.FileExplorer,Url:n.localUrl,Destination:r,InstItem:this.createInstrumentedItem(n.localUrl,"fileExplorerLink")},{Title:MyStuffLocalization.AllStrings.OneDrive,Url:u,Destination:r,InstItem:this.createInstrumentedItem(u,"onedriveLink")},{Title:MyStuffLocalization.AllStrings.SettingsTitle,Url:n.localUrl,Destination:0,InstItem:this.createInstrumentedItem(n.localUrl,"settingsLink")}],t.GetIsOemEnabled()&&(i=t.GetProvider(),i!==0&&this.Items.splice(0,0,{Title:SearchAppWrapper.CortanaApp.region!=="CN"?"ࠀ":"B",Url:n.localUrl,Destination:r,InstItem:this.createInstrumentedItem(n.localUrl,"oemLink"),Provider:i,AltText:"              "}))}return n.GetOneDriveUrl=function(t,i){return"https://onedrive.live.com/?qt=search&q="+t+"&ft="+(n.typeToOneDriveFtParameter[i]||"")},n.prototype.GetNewDataSources=function(){var n=null,t=this.dataSources.length;return t&&(n=this.dataSources.splice(0,t)),n=[Instrumentation.createAnswerDataSources("DeviceContent","Recourse",n)]},n.prototype.createInstrumentedItem=function(n,t){var i=ThresholdInst.CreateInstrumentedItem(n,t,this.dataSourcesRoot);return InstrumentationConfig.ManagedDataSources||this.dataSources.push(i.GetDataSource()),i},n.localUrl="http://ms-smartsearch/searchInApp",n.typeToDestinationMapping={files:1,folders:6,apps:1,settings:0,pictures:2,videos:3,music:4,emails:5},n.typeToOneDriveFtParameter={files:"256",pictures:"128",videos:"64",music:"32"},n}();var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},OneDriveFederator,OneDriveResultsProvider;(function(n){function i(n,i,r,u){function e(n){var f=t[i],e;ThresholdUtilities.recordApiTime(f+"_AC"),n&&n.Results&&n.Results[f]?(n.ResponseMetadata&&n.ResponseMetadata[f]&&(o=n.ResponseMetadata[f]),e=n.Results[f],s(e,r)):u([])}function s(n,t){for(var i in n){if(f.length>=t)break;f.push(n[i])}u(f,o)}var f=[],o;if(OneDriveConfig.EnablePromise)MyStuffOnlineFederator.FetchMyStuffOnline(n).then(e);else{function h(r){var f=t[i],u=n.GetQuery();r&&r.length===3&&r[1]===u&&e(r[2])}MyStuffOnlineFederator.FetchMyStuffOnlineM2(n),sj_evt.bind("ajax.MyStuffOnlineFederator.completed",h,1)}}var t={files:"OneDriveDocuments",videos:"OneDriveVideos",music:"OneDriveAudio",pictures:"OneDriveImages",folders:"OneDriveFolders"};n.fetchOnlineContent=i})(OneDriveFederator||(OneDriveFederator={})),function(n){function r(n){if(t[n])return t[n];var r;return r=n==="pictures"&&typeof DenseTileLayout!="undefined"?new u:new i(n),t[n]=r,r}var i=function(){function n(n){this.hasLoggedDataSources=!1,this.dataSources=[],this.thumbnailTracker=new CompletionTracker,this.Key="OneDriveAnswer",this.State=0,this.Title=MyStuffLocalization.AllStrings.OneDrive,this.InstRegionName="OneDriveAnswer",this.ItemCount=-1,this.ShowResultCount=!1,this.IsIndexed=!0,this.type=n,this.oneBasedStartIndex=1}return n.prototype.Initialize=function(n,t,i,r){var s=this,o=n.GetQuery(),e=n.GetSortBy(),f=n.GetFirstItemNumber(),u;this.count=this.GetMaxItems(t),this.ShowResultCount=ResultCountConfig.IsEnabled,i&&(this.sectionCompleteCallback=i),r&&(this.sectionUpdateCallback=r),this.State===0||o!==this.currentQuery||this.ViewModel.Items==null||this.count!==this.ViewModel.Items.length||e!==this.currentSort||this.oneBasedStartIndex!==f?(this.currentQuery=o,this.currentSort=e,this.oneBasedStartIndex=f,this.fetchedItemsCount=0,this.ViewModel={View:"itemlist",Items:[]},this.dataSourceRoot=ThresholdInst.CreateDataSourcesRoot(this.type,this.Key),this.InstItem=ThresholdInst.CreateInstrumentedItemFromDs(this.dataSourceRoot),u=ThresholdUtilities.setUrlParameter(n.GetUrl(),"source",this.Key),u=ThresholdUtilities.setUrlParameter(u,"form","WNSMSA"),u=ThresholdUtilities.setUrlParameter(u,"scope",this.type),u=ThresholdUtilities.setUrlParameter(u,"first",null),this.SeeAllInstItem=this.createInstrumentedItem(u,"SeeAll"),this.dimensions=t,this.State=1,OneDriveFederator.fetchOnlineContent(n,this.type,this.count,function(n,t){s.processResults(n,t)})):i&&i(this)},n.prototype.HasResults=function(){return this.ViewModel.Items.length>0},n.prototype.GetNewDataSources=function(){var t=null,n=this.dataSources.length;return n&&(t=this.dataSources.splice(0,n)),t},n.prototype.GetLastRenderedItemNumber=function(){return this.oneBasedStartIndex+this.ViewModel.Items.length-1},n.prototype.GetMaxRenderItemsNumber=function(){return Math.min(this.count,20)},n.prototype.GetTotalEstimatedResultsCount=function(){return this.ItemCount<0?this.fetchedItemsCount:this.ItemCount},n.prototype.CreateSubSections=function(n,t){t.AddSections(this,[this])},n.prototype.PrerenderingProcess=function(){},n.prototype.CreateResultItem=function(n){var t=n.Content.OneDriveData,f=n.Content.HTML,i=ResultsProviderConfig.resultTypeConfigurations[this.type],r=this.CreatePositions(t);return{Id:"",DisplayName:t.Name,Type:i.itemType,Positions:r,Thumbnail:"",InstItem:null,ClickUrl:t.SeeMore,DataSource:null,ContextMenu:sj_df(MyStuffContextMenu.OneDriveHandler,t),ThumbnailDimensions:i.imageSize,TooltipText:ResultPRF.GetTooltip(r),OneDriveData:n.Content.OneDriveData}},n.prototype.processResults=function(n,t){var u,i,r;if(this.State!==2){for(t!=null&&(this.ItemCount=t.ResultCount),this.fetchedItemsCount=n?n.length:0,u=[],i=0;i<n.length;i++)r=this.CreateResultItem(n[i]),Instrumentation.CreateOneDriveDataSourceResult(r,this.dataSourceRoot),u.push(r);this.ViewModel.Items=u,this.updateViewModelAndRequestThumbnails(),this.thumbnailTracker.IsFullyComplete()&&this.onProcessingComplete()}},n.prototype.UpdateViewModel=function(){},n.prototype.RequestThumbnails=function(){for(var i=this.ViewModel.Items,n,t=0;t<i.length;t++)n=i[t],this.GetThumbnailImage(n,n.OneDriveData.Thumbnail,n.OneDriveData.Extension)},n.prototype.GetThumbnailImage=function(n,t,i){this.thumbnailTracker.Start(n);var u,r=sj_dm(this,this.UpdateItemThumbnail,n);u=n.Type==="photo"||n.Type==="video"?SearchAppWrapper.Utils.wrapApiCallWithTimeout(SearchAppWrapper.CortanaApp,"getImageWithLiveTokenAsync",null,n.DisplayName,15e3,r,t):SearchAppWrapper.Utils.wrapApiCallWithTimeout(SearchAppWrapper.CortanaApp.searchResultsView.deviceSearch,"getIconForTypeAsync",null,n.DisplayName,1e3,r,i,n.ThumbnailDimensions.width),u.then(r)},n.prototype.CreatePositions=function(n){return ResultPRF.createPositions(n,ResultsProviderConfig.resultTypeConfigurations[this.type].prfConfig,this.getPositionItemValue,this.isHitProperty)},n.prototype.GetMaxItems=function(n){return Math.floor(n.height/ResultsProviderConfig.resultTypeConfigurations[this.type].itemHeight)},n.prototype.updateViewModelAndRequestThumbnails=function(){this.UpdateViewModel(),this.RequestThumbnails()},n.prototype.onProcessingComplete=function(){this.State=this.ViewModel.Items.length>0?6:5,InstrumentationConfig.ManagedDataSources||ThresholdUtilities.pushOntoArray(this.dataSources,Instrumentation.createLocalDataSources(this.ViewModel.Items,this.type,this.Key)),this.sectionCompleteCallback?this.sectionCompleteCallback(this):sj_evt.fire("ajax.subSectionComplete",this)},n.prototype.UpdateItemThumbnail=function(n,t){var r=n===null?"":n,i;n&&typeof n!="string"&&(r=URL.createObjectURL(n)),t.Thumbnail===""&&(t.Thumbnail=r),i=this.thumbnailTracker,i.Complete(t),i.IsFullyComplete()?this.onProcessingComplete():this.sectionUpdateCallback&&this.sectionUpdateCallback(this)},n.prototype.getPositionItemValue=function(n,t){var i=ResultPRFConfig.onedrivePrfPropertyMapping[t.key];return i?PropertiesFormatter.format(t.key,n[i],t):undefined},n.prototype.isHitProperty=function(){return!1},n.prototype.createInstrumentedItem=function(n,t){var i=ThresholdInst.CreateInstrumentedItem(n,t,this.dataSourceRoot);return InstrumentationConfig.ManagedDataSources||this.dataSources.push(i.GetDataSource()),i},n}(),u=function(n){function t(){n.call(this,"pictures"),this.defaultPhotoHeight=176,this.defaultPhotoWidth=176,this.requireRelayout=!1}return __extends(t,n),t.prototype.CreateResultItem=function(n){var r=this,i=n.Content.OneDriveData,e=n.Content.HTML,f=ResultsProviderConfig.resultTypeConfigurations[this.type],u=this.CreatePositions(i),t={Id:"",DisplayName:i.Name,Type:f.itemType,Positions:u,Thumbnail:"",InstItem:null,ClickUrl:i.SeeMore,DataSource:null,ContextMenu:sj_df(MyStuffContextMenu.OneDriveHandler,i),ThumbnailDimensions:f.imageSize,OriginalImageHeight:this.getPhotoHeight(i),OriginalImageWidth:this.getPhotoWidth(i),TooltipText:ResultPRF.GetTooltip(u),ContainerWidth:0,ContainerHeight:0,HorizontalOffset:0,VerticalOffset:0,IsVisible:!0,OneDriveData:n.Content.OneDriveData,ThumbnailFetched:!1};return DenseTileLayoutConfig.IsRelayoutEnabled&&(t.IsVisible=!1,t.OnLoad=function(n){delete t.OnLoad,t.IsVisible=!0,DenseTileLayout.IsReLayoutRequired(n.target,t)&&(r.requireRelayout=!0,r.sectionUpdateCallback&&r.sectionUpdateCallback(r))}),t},t.prototype.PrerenderingProcess=function(){this.requireRelayout&&(this.requireRelayout=!1,this.UpdateViewModel(),this.RequestThumbnails())},t.prototype.UpdateViewModel=function(){this.dimensionParameters||(this.dimensionParameters=DenseTileLayout.GetDimensionParameters(this.dimensions)),this.ViewModel=DenseTileLayout.ComputeItemLayout(this.ViewModel,this.dimensionParameters)},t.prototype.RequestThumbnails=function(){for(var e=this.ViewModel.Items,u=this.ViewModel.Rows,r,i,n,f,t=0;t<u.length;t++)for(r=u[t],i=0;i<r.Images.length;i++)n=r.Images[i],n.ThumbnailFetched||(n.ThumbnailFetched=!0,f=this.getThumbnailRequestUrl(n,n.OneDriveData.Thumbnail),this.GetThumbnailImage(n,f,n.OneDriveData.Extension))},t.prototype.GetMaxItems=function(n){return DenseTileLayout.GetItemCountToRequest(n)},t.prototype.getThumbnailRequestUrl=function(n,t){try{var r=n.OriginalImageHeight,i=n.OriginalImageWidth;r&&i&&(r!==this.defaultPhotoHeight||i!==this.defaultPhotoWidth)?(t=t.replace(":Thumbnail",":ConstantHeight192"),t+="#h=192&w="+Math.round(i*192/r)):t=t.replace(":Thumbnail",":Cropped176x176#h=176&w=176")}catch(u){t=t.replace(":Thumbnail",":Cropped176x176#h=176&w=176")}return t},t.prototype.getPhotoHeight=function(n){var t=null;return t=n.OriginalImageHeight,t?parseInt(t):this.defaultPhotoHeight},t.prototype.getPhotoWidth=function(n){var t=null;return t=n.OriginalImageWidth,t?parseInt(t):this.defaultPhotoWidth},t}(i),t={};n.CreateSubSection=r}(OneDriveResultsProvider||(OneDriveResultsProvider={}));var LocalResultsProvider;(function(n){n.RegisterSubSection("files",n.DocumentsSubSectionScroll),n.RegisterSubSection("folders",n.FoldersSubSectionScroll),n.RegisterSubSection("apps",n.AppsSubSectionScroll),n.RegisterSubSection("settings",n.SettingsSubSectionScroll),n.RegisterSubSection("pictures",n.ImagesSubSectionDTL),n.RegisterSubSection("videos",n.VideosSubSectionScroll),n.RegisterSubSection("music",n.MusicSubSectionScroll),n.RegisterSubSection("emails",n.EmailsSubSectionScroll)})(LocalResultsProvider||(LocalResultsProvider={}));
//]]></script><script type="text/javascript" src="/rms/rms%20localizationstrings%20Feedback%20LocStrings/jc/a7e49b91/99ff3224.js"></script><script type="text/javascript">//<![CDATA[
var Feedback;(function(n){var t;(function(n){"use strict";function r(n){for(var i="",r="abcdefghijklmnopqrstuvwxyz0123456789",t=0;t<n;++t)i+=r.charAt(Math.floor(Math.random()*r.length));return i}function i(n){var t="",u=0,r;switch(typeof n){case"object":if(n instanceof Array){for(t+="[",r=0;r<n.length;r++)r>0&&(t+=","),t+=i(n[r]);t+="]"}else if(n instanceof Boolean||n instanceof Date||n instanceof Number||n instanceof String)t=n.toString();else{t+="{";for(r in n)n.hasOwnProperty(r)&&(u>0&&(t+=","),t+='"'+r+'":'+i(n[r]),u++);t+="}"}return t;case"boolean":case"number":return n;case"string":return'"'+n.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\/]/g,"\\/").replace(/[\b]/g,"\\b").replace(/[\f]/g,"\\f").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t")+'"';default:return null}}function f(){try{if(_w.localStorage)return _w.localStorage}catch(n){return undefined}}function u(n){var i="";return i=Date.prototype.toISOString?n.toISOString():n.getUTCFullYear()+"-"+t(n.getUTCMonth()+1)+"-"+t(n.getUTCDate())+"T"+t(n.getUTCHours())+":"+t(n.getUTCMinutes())+":"+t(n.getUTCSeconds())+"."+String((n.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}function t(n){var t=String(n);return t.length===1&&(t="0"+t),t}n.GenerateString=r,n.Stringify=i,n.FetchLocalStorage=f,n.GetISODate=u})(t=n.Core||(n.Core={}))})(Feedback||(Feedback={}));var WindowsFeedback;(function(){"use strict";var t=function(){function n(){this.maxSizeBytes=35e5,this.feedbackUploadUrl="/customerfeedback/queue/full/windows",this.maxSendTries=3,this.requestTimeout=1e4}return n.prototype.Send=function(n,t,i,r){t===void 0&&(t=undefined),i===void 0&&(i=undefined),r===void 0&&(r=undefined);var u=typeof t=="undefined"?Feedback.Core.GenerateString(8):t;return this.SendAttempt(n,u,1,i,r)},n.prototype.SendAttempt=function(n,t,i,r,u){var f=sj_gx();f.open("POST",this.AppendParameter(this.feedbackUploadUrl,"debugid",t),!0),f.timeout=this.requestTimeout,f.setRequestHeader("Content-Type","application/json; charset=UTF-8"),f.onreadystatechange=function(){f.readyState==f.DONE&&(f.status==204?this.OnSendSuccess(n,t,r):i>=this.maxSendTries?this.OnOnlineSendFailure(n,t,r):(typeof _G!="undefined"&&_G.IG?Log2.LogEvent("ClientInst",{error:"Will need to retry sending the payload because not all of them reached the live bing.com servers"},"Feedback.Error",null,null,_G.IG):Log2.LogEvent("ClientInst",{error:"_G.IG was not available when we wanted to log that we will resend the payload"},"Feedback.Error"),this.SendAttempt(n,t,++i,r,u)))}.bind(this),f.send(JSON.stringify(n))},n.prototype.OnSendSuccess=function(n,t,i){i===void 0&&(i=undefined),delete n.html,typeof _G!="undefined"&&_G.IG?Log2.LogEvent("ClientInst",JSON.stringify(n),"Feedback.Online",null,null,_G.IG):Log2.LogEvent("ClientInst",{error:"_G.IG was not available when submitting feedback online"},"Feedback.Error"),typeof i!="undefined"&&i(t)},n.prototype.OnOnlineSendFailure=function(n,t,i){i===void 0&&(i=undefined),delete n.html,typeof _G!="undefined"&&_G.IG?Log2.LogEvent("ClientInst",JSON.stringify(n),"Feedback.Offline",null,null,_G.IG):Log2.LogEvent("ClientInst",{error:"_G.IG was not available when submitting feedback offline"},"Feedback.Error"),typeof i!="undefined"&&i(t)},n.prototype.AppendParameter=function(n,t,i){return n+(n.indexOf("?")>=0?"&":"?")+t+"="+encodeURIComponent(i)},n}();_w.WindowsFeedbackProtocol=new t})(WindowsFeedback||(WindowsFeedback={}));var Microsoft;(function(n){var t;(function(n){"use strict";var t=function(){function n(n){this.base64ImageBlobs=this.GetImageBlobsAsBase64(n)}return n.prototype.Manipulate=function(n){if(n instanceof HTMLImageElement){var t=n;t.src&&this.base64ImageBlobs[t.src]&&(t.src=this.base64ImageBlobs[t.src])}},n.prototype.GetImageBlobsAsBase64=function(n){for(var e=n.querySelectorAll("img[src^='blob:']"),f={},t,i,o,u,r=0;r<e.length;r++)t=e[r],i=document.createElement("canvas"),i.width=t.width,i.height=t.height,o=i.getContext("2d"),o.drawImage(t,0,0),u=i.toDataURL(),f[t.src]=u;return f},n}();n.InlineImagesManipulator=t})(t=n.Search||(n.Search={}))})(Microsoft||(Microsoft={}));var Microsoft;(function(n){var t;(function(n){"use strict";var t=function(){function n(n){this.DocumentFragment=document.createDocumentFragment(),this.DocumentFragment.appendChild(n.cloneNode(!0))}return n.prototype.ManipulateElementsBySelector=function(n,t){var u,r,o,f,i,e;if(t)for(u=this.DocumentFragment.querySelectorAll(n),r=0,o=u.length;r<o;r++)for(f=u[r],i=0;i<t.length;i++)e=t[i],typeof f!="undefined"&&e.Manipulate(f)},n.prototype.DeleteElementsBySelector=function(n){for(var t;t=this.DocumentFragment.querySelector(n);)t&&t.parentNode.removeChild(t)},n.prototype.SerializeToHtml=function(){return this.DocumentFragment.firstChild.outerHTML},n}();n.DOMCopyManipulator=t})(t=n.Search||(n.Search={}))})(Microsoft||(Microsoft={}));var WindowsFeedback;(function(){"use strict";var t=function(){function n(){this.feedbackContainerId="fdbkcontainer",this.feedbackFormId="fdbkfrm",this.privacyLinkId="fdbkpplink",this.learnMoreLinkId="fdbklmlink",this.verbatimId="fdbkverbatim",this.privacyPolicyUrl="http://go.microsoft.com/fwlink/?LinkId=248686",this.learnMoreLinkUrl="http://bing.com/explore/feedback",this.internalCheckUrl="/feedback/internal",this.internalCheckRequestTimeout=2e3,this.localStorage=Feedback.Core.FetchLocalStorage()}return n.prototype.Show=function(){var n=_ge(this.feedbackContainerId);n===null?this.CreateShowForm():this.ResetShowForm()},n.prototype.Hide=function(){var n=_ge(this.feedbackContainerId);n&&(n.style.display="none")},n.prototype.CreateShowForm=function(){var n=sj_ce("form",this.feedbackFormId),a=this.AddText(n,"h1",this.GetLocString("WINDOWS_TITLE_TEXT")),r=sj_ce("div"),c=this.AddLabeledInput(r,"radio",this.GetLocString("DIALOG_COMMENT_TYPE4"),"type",!0,"1"),o=this.AddLabeledInput(r,"radio",this.GetLocString("DIALOG_COMMENT_TYPE5"),"type",!1,"2"),s=this.AddLabeledInput(r,"radio",this.GetLocString("DIALOG_COMMENT_TYPE6"),"type",!1,"3"),e,u,t;n.appendChild(r);var l=this.AddTextArea(n,this.verbatimId,this.GetLocString("DIALOG_COMMENT_TEXT"),!0),h=this.AddLabeledInput(n,"checkbox",this.GetLocString("DIALOG_INCLUDE_SCREENSHOT"),"screenshot",!0,undefined,"fdbkss"),f=sj_ce("div","fdbkinternal","inputwrapper");n.appendChild(f),this.CheckInternal(f);var y=this.AddLink(n,this.privacyLinkId,this.privacyPolicyUrl,this.GetLocString("PRIVACY_STATEMENT_LINK_TEXT")),v=this.AddLink(n,this.learnMoreLinkId,this.learnMoreLinkUrl,this.GetLocString("LEARN_MORE_LINK_TEXT")),i=sj_ce("div");return i.className="fdbkactionbtns",e=this.AddButton(i,"submit",this.GetLocString("DIALOG_SUBMIT_BUTTON_TEXT")),u=this.AddButton(i,"button",this.GetLocString("DIALOG_CANCEL_BUTTON_TEXT")),sj_be(u,"click",this.OnCloseForm.bind(this)),n.appendChild(i),t=sj_ce("div",this.feedbackContainerId),sj_be(t,"submit",this.OnSubmitForm.bind(this)),t.appendChild(n),_d.body.appendChild(t),typeof TestHooksEnabled!="undefined"&&TestHooksEnabled===!0&&(n.setAttribute("data-tag","WindowsFeedback.Form"),a.setAttribute("data-tag","WindowsFeedback.FormTitle"),c.setAttribute("data-tag","WindowsFeedback.SuggestRadioButton"),o.setAttribute("data-tag","WindowsFeedback.LikeRadioButton"),s.setAttribute("data-tag","WindowsFeedback.DislikeRadioButton"),l.setAttribute("data-tag","WindowsFeedback.VerbatimTextArea"),h.setAttribute("data-tag","WindowsFeedback.IncludeScreenshotCheckbox"),y.setAttribute("data-tag","WindowsFeedback.PrivacyLink"),v.setAttribute("data-tag","WindowsFeedback.LearnMoreLink"),e.setAttribute("data-tag","WindowsFeedback.SubmitButton"),u.setAttribute("data-tag","WindowsFeedback.CloseButton"),t.setAttribute("data-tag","WindowsFeedback.FeedbackContainer")),n},n.prototype.CheckInternal=function(n){var t=sj_gx();t.open("HEAD",this.internalCheckUrl,!0),t.timeout=this.internalCheckRequestTimeout,t.onreadystatechange=function(){t.readyState===t.DONE&&t.status===204&&this.AddInternalFormElements(n)}.bind(this),t.send()},n.prototype.AddInternalFormElements=function(n){var c=_ge(this.feedbackFormId),h=_ge(this.verbatimId),r=_ge(this.privacyLinkId),i=_ge(this.learnMoreLinkId),o=c.elements.screenshot,f=this.GetAlias(),e,u;h.classList.add("smallverbatim"),r&&r.parentNode.removeChild(r),i&&i.parentNode.removeChild(i),o&&(e=o.parentNode,u=e.parentNode,u.parentNode.removeChild(u));var l=this.AddText(n,"div",this.GetLocString("DIALOG_MSFT_INTERNAL"),"medium"),s=this.GetLocString("DIALOG_SEND_EMAIL_LABEL").replace("{0}","Bing")+" "+this.GetLocString("DIALOG_ALIAS_LABEL"),a=this.AddLabeledInput(n,"checkbox",s,"sendmail",!0,undefined,null,null,"medium"),t=sj_ce("input");t.type="text",t.name="alias",t.required=!0,f!=null&&(t.value=f),t.placeholder=this.GetLocString("DIALOG_ALIAS_TEXT"),n.appendChild(t)},n.prototype.AddLabeledInput=function(n,t,i,r,u,f,e,o,s,h){var a,c,l;return r===void 0&&(r=undefined),u===void 0&&(u=undefined),f===void 0&&(f=undefined),e===void 0&&(e="inputwrapper"),o===void 0&&(o=null),s===void 0&&(s=null),h===void 0&&(h=null),a=sj_ce("div",null,e),c=sj_ce("input",h,o),c.type=t,u===!0&&(c.checked=!0),typeof r=="string"&&(c.name=r),typeof f=="string"&&(c.value=f),l=sj_ce("label",null,s),l.appendChild(c),l.appendChild(_d.createTextNode(i)),a.appendChild(l),n.appendChild(a),c},n.prototype.AddLink=function(n,t,i,r){var u=sj_ce("a",t);return u.href=i,u.target="_blank",u.innerText=r,n.appendChild(u),u},n.prototype.AddTextArea=function(n,t,i,r){r===void 0&&(r=!0);var u=sj_ce("textarea",t);return u.placeholder=i,u.required=!0,n.appendChild(u),u},n.prototype.AddText=function(n,t,i,r){var u=sj_ce(t);return u.innerText=i,typeof r!="undefined"&&(u.className=r),n.appendChild(u),u},n.prototype.AddButton=function(n,t,i){var r=sj_ce("input");return r.type=t,r.value=i,n.appendChild(r),r},n.prototype.OnSubmitForm=function(n){var t,e,r,i,o,u,f;if(n.preventDefault(),typeof _w.PageDebug=="undefined"&&(_w.PageDebug={}),t={url:location.href,width:_w.innerWidth,height:_w.innerHeight,source:typeof _w.PageDebug.source=="undefined"?"windows":_w.PageDebug.source,send_mail:!0},e=this.GetFormValue("sendmail","checked"),e!==null&&(t.send_mail=e),r=this.GetFormValue("alias","value"),r&&(t.alias=r,this.SetAlias(r)),(!this.FormElementExists("screenshot")||this.GetFormValue("screenshot","checked"))&&(i=new Microsoft.Search.DOMCopyManipulator(_d.documentElement),i.DeleteElementsBySelector("script"),i.DeleteElementsBySelector("#aRmsDefer"),i.ManipulateElementsBySelector("img",[new Microsoft.Search.InlineImagesManipulator(i.DocumentFragment)]),t.html=i.SerializeToHtml()),typeof _G!="undefined"&&(_G.IG&&(t.impression_guid=_G.IG),_G.ST&&(t.timeStamp=Feedback.Core.GetISODate(_G.ST)),_G.V?t.vertical=_G.V:_G.P&&(t.vertical=_G.P)),o=this.DetermineQuery(),o&&(t.query=o),typeof _w.PageDebug!="undefined"){for(u in _w.PageDebug)t[u]=_w.PageDebug[u];_w.PageDebug.canvas!=="undefined"&&(t.vertical=_w.PageDebug.canvas)}f=this.GetTextAreaValue(this.verbatimId),typeof f=="string"&&(t.text=f),t.type=this.DetermineFeedbackType(),_w.WindowsFeedbackProtocol&&WindowsFeedbackProtocol.Send(t),this.Hide(),typeof _G!="undefined"&&_G.IG?Log2.LogEvent("ClientInst",{target:"Submit"},"Feedback.Click",null,null,_G.IG):Log2.LogEvent("ClientInst",{error:"_G.IG was not available when clicking on Submit button"},"Feedback.Error")},n.prototype.DetermineQuery=function(){var n;return typeof ThresholdUtilities!="undefined"&&(n=ThresholdUtilities.getDecodedQuery(),typeof n=="string")?n:typeof CortanaApp!="undefined"?CortanaApp.searchBox.getQueryText().queryText:null},n.prototype.OnCloseForm=function(n){n.preventDefault(),this.Hide(),typeof _G!="undefined"&&_G.IG?Log2.LogEvent("ClientInst",{target:"Cancel"},"Feedback.Click",null,null,_G.IG):Log2.LogEvent("ClientInst",{error:"_G.IG was not available when clicking on Cancel button"},"Feedback.Error")},n.prototype.DetermineFeedbackType=function(){for(var u=_ge(this.feedbackFormId),t=u.elements.type,r=1,n=0,i=t.length;n<i;n++)if(t[n].checked){r=+t[n].value;break}return r},n.prototype.GetTextAreaValue=function(n){var t=_ge(n);return typeof t!="undefined"?t.innerText:null},n.prototype.GetFormValue=function(n,t){var r=_ge(this.feedbackFormId),i=r.elements[n];return i?i[t]:null},n.prototype.FormElementExists=function(n){var i=_ge(this.feedbackFormId),t=i.elements[n];return t?!0:!1},n.prototype.ResetShowForm=function(){var t=_ge(this.feedbackFormId),i=t.elements.type,f=t.elements.screenshot,e=t.elements.sendmail,o=t.elements.alias,r=this.GetAlias(),n,u;for(t.reset(),n=0,u=i.length;n<u;n++)i[n].checked=n==0?!0:!1;f&&(f.checked=!0),e&&(e.checked=!0),o&&r&&(o.value=r),_ge(this.feedbackContainerId).style.display="block",i[0].focus()},n.prototype.GetLocString=function(n){return LocStringManager.getLocString({uiCulture:SearchAppWrapper.CortanaApp.uiLanguage,name:"LocStrings",namespace:"Feedback"})[n]},n.prototype.GetAlias=function(){return localStorage?localStorage.getItem("alias"):null},n.prototype.SetAlias=function(n){localStorage&&localStorage.setItem("alias",n)},n}();_w.WindowsFeedbackForm=new t,typeof sj_evt!="undefined"&&(sj_evt.bind("WindowsFeedback.Form.Show",function(){_w.WindowsFeedbackForm.Show()},1),sj_evt.bind("WindowsFeedback.Form.Hide",function(){_w.WindowsFeedbackForm.Hide()})),typeof CortanaApp!="undefined"&&CortanaApp.addEventListener&&CortanaApp.addEventListener("feedbackformrequested",function(){_w.WindowsFeedbackForm.Show()})})(WindowsFeedback||(WindowsFeedback={}));_w.rms.js({'A:0':0});;
//]]></script><div id="aRmsDefer"><script type="text/rms">//<![CDATA[
var ResultCountConfig={IsEnabled:!0};sj_evt.fire("ajax.startNewQuery");
//]]></script></div><script type="text/javascript">//<![CDATA[
_G.HT=new Date;
//]]></script></body></html>