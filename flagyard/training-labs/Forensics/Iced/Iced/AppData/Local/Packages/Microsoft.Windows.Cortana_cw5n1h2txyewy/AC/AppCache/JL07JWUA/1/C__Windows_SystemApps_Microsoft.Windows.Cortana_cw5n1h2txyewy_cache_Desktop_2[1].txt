<!DOCTYPE html><html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:Web="http://schemas.live.com/Web/" manifest="/manifest/threshold.appcache"><script type="text/javascript">//<![CDATA[
si_ST=new Date;
//]]></script><head><!--pc--><title>Bing</title><meta content="text/html; charset=utf-8" http-equiv="content-type"/><meta name="viewport" content="width=device-width, user-scalable=no"/><script type="text/javascript">//<![CDATA[
_G={ST:(si_ST?si_ST:new Date),Mkt:"en-US",RTL:false,IG:"77ec74c6bf124b8b86dde93b1d36eaab",EventID:"942b4e1bf5174575b24355f2d9dc13b7",V:"web",P:"AUTOSUGGEST",DA:"Co3b",gpUrl:"\/fd\/ls\/GLinkPing.aspx?"};_G.lsUrl="/fd/ls/l?IG="+_G.IG;curUrl="https:\/\/www.bing.com\/AS\/API\/WindowsCortanaPane\/V2\/Init";_G.XLS="\/threshold\/xls.aspx";;window.onerror||(window.onerror=function(n,t,i,r,u){var f;typeof n=="object"&&n.srcElement&&n.srcElement.src?(f={ScriptSrc:n.srcElement.src},sj_evt&&sj_evt.fire("ErrorInstrumentation",JSON.stringify(f))):typeof SharedLogHelper!="undefined"?SharedLogHelper.LogError(t,n.toString(),u,i,r):window.addEventListener("load",function(){return SharedLogHelper.LogError(t,n.toString(),u,i,r)})});_G.ServerIG = "77ec74c6bf124b8b86dde93b1d36eaab";;
//]]></script><style type="text/css">html,body{-ms-content-zooming:none}</style><link rel="stylesheet" href="/rms/BlueBrand/ortl,cc/1bea0f76/854b6456.css?bu=rms+answers+BrandBundle_Mobile+thbrand%24CombinedAsset_th_b%2cthbrand%24Colors_th_b%2cthbrand%24Type_th_b%2cthbrand%24Grid_th_b" type="text/css"/><link rel="stylesheet" href="/rms/BlueHeader/ortl,cc/c57d0e76/50afa249.css?bu=rms+answers+BrandBundle_Mobile+thbrand%24Header_CombinedAsset%2cthbrand%24Header_Colors_th_b%2cthbrand%24Header_Type%2cthbrand%24Header_Grid_th_b" type="text/css"/><style type="text/css">.b_accentColor,.b_accentColor strong,strong.b_accentColor,strong .b_accentColor,.qcard a,#sb_feedback,.b_anno,.appifyCaptionAccent,#b_results a.b_accentColor,#b_results a.b_accentColor:visited{color:#f90;}.b_accentColorStroke{stroke:#f90;}.b_accentColorFill{fill:#f90;}.b_accentColorBackground{background-color:#f90;}input[type="text"]:focus{border-color:#f90;}select:active{background-color:#f90;}select{color:#f90;}select::-ms-expand{color:#f90;}.b_moreLink,.b_moreLink:visited,#b_results .b_moreLink,#b_results .b_morelink:visited{color:#f90;}.sml,.sml a,.sml a:visited{color:#f90;}.b_corActList,.b_corActList a,.b_corActList a:visited{color:#f90;}#fdbkcontainer{background:#fff;bottom:0;position:fixed;color:#000;z-index:9;font-size:15px;border:1px solid #ccc}#fdbkcontainer .fdbkactionbtns{position:absolute}@media(max-width:340px){#fdbkcontainer{width:100%;height:100%}}@media(max-width:340px)and (max-height:599px){#fdbkcontainer .fdbkactionbtns{bottom:12px}}@media(max-width:340px)and (min-height:600px){body[dir] #fdbkcontainer .fdbkactionbtns{padding:54px 0 0 0}}@media(min-width:341px){#fdbkcontainer{width:320px;height:488px}body[dir='ltr'] #fdbkcontainer{right:0}body[dir='rtl'] #fdbkcontainer{left:0}body[dir='rtl'] #fdbkcontainer{left:0;right:auto}#fdbkcontainer .fdbkactionbtns{bottom:12px}}#fdbkcontainer h1{font-weight:normal;font-size:20px;line-height:24px}body[dir] #fdbkcontainer h1{margin-bottom:12px}#fdbkcontainer a{color:#0078d7;text-decoration:none;font-size:15px;display:inline-block}body[dir] #fdbkcontainer #fdbkfrm{margin:12px}#fdbkcontainer label{color:#000;background:none;background-position:inherit;height:inherit;position:static;display:inline-block;cursor:pointer}body[dir] #fdbkcontainer label{margin:0}body[dir='ltr'] #fdbkcontainer label{padding:0 0 3px 0}body[dir='rtl'] #fdbkcontainer label{padding:0 0 3px 0}#fdbkcontainer input{vertical-align:top}body[dir] #fdbkcontainer input{margin-top:4px}body[dir='ltr'] #fdbkcontainer input{margin-left:0;margin-right:7px}body[dir='rtl'] #fdbkcontainer input{margin-right:0;margin-left:7px}body[dir] #fdbkcontainer .inputwrapper{margin-bottom:12px}#fdbkcontainer #fdbkverbatim{width:100%;box-sizing:border-box;overflow:auto;height:83px;font-size:15px;font-family:'Segoe UI';width:296px;height:62px;color:#999;line-height:16px}body[dir='ltr'] #fdbkcontainer #fdbkverbatim{padding:3px 3px 3px 10px}body[dir='rtl'] #fdbkcontainer #fdbkverbatim{padding:3px 10px 3px 3px}#fdbkcontainer input{font-size:15px}#fdbkcontainer input[type="submit"],#fdbkcontainer input[type="button"]{width:142px;height:35px}#fdbkcontainer input[type="submit"]{background-color:#0078d7;color:#fff;cursor:pointer;border:1px solid #0078d7}body[dir='ltr'] #fdbkcontainer input[type="submit"]{margin-right:12px}body[dir='rtl'] #fdbkcontainer input[type="submit"]{margin-left:12px}#fdbkcontainer input[type="button"]{background-color:#ccc;border:1px solid #ccc;cursor:pointer}#fdbkcontainer #fdbkinternal .small{font-size:9px}#fdbkcontainer #fdbkinternal .medium{font-size:12px}#fdbkcontainer #fdbkinternal a{font-size:15px}body[dir] #fdbkcontainer #fdbkinternal label{margin-top:5px}#fdbkcontainer #fdbkinternal input[type="text"]{width:275px;color:#000;height:25px}body[dir] #fdbkcontainer #fdbkinternal input[type="text"]{margin:0;margin-top:5px}body[dir='ltr'] #fdbkcontainer #fdbkinternal input[type="text"]{padding-left:10px}body[dir='rtl'] #fdbkcontainer #fdbkinternal input[type="text"]{padding-right:10px}#fdbkcontainer #fdbkverbatim.smallverbatim{height:62px}body[dir] #fdbkcontainer .fdbkss{margin-top:5px;margin-bottom:17px}a#fdbklmlink{float:left;clear:left;color:#0078d7}body[dir] a#fdbklmlink{margin-top:7px}body[dir='rtl'] a#fdbklmlink{float:right;clear:right}a#fdbkpplink{float:left;clear:left;color:#0078d7}body[dir='rtl'] a#fdbkpplink{float:right;clear:right}body[dir] div#fdbkinternal{margin-top:5px}*{box-sizing:border-box}html{-ms-user-select:none;cursor:default;overflow-y:auto}html,body{height:100%}html,body,table,td{line-height:normal}body[dir] html,body[dir],body[dir] table,body[dir] td{margin:0;padding:0}table{border-collapse:collapse;border:0}body{font-family:"Segoe UI",Arial,Helvetica,Sans-Serif;font-size:15px;color:#000;background-color:#fff;overflow-y:hidden;overflow:hidden}a{color:#000}#root{height:100%;position:relative}body>#root>.scr{height:calc(100%- 44px);overflow-y:auto;overflow-x:hidden}.suggestions{vertical-align:top}.divider{border:0;border-top:1px solid #e6e6e6}body[dir] .divider{margin:0 0 7px 0}.permanentSingle,.permanentDisambig{width:100%;position:absolute;bottom:0;border-top:1px solid #e6e6e6;background-color:#fff;display:table}body[dir] .permanentSingle .suggestion,body[dir] .permanentDisambig .suggestion{padding:12px}.permanentDisambig .suggestion{display:table-cell;width:50%}body[dir='ltr'] .permanentDisambig .suggestion:first-child{border-right:1px solid #e6e6e6}body[dir='rtl'] .permanentDisambig .suggestion:first-child{border-left:1pxsolid}.group:first-of-type .divider{border:0}body[dir] .group:first-of-type .divider{margin-bottom:0}.groupHeader{font-weight:600}.suggestion,.groupHeader{display:block;position:relative}body[dir] .suggestion,body[dir] .groupHeader{padding:8px 12px}#topResults .suggestion{border-bottom:1px solid #e6e6e6;min-height:60px}body[dir] #topResults .suggestion{padding:12px}#topResults .suggestion.sa_hv{border-bottom:1px solid #fff}body[dir='ltr'] .details{padding-left:28px}body[dir='rtl'] .details{padding-right:28px}body[dir='ltr'] #topResults .details{padding-left:44px}body[dir='rtl'] #topResults .details{padding-right:44px}.action{color:#0078d7}.highlighted{font-weight:600}.suggestion:hover,.selectable:hover{background:#e6e6e6}.groupHeader.selectable:hover{background:#fff;text-decoration:underline}.sa_hv,.sa_hv:hover{background:rgba(0,120,215,.3)}.iconContainer{position:absolute}body[dir] .iconContainer{margin-top:2px}.icon{width:16px;height:16px;font-size:16px;font-family:"Cortana MDL2 Assets";display:table-cell;vertical-align:middle}.bingFontIcon{font-family:"Bing MDL2 Assets"}.iconContent{vertical-align:top}#topResults .icon{width:32px;height:32px;font-size:32px}.icon img{max-width:16px;max-height:16px;width:auto;height:auto;display:block}body[dir] .icon img{margin:0 auto}.icon svg{width:16px;height:16px}#topResults .icon img{max-width:32px;max-height:32px}#topResults .icon svg{width:32px;height:32px}.primaryText{max-height:40px;line-height:20px;overflow:hidden}.primaryText.cortana{max-height:48px;line-height:24px;font-size:20px}.secondaryText,.sourceInfoText,.groupHeader{font-size:13px;line-height:16px}.secondaryText,.groupHeader{line-height:16px}.annotation{color:rgba(0,0,0,.6)}.sourceInfoText{line-height:20px}.secondaryText{min-height:16px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}body[dir] #topResults .primaryText,body[dir] #topResults .secondaryText{margin-bottom:3px}body[dir] #topResults .secondaryText:last-child{margin-bottom:0}.b_focusLabel{font-size:12px;line-height:14px}.b_secondaryFocus{font-size:15px;line-height:20px}body[dir] .b_secondaryFocus{padding-bottom:0}.answer{height:80px;overflow:hidden}@media screen and (-ms-high-contrast:active){.suggestion:hover,.selectable:hover,.sa_hv{background-color:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast:black-on-white){body{background-color:Menu;color:MenuText}.permanentSingle,.permanentDisambig{background-color:Menu}}.contextMenu{z-index:6;position:absolute;display:block;background-color:#fff;border:2px solid #000;font-weight:600}body[dir] .contextMenu{padding:5px 0}body[dir] .contextMenuItem{padding:12px 20px}.contextMenu .divider{border-color:#000}body[dir] .contextMenu .divider{margin:8px 0}.contextMenuItem:active{background:#000;color:#fff}.contextMenuItem:hover{background:#e6e6e6}@media screen and (-ms-high-contrast:active){.contextMenuItem:hover{background-color:Highlight;color:HighlightText}}z{a:1}</style><link rel="stylesheet" href="/rms/rms%20answers%20AutoSuggest%20Partners$CortanaMDL2/ortl,cc/feab239f/d1b50250.css" type="text/css"/><link rel="stylesheet" href="/rms/rms%20answers%20AutoSuggest%20Partners$BingMDL2/ortl,cc/515fdb1f/73403ec2.css" type="text/css"/><style type="text/css">.b_select{background-color:#ffe0b3;border-color:#f90;}</style><script type="text/javascript">//<![CDATA[
var amd,define,require;(function(n){function e(n,i,u){t[n]||(t[n]={dependencies:i,callback:u},r(n))}function r(n){if(n){if(n)return u(n)}else{if(!f){for(var r in t)u(r);f=!0}return i}}function u(n){var o,f;if(i[n])return i[n];if(t.hasOwnProperty(n)){var c=t[n],e=c.dependencies,a=c.callback,l=r,s={},h=[l,s];if(e.length<2)throw"invalid usage";else if(e.length>2)for(o=e.slice(2,e.length),f=0;f<o.length;f++)h.push(u(o[f]));return a.apply(this,h),i[n]=s,s}}var t={},i={},f=!1;n.define=e,n.require=r})(amd||(amd={})),define=amd.define,require=amd.require;var _w=window,_d=document,sb_ie=window.ActiveXObject!==undefined,sb_i6=sb_ie&&!_w.XMLHttpRequest,_ge=function(n){return _d.getElementById(n)},sb_st=function(n,t){return setTimeout(n,t)},sb_ct=function(n){clearTimeout(n)},sb_gt=function(){return+new Date},sj_gx,AjaxWrapper;_w.sj_ce=function(n){return _d.createElement(n)},_w.sk_merge||(_w.sk_merge=function(n){_d.cookie=n}),function(){function t(n,t,i){n.readyState==n.OPENED&&t.apply(n,i)}function h(n,u){return function(){var f=arguments;r(n)||n.readyState!=n.OPENED?(Object.defineProperties(n,{readyState:{get:function(){return 4}},status:{get:function(){return 200}},responseText:{get:function(){return""}},responseBody:{get:function(){return""}}}),n.onreadystatechange&&n.onreadystatechange.apply(n,null)):i(n.url)?ThresholdUtilities.getCortanaHeaders(function(i){if(i)for(var r in i)i.hasOwnProperty(r)&&r.substring(0,2)==="X-"&&n.setRequestHeader(r,i[r]);t(n,u,f)}):t(n,u,f)}}function c(n,t){return function(){n.url=arguments[1],t.apply(n,arguments),e(n)}}function l(n,i){return function(){t(n,i,arguments)}}function i(n){var e=!0,t,i,r;if(u.href=n,t=u.hostname,t&&t.indexOf(".")>0){i=!1;for(r in f)if(t.indexOf(f[r])>0){i=!0;break}i||(e=!1)}return e}function s(n){return function(){return r(n)}}function r(n){return SearchAppWrapper&&SearchAppWrapper.CortanaApp&&!SearchAppWrapper.CortanaApp.isBingEnabled&&i(n.url)}function o(){var n=new XMLHttpRequest;return n.send=h(n,n.send),n.open=c(n,n.open),n.setRequestHeader=l(n,n.setRequestHeader),n.isRequestBlocked=s(n),n}function e(n){typeof _CachedFlights!="undefined"&&_CachedFlights.length&&(n.setRequestHeader("X-MSEdge-ExternalExpType","JointCoord"),n.setRequestHeader("X-MSEdge-ExternalExp",_CachedFlights.join(",")))}var f=[".bing.com",".staging-bing-int.com",".working-bing-int.com",".bing-int.com",".bing-exp.com"],u=document.createElement("a");sj_gx=function(){return o()}}(AjaxWrapper||(AjaxWrapper={}));function lb(){_w.si_sendCReq&&sb_st(_w.si_sendCReq,800),_w.lbc&&_w.lbc()};
//]]></script><script type="text/javascript" src="/rms/BingCore.Bundle/jc/4e3d6870/07801425.js?bu=rms+answers+Shared+BingCore%24shared%2cBingCore%24env.override%2cBingCore%24event.custom.fix%2cBingCore%24event.native%2cBingCore%24dom%2cBingCore%24cookies_parser%2cBingCore%24XHRPrefetch%24rmsajax_xhrprefetch%2cBingCore%24ClientInstV2%24InstrumentationConfigThrdatasources%2cBingCore%24ClientInstV2%24LogUploadCapFeatureDisabled%2cBingCore%24ClientInstV2%24ClientInstConfigSeparateQFQueue%2cBingCore%24ClientInstV2%24clientinst_xls%2cEmpty%2cBingCore%24ClientInstV2%24LogHelper%2cBingCore%24ClientInstV2%24VisibilityChangeEventHelper%2cBingCore%24Animation%2cBingCore%24fadeAnimation%2cBingCore%24framework%2cBingCore%24ShowWebView%2cBingCore%24CoreUtilities"></script><script type="text/javascript">//<![CDATA[
_w.si_ct=function(n,t,i){var u="getAttribute",f,r,o;try{for(;n!==document.body;n=n.parentNode){if(f=n.tagName=="A"&&n[u]("h")||n[u]("_ct")||n[u]("data-h"),f){r=n[u]("_ctf"),r&&_w[r]||(r="si_T"),_w[r]&&_w[r]("&"+f,n,i);break}if(t)break}}catch(e){}return!0},function(){_w._G&&(_G.si_ct_e="click"),sj_be(document,"click",function(n){si_ct(sb_ie?_w.event.srcElement:n.target,!1,_w.event||n)},!1)}();var wlc_d = 1500,wlc_t = 63570477187;;_w.si_PP=function(n,t,i){var f,c,r,h,s,a,v,u,y,o,e,l;if(!_G.PPS){for(c=["FC","BC","H","BP",null];f=c.shift();)c.push('"'+f+'":'+(_G[f+"T"]?_G[f+"T"]-_G.ST:-1));if(r=i||_w.performance&&_w.performance.timing,h=null,r&&(s=["unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd","msFirstPaint","responseEnd",""],a=r.navigationStart,a>=0)){for(y=o=v=0;f=s.shift();v++)u=r[f],u>0&&(y|=1<<v,u-=a,s.push(u===o?"":(u-o).toString(16)),o=u);e="navigation",h=',"w3c":"'+y.toString(16)+","+s.join()+'","nav":'+(e in r?r[e]:performance[e].type)}l='{"pp":{"S":"'+(t||"L")+'",'+c.join(",")+',"CT":'+(n-_G.ST)+',"IL":'+_d.images.length+"}"+(_G.C1?","+_G.C1:"")+(h!==null?h:"")+"}",_w.Log2?Log2.LogEvent("CPT",JSON.parse(l)):(_G.PPImg=new Image,_G.PPImg.src=_G.lsUrl+"&Type=Event.CPT&DATA="+l+(_G.P?"&P="+_G.P:"")),_G.PPS=1,sb_st(function(){sj_evt.fire("onPP"),sj_evt.fire(_w.p1)},1)}},_w.onbeforeunload=function(){si_PP(new Date,"A")};(function(n){_w.si_PP=function(t,i){var u=_w.performance&&_w.performance.timing,r;u&&(r='"NS":"'+u.navigationStart+'"',_G.C1=_G.C1?_G.C1+","+r:r),n&&n(t,i)}})(_w.si_PP);
//]]></script><script type="text/javascript" src="/rms/SparkleFramework/jc/42426650/e7810346.js?bu=rms+serp+snr%24react-with-addons.min.source%2csnr%24Sparkle.source%2csnr%24Sparkle.React.source%2csnr%24ResourceManagement.source%2csnr%24Array_c.source%2csnr%24string_c.source"></script></head><body oncontextmenu="return false;" onload="if(_w.lb)lb();"><script type="text/javascript">//<![CDATA[
var TestHooksEnabled = false;;var ThresholdDiagnosticsProd=function(){function n(){}return n.prototype.recordApiString=function(n){console.log(n)},n}();_w.ThresholdDiagnostics=new ThresholdDiagnosticsProd;var CoreUtilities;(function(n){function i(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return t.apply(null,[null,n].concat(r))}function t(n,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return function(){for(var i=[],f,u=0;u<arguments.length;u++)i[+u]=arguments[u];if(i&&i.length!==0)for(f in r)r.hasOwnProperty(f)&&i.push(r[f]);else i=r;return t.apply(n,i)}}n.deferFunction=i,n.deferMethod=t,window.sj_df=i,window.sj_dm=t})(CoreUtilities||(CoreUtilities={}));var FailedPromise=function(){function n(){this.isActive=!0,this.operation=null}return n.prototype.then=function(n,t){return this.handleError(t),this},n.prototype.done=function(n,t){this.handleError(t)},n.prototype.handleError=function(n){this.isActive&&n&&_w.setImmediate(function(){return n(null)})},n.prototype.cancel=function(){this.isActive=!1},n}(),ThresholdUtilitiesM2=function(){function n(){this.regExes={},this.guidCleaner=/[-{}]/g,this.ampersandSanitizer=/&+$|((\?|&|#)&+)/g,this.isFirstPageStart=!0,this.startTime=_w.performance?_w.performance.timing.navigationStart:si_ST,this.apiSequenceNumber=0,this.headersAsyncPromise=null,this.headersCallComplete=!1,this.cortanaHeaders=null,this.themeColor=null,this.headersCallTimeout=3e3,this.headersCallbacks=[],this.langArray=["ar","dv","fa","he","ku-arab","pa-arab","prs","ps","sd-arab","syr","ug","ur","qps-plocm"],sj_evt.bind("ajax.threshold.pageStart",sj_dm(this,this.onPageStart),1)}return n.prototype.getUrlParameter=function(n,t){for(var r=null,f=this.getParameterRegex(t),u,i,e=0;u=f.exec(n);)i=u;return i&&i.length>=2?r=i[1]:t==="mock"&&(r=this.getMockParameter(n)),r},n.prototype.setUrlParameter=function(n,t,i){var f=n,u=this.getParameterRegex(t).exec(n),r="&",s,o,e;return u?(r=u[0].substring(0,1),s=u.index,o=u.index+u[0].length,f=n.substring(0,s),i&&(f+=r+t+"="+i),f+=n.substring(o)):i&&(e=this.getRegex("devicecontent"),e.test(n)?n.indexOf("#")<0&&(r="#"):n.indexOf("?")<0&&(r="?"),f=n+r+t+"="+i),f},n.prototype.getDecodedQuery=function(n){var i=n,t;return i||(i=_w.location.href),t=this.getUrlParameter(i,"q"),t&&(t=decodeURIComponent(t.replace(this.getRegex("\\+")," ")).trim()),t},n.prototype.getUrlReadyQuery=function(n){return encodeURIComponent(n).replace(this.getRegex("%20"),"+")},n.prototype.recordApiTimeDetail=function(n,t,i){var e=new Date,o,r,f,u;if(n&&(_G.ApiTimes=_G.ApiTimes||{},_G.ApiTimes[n]=e.getTime()-this.startTime),i){o={};for(r in i)i.hasOwnProperty(r)&&(o[r]=i[r]);i=o,i.time=e}else i={time:e,label:n||t,sequence:this.apiSequenceNumber++};return f=_w.msWriteProfilerMark,u=i.sequence+","+(n||i.label),f&&f(u),_w.performance&&performance.mark&&performance.mark(u),i},n.prototype.recordApiTime=function(n){return this.recordApiTimeDetail(n),null},n.prototype.uploadApiTimes=function(n){var t=_G.ApiTimes;this.recordApiTime(n),t&&typeof Log2!="undefined"&&Log2&&(Log2.LogEvent("CPT2",{wt:t}),_G.ApiTimes={})},n.prototype.wrapSynchronousApiCall=function(n,t,i,r){for(var h=this,s=[],o,e,f,u=4;u<arguments.length;u++)s[u-4]=arguments[u];o=this.recordApiTimeDetail(i?i+"S":null,t),f=function(n,u){var e=h.recordApiTimeDetail(i?i+n:null,t,o),f=u?" exception: "+u.stack:"";h.recordApiString("ApiEnd "+n+' \t"'+(r?r:"")+'"\t'+t+"("+s.join(", ")+")\t"+(e.time.getTime()-o.time.getTime())+"ms elapsed"+f)};try{e=n[t].apply(n,s),f("C")}catch(c){f("E",c),SharedLogHelper.LogError("Exception","Failed while calling overrideMethod: "+t,c),e=null}return e},n.prototype.wrapApiCall=function(){for(var f=[],e,u=4;u<arguments.length;u++)f[u-4]=arguments[u];for(f=[],e=0;e<arguments.length;e++)f.push(arguments[e]);return f.splice(4,0,0,null),this.wrapApiCallWithTimeout.apply(this,f)},n.prototype.wrapApiCallWithTimeout=function(n,t,i,r,u,f){for(var c=[],l,s=6;s<arguments.length;s++)c[s-6]=arguments[s];if(_w.SearchAppWrapperLogging)return n[t].apply(n,c);var v=this,a=this.recordApiTimeDetail(i?i+"S":null,t),e,o,h=function(n,u){var e="stack",o=v.recordApiTimeDetail(i?i+n:null,t,a),f=u&&u[e]?" exception: "+u[e]:"";u&&f===""&&(f=" Windows error: "+u.message),v.recordApiString("ApiEnd "+n+' \t"'+(r?r:"")+'"\t'+t+"("+c.join(", ")+")\t"+(o.time.getTime()-a.time.getTime())+"ms elapsed"+f)};try{o=n[t].apply(n,c),u&&u>0&&(e=sb_st(function(){o&&o.cancel&&o.cancel(),h("T"),f&&f(null)},u)),o.then(function(n){return e&&sb_ct(e),h("C"),n},function(n){e&&sb_ct(e),h("E",n),SharedLogHelper.LogError("Exception","Failed in overrideMethod callback: "+t,n),f&&f(null)})}catch(y){e&&sb_ct(e),h("E",y),SharedLogHelper.LogError("Exception","Failed while calling overrideMethod: "+t,y),l=new FailedPromise,o=l.then(null,f)}return o},n.prototype.cleanGuid=function(n){var t=n;return t&&(t=t.replace(this.guidCleaner,"")),t},n.prototype.parseJSON=function(n){var i,t=null;if(n)try{i=JSON.parse(n)}catch(r){t=r}return i||console.log("Unable to parse JSON input: "+n+(t?".  Exception: "+t:"")),i},n.prototype.getCortanaHeaders=function(n){var f=this,i,u;if(this.headersCallComplete){n(this.cortanaHeaders);return}if(!this.headersAsyncPromise){i=null,u=!1;function e(){i&&(sb_ct(i),i=null),f.headersCallComplete=!0}function r(n){var i,r,t;if(!u)for(i=f.headersCallbacks,r=i.length,t=0;t<r;t++)i[t](n)}function s(n){e(),f.cortanaHeaders=n,r(n)}function o(){e(),r(null)}i=sb_st(function(){r(null),u=!0},this.headersCallTimeout),this.headersAsyncPromise=this.wrapApiCall(SearchAppWrapper.CortanaApp,"getQueryHeadersAsync","GQH_","getQueryHeaders").then(s,o)}this.headersCallbacks.push(n)},n.prototype.getThemeColor=function(n){function i(n){var i,t;this.themeColor==null&&n&&(i=n["X-BM-Theme"],i&&(t=i.split(";")[1],t&&t!=this._accentColor&&(r.themeColor="#"+t)))}var u=this,r=this;this.themeColor===null?this.getCortanaHeaders(function(t){i(t),n(u.themeColor)}):n(this.themeColor)},n.prototype.setBodyLangAttributes=function(n){_d.body.setAttribute("dir",this.langArray.some(function(t){return n=n.toLocaleLowerCase(),n==t||n.indexOf(t+"-")==0})?"rtl":"ltr"),_d.body.setAttribute("lang",n)},n.prototype.getEmptyTaskFrame=function(n){return{CustomTaskFrame:!0,Status:"InProgress",Uri:"action://FindMyStuff/FindDocument",TypeId:"b89d219d-7b61-48e7-8f3c-367e4a0e631b",RawTextQuery:{Uri:"entity://TextData",TypeId:"ae77cbd2-cf71-438c-95b4-d3b86dc4a60e",State:"Filled",Source:"Unknown",ClientUpdate:!1,Value:n,ProfanityMasked:n}}},n.prototype.recordApiString=function(n){ThresholdDiagnostics.recordApiString(n)},n.prototype.pushOntoArray=function(n,t){if(n&&t)for(var i in t)n.push(t[i])},n.prototype.navigateTo=function(n,t){var i=sj_ce("a","b_hide");i.href=n,i.setAttribute("data-h",t.GetNamespacedKValue()),_d.body.appendChild(i),i.click()},n.prototype.getParameterRegex=function(n){return this.getRegex("[?&#]"+n.toLowerCase()+"=([^&#]*)")},n.prototype.getRegex=function(n,t,i){var r=this.regExes[n];return r||(r=new RegExp(n,(i?"":"g")+(t?"":"i")),this.regExes[n]=r),r.lastIndex=0,r},n.prototype.getMockParameter=function(n){var u=null,f=null,t=n.indexOf("#"),r,i;return t>0&&t<n.length-1&&(r=n.substr(t+1).split("&"),i=r.filter(this.unlabeledParameterFilter),i.length>0&&(u=i[0])),u},n.prototype.unlabeledParameterFilter=function(n){return n.indexOf("=")<0},n.prototype.clearLocalCache=function(){this.cortanaHeaders=null,this.themeColor=null,this.headersAsyncPromise=null,this.headersCallComplete=!1,this.headersCallbacks=[]},n.prototype.onPageStart=function(n){console.log("onPageStart"),!this.isFirstPageStart&&n[1]&&(this.startTime=n[1],this.clearLocalCache()),this.isFirstPageStart=!1,sj_evt.fire("ajax.postload")},n}();_w.ThresholdUtilities=new ThresholdUtilitiesM2,sj_evt.bind("threshold.pageUnload",function(){sj_evt.fire("unload")},0);var SearchAppWrapper={CortanaApp:_w.CortanaApp,Utils:ThresholdUtilities};var sj_b=_d.body;_G.AppVer="8_01_2_4079551";sa_config={"u":"%2fAS%2fAPI%2fWindowsCortanaPane%2fV2%2fSuggestions%3fqry%3d","mkt":"en-US","f":"sb_form","i":"sb_form_q","c":"sw_as","targetLinkFormCode":"WNSGPH","highPriorityProviderResponses":["MRU","BCS","PP","CG"],"lowPriorityProviderResponses":["RAF","ARAF"],"serverBcsSupportedMarkets":{},"disabledProviderResponses":{"LE":true,"RAF":true,"ARAF":true,"PBI":true},"asf":1,"ePN":1,"sbt":1,"smg":1,"t":1,"showThumbnailsForControlPanelSettings":1,"logRankerOutput":1,"cancellationEnabled":1,"lifeTimeEventsAvailable":1,"allowKeyboardNavCycling":1,"eHC":1,"demo":1,"d":0,"maxNumberOfTopResults":4,"serverBcsVersion":16,"providerResponsesMaximumWaitTime":500,"SCT":1500,"multipleTopHitMinConfidenceScore":0.27,"multipleTopHitMinConfidenceSum":0.27,"multipleTopHitSecondaryMinConfidenceScore":0.03};;var _CachedFlights =["d-thshld39","d-thshldspcl40","mystuffqu"];;var sa_acConfig = "d03c1acc";;var AppCacheState;(function(n){function r(){return t}function i(){if(t){var i=sj_cook.get("SRCHHPGUSR","IAC"),n="";i&&i!==""?i.indexOf(t)<0&&(n=t+","+i):n=t,n!==""&&sj_cook.set("SRCHHPGUSR","IAC",n,!0,"/")}}var u=sb_gt().toString(),t;sj_cook.set("_SS","CPID",u,!1,"/"),t=_w.sa_acConfig,t&&sj_cook.set("_SS","CPH",t,!1,"/"),n.GetAppCacheVersion=r,n.MarkAppCacheVersionAsInvalid=i})(AppCacheState||(AppCacheState={}));
//]]></script><div id="root"><div class="cf scr" id="container"><div class="suggestions" data-region="Core" role="listbox"><div id="topResults" data-region="TopHit"></div><div id="groups"></div></div></div><div id="permanentDisambig"></div></div><script type="text/javascript">//<![CDATA[
_G.FCT=new Date;
//]]></script><script type="text/javascript">//<![CDATA[
_G.BCT=new Date;
//]]></script><script type="text/javascript">//<![CDATA[
(function(){function r(i){var r,u;i&&(r=t(i),_w.Log2&&(Log2.LogEvent(r.eventType,r.data),n()&&(sj_evt.fire("visibility",document.hidden),_w.ThresholdUtilities&&(u=_w.ThresholdUtilities,u.uploadApiTimes("PCE")),_w.ClickConfig&&ClickConfig.FlushSkipAbort?Log2.FlushMainQueueDontForce():Log2.ForceFlush(),_w.clickFlushedTime=sb_gt())))}function n(){for(var n=_w.event.srcElement;!n.href;)if(n.parentElement)n=n.parentElement;else return!1;return n.href.split("#")[0]!==_d.URL.split("#")[0]?!0:!1}function t(n){var t=n.match(i);return{eventType:"Click",data:{AppNS:t[1],K:t[2]}}}var i=/ID=(\w+),(\d+(?:\.\d+)*)/i;_w.si_T=r})();define("onHTML",["require","exports","event.custom"],function(n,t,i){i.fire("onHTML")});(function(n,t){onload=function(){_G.BPT=new Date,n&&n();var r=new Date,i=function(){t(r),sj_evt.unbind("ajax.threshold.pageStart",i)};sj_evt.bind("ajax.threshold.pageStart",i),_w.si_PP=function(){},sb_st(function(){sj_evt.fire("onPP"),sj_evt.fire(_w.p1)},0)}})(_w.onload,_w.si_PP);sj_be(_d,"mousewheel",function(n){n.ctrlKey==!0&&sj_pd(n)}),sj_be(_d,"keydown",function(n){n.ctrlKey==!0&&(n.keyCode==107||n.keyCode==109||n.keyCode==187||n.keyCode==189)&&sj_pd(n)});var AutoSuggest;(function(n){var t;(function(t){var i=function(){function i(){}return i.prototype.emptyQueryScenarioEnabled=function(){return!1},i.prototype.allResponseTypes=function(){return[t.ResponseTypes.BingContentStore,t.LocalSuggestionTypes.BCSApp,t.LocalSuggestionTypes.BCSSetting,n.WebResponseType,t.ResponseTypes.OnlineSuggestionsThatMapToApps,t.OnlineSuggestionTypes.SpellCorrectedSetting,t.LocalSuggestionTypes.App,t.LocalSuggestionTypes.Setting,t.ResponseTypes.LocalMedia,t.LocalSuggestionTypes.PowerBi,t.LocalSuggestionTypes.File,t.LocalSuggestionTypes.Email,t.ResponseTypes.ReactiveAgents,t.ResponseTypes.AppRelatedReactiveAgents,t.LocalSuggestionTypes.CommandLine,t.LocalSuggestionTypes.PathCompletion,t.ResponseTypes.MRUSignals]},i.prototype.responseTypeDependencies=function(i){return i==n.WebResponseType?[t.ResponseTypes.OnlineSuggestionsThatMapToApps,t.OnlineSuggestionTypes.SpellCorrectedSetting]:[]},i}();t.WindowsCortanaPaneSettings=i})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var LocStringManager,WindowsCultureResolver;(function(n){function h(n,t){if(!n)throw"locStringKey is null";if(!t)throw"locString is null";var s=n.namespace,f=i(s)||c(s),u=n.name,h=r(u,f)||o(u,f);e(n.uiCulture,t,h)}function s(n){var o,h,s,c,e,u;if(!n)throw"locStringKey is null";if(o=n.namespace,h=i(o),!h)throw"namespace "+o+" is not registered";if(s=n.name,c=r(s,h),!c)throw"name "+s+" is not registered in namespace "+o;for(e=n.uiCulture;!u;)if(u=f(e,c),u||e)u||(e=t.resolveCulture(e));else throw"the invariant empty culture does not have parent";return u}function l(n){if(!n)throw"parentCultureResolver is null";n.parentParentCultureResolver=t,t=n}function i(n){if(!n)throw"namespace in locStringKey is null";return u[n]}function c(n){if(!n)throw"namespace in locStringKey is null";return u[n]={}}function r(n,t){if(!n)throw"name in locStringKey is null";return t[n]}function o(n,t){if(!n)throw"name in locStringKey is null";return t[n]={}}function e(n,t,i){if(typeof n=="undefined"||n===null)throw"uiCulture in locStringKey is null";i&&(i[n.toLowerCase()]=t)}function f(n,t){if(typeof n=="undefined"||n===null)throw"uiCulture in locStringKey is null";return t?t[n.toLowerCase()]:null}var u={},t={parentParentCultureResolver:null,resolveCulture:function(n){if(!n)throw"culture is null";var t=n.lastIndexOf("-");return t>0?n.substring(0,t):""}};n.register=h,n.getLocString=s,n.addParentCultureResolver=l})(LocStringManager||(LocStringManager={})),function(){var i={as:"as-in",bs:"bs-latn-ba","fil-latn":"fil-ph","gd-latn":"gd-gb","ig-latn":"ig-ng","ky-cyrl":"ky-kg","mi-latn":"mi-nz",ml:"ml-in","mn-mn":"mn-cyrl",nb:"nb-no",nn:"nn-no",or:"or-in","prs-arab":"prs-af","quc-latn":"qut","tk-latn":"tk-tm","tt-cyrl":"tt-ru","uz-latn":"uz-latn-uz","yo-latn":"yo-ng","zh-cn":"zh-chs","zh-hant-hk":"zh-cht","zh-hant-mo":"zh-cht","zh-hant-tw":"zh-cht","zh-hans-cn":"zh-chs","zh-hans-sg":"zh-chs","zh-hk":"zh-cht","zh-tw":"zh-cht"},t={parentParentCultureResolver:null,resolveCulture:function(n){var u=!1,r=n;return r&&(r=i[r.toLowerCase()])&&(u=!0),u||(r=t.parentParentCultureResolver.resolveCulture(n)),r}};LocStringManager.addParentCultureResolver(t)}(WindowsCultureResolver||(WindowsCultureResolver={}));
//]]></script><script type="text/javascript" src="/rms/rms%20localizationstrings%20AutoSuggest%20CortanaQF/jc/3879d3e3/24af6ca7.js"></script><script type="text/javascript">//<![CDATA[
var AutoSuggest;(function(n){var t;(function(t){function u(t,i,r,u,f){if(!t)return r?{content:r,type:1}:null;if(typeof t!="string")try{return{content:URL.createObjectURL(t),type:0,bgColor:u}}catch(e){return n.reportException(e,"convertToHtmlImage "+i,f),r?{content:r,type:1}:null}else return{content:t,type:0,bgColor:u}}function o(n,t){var i=parseInt(n,16),f=i>>16&255,u=i>>8&255,r=i&255;return"rgba("+f+","+u+","+r+","+t+")"}var f,i,r,e;t.toIcon=u,e=function(){function e(u,e){var o=this,s;this._modifierKeyState={altKey:!1,ctrlKey:!1,shiftKey:!1},this._appItemLaunchEventHandlers=[],this._appVisibleEventHandlers=[],this._conversationStartEventHandlers=[],this._dismissedEventHandlers=[],this._appHiddenEventHandlers=[],this._queryTextChangedHandlers=[],this._keyDownHandlers=[],this._keyUpHandlers=[],this._state=0,this._inConversationZero=!0,this.getBrowserIcon=function(n,t){n?o._browserIconTopResultCache(t):o._browserIconCache(t)},this._config=u,this._settings=e,n.safeExecute(function(){f=CortanaApp.queryFormulationView,i=CortanaApp.launcher,r=CortanaApp.searchBox,o._currentCVID=o.getNewConversationId(),o._state=CortanaApp.currentState,CortanaApp.addEventListener("statechanged",function(t){o._state=t.newState,t.oldState==0&&t.newState==1&&o._appVisibleEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"appVisible")}),t.newState==2&&o._conversationStartEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"conversationStart")}),t.oldState==2&&o._dismissedEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"dismissed")}),t.newState==0&&o._appHiddenEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"appHidden")})}),r.addEventListener("querytextchanged",function(i){o._config.lifeTimeEventsAvailable&&o._state!=2&&n.reportException(new Error("Got querytextchanged event before visible event or after hidden event"),"queryTextChanged");var r=t.parseQuery(i,o._config);o._queryTextChangedHandlers.forEach(function(t){return n.safeExecute(function(){return t(r)},"queryTextChanged")})}),r.addEventListener("keydown",function(t){var r=t.keyCode,i={shiftKey:t.isShiftKeyPressed,ctrlKey:t.isControlKeyPressed,altKey:!1};o._keyDownHandlers.forEach(function(t){return n.safeExecute(function(){return t(r,i)},"keyDown")})}),r.addEventListener("keyup",function(t){var r=t.keyCode,i={shiftKey:t.isShiftKeyPressed,ctrlKey:t.isControlKeyPressed,altKey:!1};o._keyUpHandlers.forEach(function(t){return n.safeExecute(function(){return t(r,i)},"keyUp")})})},"WindowsHostInit"),this.bindConversationStart(function(){sj_evt.fire("ajax.threshold.pageStart",+new Date);var t=o.getNewConversationId();o._currentCVID!=t||o._inConversationZero?(o._currentCVID=t,o._inConversationZero=!1):n.reportException(new Error("CVID hasn't been refreshed"),"bindConversationStart"),o.initCachedVariables(!1)}),this.bindDismissed(function(){t.prefixesToScope=null,sj_evt.fire("WindowsFeedback.Form.Hide"),sj_evt.fire("threshold.pageUnload")}),this.bindAppHidden(function(){o._browserIconCache=null,o._browserIconTopResultCache=null,t.Promise.clearGlobalCache()}),this.initCachedVariables(!0),this.bindKeyDown(function(n,t){o._modifierKeyState=t,o._lastKeyRemovedAutocompletion=o._isQueryAutocompleted&&(n==8||n==46||n==88&&t.ctrlKey),o._isQueryAutocompleted=!1}),this.bindKeyUp(function(n){switch(n){case 16:o._modifierKeyState.shiftKey=!1;break;case 17:o._modifierKeyState.ctrlKey=!1}}),typeof PageDebug=="undefined"&&(PageDebug={}),PageDebug.canvas="QF",s=r.getQueryText(),this._currentRawImpressionId=s.impressionId||this.createGuid(),this._partialQuery=s.queryText,PageDebug.query=this._partialQuery,this.bindQueryChanged(function(n){return o.onQueryChanged(n)}),this.checkFlightExpiration()}return e.prototype.init=function(){this._config.lifeTimeEventsAvailable||(this._appVisibleEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"appVisible")}),this._conversationStartEventHandlers.forEach(function(t){return n.safeExecute(function(){return t()},"conversationStart")}))},e.prototype.bindAppItemLaunch=function(n){this._appItemLaunchEventHandlers.push(n)},e.prototype.getInstrumentationParameters=function(t){var i=CortanaApp.createStringMap?CortanaApp.createStringMap():{};return _G.nclid&&(i[n.Service.QueryParams.HashedMuid]=_G.nclid),t||(t=this._config.targetLinkFormCode),i[n.Service.QueryParams.FormCode]=t,i[n.Service.QueryParams.ConversationId]=this.getConversationId(),i},e.prototype.initCachedVariables=function(i){var o=this,e,r;CortanaApp.isMobile&&_w.EdgeIcon?(this._browserIconCache=function(n){return n(u(_w.EdgeIcon,"browserIconMobile"))},this._browserIconTopResultCache=function(n){return n(u(_w.EdgeIcon,"browserIconTopResultMobile"))}):(this._browserIconCache=t.Promise.safeChainWithCaching("browserIcon",function(){return f.getIconForDefaultBrowserAsync(t.IconSize_SingleLineSuggestion)},function(n){return u(n,"browserIcon")}),this._browserIconTopResultCache=t.Promise.safeChainWithCaching("browserIconTopResult",function(){return f.getIconForDefaultBrowserAsync(t.IconSize_TopResult)},function(n){return u(n,"browserIconTopResult")})),e={uiCulture:CortanaApp.uiLanguage,name:"CortanaQF",namespace:"AutoSuggest"},this._locStrings=n.safeExecute(function(){return LocStringManager.getLocString(e)},"getLocString "+e.uiCulture),this._locStrings||(e.uiCulture="en-US",this._locStrings=LocStringManager.getLocString(e)),ThresholdUtilities.getCortanaHeaders(function(n){var i,t;n&&(i=n["X-BM-Theme"],i&&(t=i.split(";")[1],t&&t!=o._accentColor&&(o._accentColor=t,o.applyAccentColor(t))))}),i||(t.isCortanaEnabledCache=CortanaApp.isCortanaEnabled,t.isBingEnabledCache=CortanaApp.isBingEnabled,t.regionCache=CortanaApp.region,t.uiLanguageCache=CortanaApp.uiLanguage),this._queryParamsCache={cc:t.regionCache,setlang:t.uiLanguageCache},r=[],CortanaApp.systemRAMInMB&&CortanaApp.systemRAMInMB<=512&&r.push("LowMemoryDevice"),CortanaApp.isOemEnabled&&r.push("OemConfigured"),r.push("FontV2"),this._headersCache={},r.length>0&&(this._headersCache["X-BM-ClientFeatures"]=r.join()),ThresholdUtilities.setBodyLangAttributes(CortanaApp.uiLanguage)},e.prototype.applyAccentColor=function(t){var r,u="accent-style",i=_ge(u);i||(i=_d.createElement("style"),i.setAttribute("id",u),i.type="text/css",r=!0),i.innerHTML=n.formatString(".icon svg { fill: {0} } .action, .accentColor { color: {0}; } .sa_hv, .sa_hv:hover { background: {1}; } ",["#"+t,o(t,.3)]),r&&_d.head.appendChild(i)},e.prototype.onQueryChanged=function(n){this._currentRawImpressionId=n.impressionId||this.createGuid(),this._partialQuery=n.queryToFetch,PageDebug.query=this._partialQuery},e.prototype.createGuid=function(){return n.safeExecute(function(){return CortanaApp.createGuid()},"createGuid","")},e.prototype.getLocString=function(n){return this._locStrings[n]},e.prototype.getImpressionGuid=function(){return n.cleanGuid(this._currentRawImpressionId)},e.prototype.getConversationId=function(){return this._currentCVID},e.prototype.getNewConversationId=function(){return n.cleanGuid(n.safeExecute(function(){return f.perfMetrics.conversationId},"conversationId",""))},e.prototype.bindQueryChanged=function(n){this._queryTextChangedHandlers.push(n)},e.prototype.getModifierKeyState=function(){return this._modifierKeyState},e.prototype.didLastKeyRemoveAutocompletion=function(){return this._lastKeyRemovedAutocompletion},e.prototype.checkFlightExpiration=function(){if(this._config.aC_fe){var i=this.formatDateYYYYMMDD(new Date),t=this._config.aC_fe;i>t&&n.safeExecute(function(){return CortanaApp.repopulateAppCacheAsync()},"repopulateAppCacheAsync")}},e.prototype.formatDateYYYYMMDD=function(n){var r=n.getFullYear().toString(),t=(n.getMonth()+1).toString(),i=n.getDate().toString();return r+(t[1]?t:"0"+t[0])+(i[1]?i:"0"+i[0])},e.prototype.bindAppVisible=function(n){this._appVisibleEventHandlers.push(n)},e.prototype.bindConversationStart=function(n){this._conversationStartEventHandlers.push(n)},e.prototype.bindDismissed=function(n){this._dismissedEventHandlers.push(n)},e.prototype.bindAppHidden=function(n){this._appHiddenEventHandlers.push(n)},e.prototype.bindKeyDown=function(n){this._keyDownHandlers.push(n)},e.prototype.bindKeyUp=function(n){this._keyUpHandlers.push(n)},e.prototype.getQuery=function(){return t.parseQuery(r.getQueryText(),this._config)},e.prototype.setQuery=function(t){t=t?t:this._partialQuery,n.safeExecute(function(){return r.setQueryText(t)},"setQuery")},e.prototype.setAutoCompleteQueryText=function(t){var i=this;n.safeExecute(function(){return r.setAutoCompleteQueryText(t,i._currentRawImpressionId)},"setAutoCompleteQueryText"),this._isQueryAutocompleted=!0},e.prototype.adjustSize=function(){},e.prototype.launchUrl=function(t){n.safeExecute(function(){return i.launchUriAsync(t)},"launchUrl")},e.prototype.launchSearch=function(r,u,f){var e=this,o=f&&this._config.useRafForWebTopHit&&t.isCortanaEnabledCache;o?(this.setQuery(r),n.safeExecute(function(){return i.launchRAFAsync(r,e._config.targetLinkFormCode,e.getInstrumentationParameters())},"launchVoiceFlow")):n.safeExecute(function(){if(CortanaApp.isMobile){var n=i.createSearchLaunchOptions();n.searchQuery=r,n.mode=1,n.uriContext=u.substr(u.indexOf("&")+1),e.setQuery(r),i.launchSearchAsync(n)}else i.launchUriAsync(u)},"launchSearch")},e.prototype.launchMyStuff=function(r,u,f,e){var h=this,s,o;this.setQuery(r),_w.localStorage&&e&&e.length>0&&(s={Query:r,SectionOrder:e.map(function(n){return t.getSectionType(n)})},n.safeExecute(function(){return _w.localStorage.QFGroupOrder=JSON.stringify(s)},"save group order for myStuff")),!u&&t.isCortanaEnabledCache&&this._config.alwaysGoToMyStuffThroughRAF?(o='{"Uri":"action://FindMyStuff//FindDocument"}',n.safeExecute(function(){return i.launchMyStuffTaskFrameAsync(r,f,o,h.getInstrumentationParameters(f))},"launchMyStuffRAF")):n.safeExecute(function(){return i.launchMyStuffAsync(r,u,null,f,h.getInstrumentationParameters(f))},"launchMyStuff")},e.prototype.launchCat1=function(t,r){var u=this;this.setQuery(t),n.safeExecute(function(){return i.launchCat1Async(t,r,u.getInstrumentationParameters())},"launchCat1")},e.prototype.launchCat1MyStuff=function(t,r){var u=this;this.setQuery(t),n.safeExecute(function(){return i.launchMyStuffTaskFrameAsync(t,u._config.targetLinkFormCode,r,u.getInstrumentationParameters())},"launchCat1MyStuff")},e.prototype.launchCat2or3a=function(t,r){var u=this;this.setQuery(t),r?n.safeExecute(function(){return i.launchCat2Async(t,u._config.targetLinkFormCode,r,u.getInstrumentationParameters())},"launchCat2"):n.safeExecute(function(){return i.navigateReactiveViewAsync(t,u._config.targetLinkFormCode)},"navigateReactiveView")},e.prototype.launchStorePdp=function(t,r){var u=r?"ms-windows-store://pdp/?ProductId="+encodeURIComponent(r):"ms-windows-store:PDP?PFN="+encodeURIComponent(t.substring(0,t.indexOf("!")));n.safeExecute(function(){return i.launchUriAsync(u)},"launchStorePdp")},e.prototype.launchStoreSearch=function(t){var r="ms-windows-store:search?query="+encodeURIComponent(t);n.safeExecute(function(){return i.launchUriAsync(r)},"launchStoreSearch")},e.prototype.launchFolder=function(t){n.safeExecute(function(){return i.startLaunchFolder(t)},"launchFolder")},e.prototype.launchDeviceItem=function(t){n.safeExecute(function(){return i.launchSearchItemAsync(t)},"launchDeviceItem")},e.prototype.launchAppItem=function(t,r){this._appItemLaunchEventHandlers.forEach(function(n){return n(t)}),n.safeExecute(function(){var n;r&&(n=i.createAppLaunchOptions(),n.appContext=r),i.launchSearchItemAsync(t,n)},"launchAppItem")},e.prototype.getCustomUrlParameters=function(){return this._queryParamsCache},e.prototype.getCustomHeaders=function(){return this._headersCache},e.prototype.reloadWebView=function(){n.safeExecute(function(){CortanaApp.reloadWebViewAsync?CortanaApp.reloadWebViewAsync():location.reload()},"reloadWebView")},e}(),t.Host=e})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t=function(){function t(n,t){this._callParams={},this._callHeaders={},this._config=n,this._instrumentationHelper=t}return t.prototype.addParam=function(n,t){this._callParams[n]=t},t.prototype.addHeader=function(n,t){this._callHeaders[n]=t},t.prototype.fetch=function(n,t,i,r,u){var e=decodeURIComponent(this._config.u)+encodeURIComponent(n.queryToFetch.toLowerCase()),f;for(f in this._callParams)e+="&"+f+"="+this._callParams[f];this._callParams={},this._instrumentationHelper.instrumentSnRProviderFetchUrl(i,e),this.fetchUrl(e,t,i,r,u)},t.prototype.warmUp=function(){var i,t;if(this._config.sslPriming)for(i=Date.now(),t=1;t<=4;t++)this.fetchUrl("/keepalive/default.aspx?request="+t+"&ts="+i,null,n.InstrumentationCommon.INVALID_SEQUENCE_NUMBER,null,function(){return!1})},t.prototype.fetchUrl=function(t,i,r,u,f){var s=this,e=sj_gx(),o;e.open("GET",t,!0);for(o in this._callHeaders)e.setRequestHeader(o,this._callHeaders[o]);this._callHeaders={},e.onreadystatechange=function(){var r,t,u;f()&&e.readyState==4&&(e.onreadystatechange=function(){},i?(e.status==200?(t=e.responseText,s._config.th&&t&&(t=t.replace(new RegExp("<!--[^]*?-->","gm"),"")),r=t?n.safeExecute(function(){return JSON.parse(t)},"parseWebProviderResponse"):null,r&&(u=r.Resources,u&&s.injectContent(u.Styles))):e.status!=0&&n.reportException(new Error(e.status+" "+e.statusText),"parseWebProviderResponse"),i(n.WebResponseType,r,null)):e.status!=0&&e.status!=200&&e.status!=204&&n.reportException(new Error(e.status+" "+e.statusText),"parseWebProviderResponse"))},e.withCredentials!==undefined&&(e.withCredentials=!0),e.send()},t.prototype.injectContent=function(n){var r,u,t,i;n&&(r="answerCss",u=_d.createElement("div"),u.innerHTML=n,t=u.firstChild,t.id=r,i=_d.getElementById(r),i?i.innerHTML=t.innerHTML:_d.head.appendChild(t))},t}();n.SnRDataProvider=t})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(n){var f=function(){function n(){}return n.User="SRCHHPGUSR",n.History="_UR",n}(),u,r,t,i;n.CookieNames=f,u=function(){function n(){}return n.AutoSuggest="AS",n.History="OMW",n}(),n.CrumbNames=u,r=function(){function n(){}return n.CursorPosition="cp",n.Options="o",n.ConversationId="cvid",n.SuggestionCount="sc",n.PartialQuery="pq",n.SuggestionPosition="sp",n.SuggestionType="qs",n.PreviewPaneSuggestionType="qsc",n.SkipValue="sk",n.PreviewPaneSkipValue="skc",n.Ghosting="ghc",n.PreviewPaneDisabled="ppd",n.Css="css",n.CssVersion="ver",n.Count="count",n.DataSet="ds",n.SessionId="sid",n.TimeStamp="qt",n.Query="q",n.ImpressionGuid="ig",n.QFQuery="qry",n.FormCode="form",n.HashedMuid="nclid",n}(),n.QueryParams=r,t=function(){function n(){}return n.HistoryEnabled="hs",n.HitHighlighting="h",n.PopularNow="p",n.Local="l",n.Answers="a",n}(),n.Options=t,i=function(){function n(){}return n.Id="id",n.Query="query",n.Url="url",n.Navigation="nav",n.Type="stype",n.Autocomplete="hc",n}(),n.SuggestionAttributes=i})(t=n.Service||(n.Service={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){function et(){return navigator.onLine}function l(n){return n?n.replace(w,"$1").replace(p,"$1 "):n}function ht(n){return n?n.replace(/-/g,"").replace("{","").replace("}","").toLowerCase():null}function ft(t,i){t.query.indexOf(i.queryToFetch)==-1&&t.query.toLowerCase().indexOf(i.queryToFetch.toLowerCase())==0&&(t.query=i.queryToFetch+t.query.substr(i.queryToFetch.length),t.text=n.HitHighlighting.addMarkers(t.query,i.queryToFetch))}function c(n,i,r,u){var f,e;n&&(n=n.slice(0,i)+t+n.slice(i,n.length)),f=r(n),f&&(e=f.indexOf(t),i=e!=-1?e:i,f=f.replace(t,"")),u(f,i)}function rt(n,t){var i,r;return c(n,t,l,function(n,t){i=n,r=t}),{originalQuery:n,originalCursorPosition:t,queryToFetch:i,cursorPosition:r,enabledProviderResponses:null,disabledProviderResponses:[],webResponseNeeded:!0,equals:function(n){return(i?i.toLowerCase():i)==(n.queryToFetch?n.queryToFetch.toLowerCase():n.queryToFetch)}}}function ut(n,t,i){return i.disabledProviderResponses[n]?!1:t&&(t.disabledProviderResponses.some(function(t){return t==n})||t.enabledProviderResponses&&!t.enabledProviderResponses.some(function(t){return t.responseType==n}))?!1:!0}function tt(n){return n=n.trim(),n.replace(/^\/+|^(ht+p(s?)[;:]+)?\/*/i,"http$2://")}function it(n,t){for(var i=0;i<n.length;++i)if(t(n[i]))return i;return-1}function b(n,t){if(n.length!=t.length)return!1;for(var i=0;i<n.length;++i)if(n[i]!=t[i])return!1;return!0}function st(n,t){return n?n.replace(ot,function(n){return t[parseInt(n.substring(1,n.length-1))]}):n}function f(n){var i=n?n.number:null,t=n?n.name:null;return i==-2147023673||t=="Canceled"}function s(t,i,r){var s,e,o,c;f(t)||(s=t?t.number:null,e=(t?(t.stack||t.message||t)+"":"").replace(u,"").replace(h,"\n").split("\n"),e.length>1&&e[0]==e[1]&&(e=e.slice(1)),o="["+i+"] "+(s?s+" ":"")+e[0]+(r?"\n"+r:"")+(e.length>1?"\n"+e.slice(1).join("\n"):""),n.log(o,t),c={Text:o,Meta:_w.location.href,Name:"JSError"},Log2.LogEvent("ClientInst",c,"Error"))}function nt(n,t,i,r){try{return n()}catch(u){return s(u,t,r),i}}function v(n){return o.indexOf(n)!=-1}function d(n){return y.indexOf(n)!=-1}function g(n){return a.indexOf(n)!=-1}function k(n,t){return n==93||n==121&&t}var i=n.Service.QueryParams,t=String.fromCharCode(57346),w=new RegExp("^\\s*("+t+")?\\s*","g"),p=new RegExp("\\s*("+t+")?\\s+","g"),ot=/{[0-9]+}/g,u,h,r,e;n.isBrowserOnline=et,n.cleanQuery=l,n.cleanGuid=ht,n.adjustCasing=ft,n.mantainCursorPositionIn=c,n.parseQuery=rt,n.isResponseTypeEnabled=ut,n.fixUrlProtocol=tt,n.indexOf=it,n.sequenceEqual=b,n.log=function(){},sa_config.th&&(n.log=n.ClientTestHooks.ClientLog),n.formatString=st,n.isCancellation=f,u=/\r/g,h=/\n\n/g,n.reportException=s,n.safeExecute=nt,n.WebResponseType="Web";var o=[38,40,9,],y=o.concat([36,35,33,34,]),a=[3,16,17,18,19,20,45,91,92,93,144,145,];n.isNavigationKey=v,n.isMovingCursorKey=d,n.isModifierKey=g,n.isContextMenuKey=k,r=function(){function n(){this._callbacks={},this._lastId=0}return n.prototype.register=function(n){var t=++this._lastId;return this._callbacks[t]=n,t},n.prototype.unregister=function(n){delete this._callbacks[n]},n.prototype.cancelAll=function(){for(var n in this._callbacks)this._callbacks[n]();this._callbacks={}},n}(),n.CancellationManager=r,e=function(){function t(t,i,u,f,e,o,s,h,c,l){var a=this;if(t.cancellationEnabled&&(this._cancellationManager=new r),this._config=t,this._settings=i,this._host=u,this._suggestionsParser=f,this._rootViewModel=e,this._suggestionsRenderingManager=o,this._webProvider=s,this._otherProviders=h,this._currentQuery=u.getQuery(),this._instrumentationHelper=c,this._sequenceNumberManager=l,u.bindAppVisible(function(){return a.warmUpWebProvider()}),u.bindConversationStart(function(){a._lastQuery=null,a._currentQuery=null,a._lastQueryWithoutHistory=null,a._lastKeyWasEnter=!1,a._instrumentationHelper.reset()}),u.bindDismissed(function(){a.finishPreviousQuery(),a._suggestionsRenderingManager.resetState(),a._sequenceNumberManager.reset(),a._fetchTimer&&(sb_ct(a._fetchTimer),a._fetchTimer=null),a._config.th&&n.ClientTestHooks.resetLog()}),u.bindQueryChanged(function(n){return a.onQueryChanged(n)}),u.bindKeyDown(function(n,t){return a.onKeyDown(n,t)}),this._currentQuery.queryToFetch||this._currentQuery.queryToFetch==""&&i.emptyQueryScenarioEnabled()){e.onQueryChanged(this._currentQuery);this.fetchForQueryChange(0)}else this._lastQuery=this._currentQuery}return t.prototype.warmUpWebProvider=function(){var t=this;this._instrumentationHelper.profileKeystroke(n.InstrumentationCommon.INVALID_SEQUENCE_NUMBER,function(){return"warmUpWeb"},function(){return t._webProvider.warmUp()})},t.prototype.finishPreviousQuery=function(){this.cancelPreviousQuery();var n=this._sequenceNumberManager.getSequenceNumber();n>0&&this._instrumentationHelper.finalizeKeystrokeLog(n)},t.prototype.onKeyDown=function(n,t){var i=n==13;if(i){if(!this._lastKeyWasEnter)this.onSubmit(t)}else(n==8||n==46||n==88&&t.ctrlKey)&&(this._config.forceDefaultTopResultWhenBackspacing||this._host.didLastKeyRemoveAutocompletion())?(this._suggestionsRenderingManager.setDefaultTopResult(this._sequenceNumberManager.getNextSequenceNumber()),this._lastQuery=null):this._suggestionsRenderingManager.setDefaultTopResult(-1);this._lastKeyWasEnter=i},t.prototype.onQueryChanged=function(n){var i=this,t;this._currentQuery=n,this._lastQuery&&!this._lastQuery.equals(this._currentQuery)&&this.cancelPreviousQuery(),this._config.d<=0?this.fetchForQueryChange(0):(this._fetchTimer&&sb_ct(this._fetchTimer),t=Date.now(),this._fetchTimer=sb_st(function(){return i.fetchForQueryChange(Date.now()-t)},this._config.d)),this._lastKeyWasEnter=!1},t.prototype.onSubmit=function(n){this._fetchTimer&&(sb_ct(this._fetchTimer),this.fetchForQueryChange(0)),this._instrumentationHelper.instrumentSubmissionBegin(),this._rootViewModel.submit(this._sequenceNumberManager.getSequenceNumber(),n)},t.prototype.cancelPreviousQuery=function(){this._cancellationManager&&this._cancellationManager.cancelAll()},t.prototype.fetchForQueryChange=function(n){var t,i;if(this._fetchTimer=undefined,!this._lastQuery||!this._currentQuery||!this._lastQuery.equals(this._currentQuery)){for(this.finishPreviousQuery(),this._lastQuery=this._currentQuery,this._sequenceNumberManager.incrementSequenceNumber(),t=this._sequenceNumberManager.getSequenceNumber(),this._instrumentationHelper.instrumentBeginRequest(t,this._currentQuery.queryToFetch,n),this._suggestionsRenderingManager.initiateSequenceNumber(t,this._currentQuery),this._currentQuery.webResponseNeeded&&this.fetch(this._currentQuery,this._webProvider,this._webProvider,t),i=0;i<this._otherProviders.length;++i)this.fetch(this._currentQuery,this._otherProviders[i],null,t);this._rootViewModel.onQueryChanged(this._currentQuery)}},t.prototype.fetch=function(t,r,u,f){var e=this,c=function(){return e._config.d>0?t.equals(e._currentQuery):f==e._sequenceNumberManager.getSequenceNumber()},a=function(n,i,r){return e.onResponseReceived(t,f,n,i,r,c)},l,o,s,h;if(u){this.shouldFetchHistory(t.queryToFetch)&&this._webProvider.addParam(i.Options,n.Service.Options.HistoryEnabled),this._webProvider.addParam(i.CursorPosition,t.cursorPosition.toString()),this._webProvider.addParam(i.ConversationId,this._host.getConversationId()),this._webProvider.addParam(i.ImpressionGuid,this._instrumentationHelper.getImpressionGuid(f)),l=this._host.getCustomUrlParameters();for(o in l)this._webProvider.addParam(o,l[o]);s=this._host.getCustomHeaders();for(h in s)this._webProvider.addHeader(h,s[h]);u.fetch(t,a,f,this._cancellationManager,c)}else r.fetch(t,a,f,this._cancellationManager,c)},t.prototype.onResponseReceived=function(t,i,r,u,f,e){var s=this;if(e()){this._instrumentationHelper.instrumentResponseReceived(i,r,f),r==n.WebResponseType&&this.checkIfResponseHasHistoryItems(t.queryToFetch,u);var o=[],c=!0,h=function(n,t,r){if(e())if(c)o.push({responseType:n,suggestions:t,extraSignals:r});else s.onSuggestionsParsed(i,n,t,r)};this._instrumentationHelper.profileKeystroke(i,function(){return"parseResponse_"+r},function(){return s._suggestionsParser.parse(t,i,r,u,e,h,s._cancellationManager)}),c=!1,o.forEach(function(n){return h(n.responseType,n.suggestions,n.extraSignals)}),o=null}},t.prototype.onSuggestionsParsed=function(n,t,i,r){this._instrumentationHelper.instrumentDataSource(n,t,i),this._suggestionsRenderingManager.queueSuggestions(n,t,i,r)},t.prototype.shouldFetchHistory=function(n){return this.isHistoryEnabled()&&(!this._lastQueryWithoutHistory||n.indexOf(this._lastQueryWithoutHistory)!=0)},t.prototype.checkIfResponseHasHistoryItems=function(n,t){var i=!1;t&&t.Suggestions&&t.Suggestions.length>0&&t.Suggestions[0].Attributes.stype=="HS"&&(i=!0),i||(this._lastQueryWithoutHistory=n)},t.prototype.isHistoryEnabled=function(){return this._config.sid&&this._config.eHS&&sj_cook.get(n.Service.CookieNames.History,n.Service.CrumbNames.History)!="0"},t}(),n.Core=e})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){function nt(n,t){var u,i,r;if(n.length===0)return t.length;if(t.length===0)return n.length;for(u=[],i=0;i<=t.length;i++)u[i]=[i];for(r=0;r<=n.length;r++)u[0][r]=r;for(i=1;i<=t.length;i++)for(r=1;r<=n.length;r++)u[i][r]=t.charAt(i-1)==n.charAt(r-1)?u[i-1][r-1]:Math.min(u[i-1][r-1]+1,Math.min(u[i][r-1]+1,u[i-1][r]+1));return u[t.length][n.length]}function gt(n,t){return n&&(n=n.toLowerCase()),t&&(t=t.toLowerCase()),nt(n,t)}function ti(n,t){if(!n.th)switch(t){case r.LocalMedia:case i.File:case i.PathCompletion:case i.Email:return!0}return!1}function ri(n){switch(n.type){case i.File:case i.Folder:case i.Music:case i.Photo:case i.Video:case i.Email:case i.PathCompletion:return!0;default:return!1}}function ii(n){return n.deviceItem?n.type+"\t"+n.deviceItem.id:n.type+"\t"+n.query}function c(n){return wt.indexOf(n.type)>=0}function tt(n){return pt.indexOf(n.type)>=0}function dt(n){return bt.indexOf(n.type)>=0}function kt(n){return n.kind=="Modern Setting"}function ui(n){return c(n)?n.deviceItem:null}function li(n){return n.handoffType==5?null:n.type==i.Email?null:n.deviceItem}function ci(n){switch(n.type){case i.File:case i.Folder:case i.Photo:case i.Video:case i.Music:return n.deviceItem}return null}function ai(n){return n.handoffType==5&&n.type!=e.Cat1_VCD?n.deviceItem:null}function yi(n){return n.type==i.Email?n.deviceItem:null}function vi(n){return n.type==i.CommandLine?n.deviceItem:null}function ei(n){return n.type==i.PathCompletion?n.deviceItem:null}function fi(n){var i,r;if(!t.prefixesToScope){t.prefixesToScope={};for(i in t.ScopeConfig)r=t.ScopeConfig[i],oi(i,r,n)&&r.prefixes.forEach(function(n){return t.prefixesToScope[n]=parseInt(i)})}}function oi(i,r,u){var f={};return(Object.keys(u.disabledProviderResponses).forEach(function(n){return f[n]=u.disabledProviderResponses[n]}),t.isBingEnabledCache||(f[n.WebResponseType]=!0),r.enabledProviderResponses&&r.enabledProviderResponses.every(function(n){return f[n.responseType]}))?!1:!0}function hi(u,f){var o,s,a,l,h,c;if(fi(f),o=n.parseQuery(u.queryText,u.cursorPosition),o.impressionId=u.impressionId,o.fullPartialQuery=o.queryToFetch,s=o.fullPartialQuery?o.fullPartialQuery.toLowerCase():o.fullPartialQuery,a=n.isResponseTypeEnabled(i.PathCompletion,null,f)?g.test(s):!1,a)o.scope=12;else{if(o.disabledProviderResponses.push(i.PathCompletion),o.scope=0,s)for(l in t.prefixesToScope)if(h=l+":",s.indexOf(h)==0){o.queryToFetch=o.queryToFetch.substr(h.length),o.cursorPosition=Math.max(0,o.cursorPosition-h.length),n.mantainCursorPositionIn(o.queryToFetch,o.cursorPosition,function(t){return n.cleanQuery(t)},function(n,t){o.queryToFetch=n,o.cursorPosition=t}),o.scope=t.prefixesToScope[l];break}o.isProtocol=it.test(s),o.isProtocol&&(o.fixedUrl=n.fixUrlProtocol(o.fullPartialQuery))}return c=t.ScopeConfig[o.scope],o.enabledProviderResponses=o.queryToFetch?c.enabledProviderResponses:[],o.webResponseNeeded=o.queryToFetch&&c.webResponseNeeded,t.isCortanaEnabledCache||o.disabledProviderResponses.push(r.ReactiveAgents,r.AppRelatedReactiveAgents),t.isBingEnabledCache||(o.webResponseNeeded=!1,o.disabledProviderResponses.push(n.WebResponseType,r.OnlineSuggestionsThatMapToApps,e.SpellCorrectedSetting)),o.equals=function(n){return(o.queryToFetch?o.queryToFetch.toLowerCase():o.queryToFetch)==(n.queryToFetch?n.queryToFetch.toLowerCase():n.queryToFetch)&&n.scope==o.scope},o}function si(n){var t=b(n);if(t==null)throw new Error("Suggestion has no group: "+n.type);else return t}function b(n){if(n.isSynthetic)return null;if(c(n))return 0;if(tt(n))return 1;switch(n.type){case i.CommandLine:return 3;case i.PathCompletion:return 12;case i.Photo:return 4;case i.Video:return 5;case i.Music:return 6;case i.PowerBi:return 13;case i.File:return 7;case i.Folder:return 8;case i.Email:return 9;case e.Store:return 10;default:switch(n.handoffType){case 0:case 1:return 11;case 5:case 6:case 4:return 2}throw new Error("Unexpected handoff type: "+n.handoffType);}}function yt(n){switch(n){case 0:return 0;case 7:return 2;case 9:return 7;case 8:return 6;case 6:return 5;case 4:return 3;case 1:return 1;case 5:return 4;default:return 255}}function ht(){o=0}function d(t){var r,i;return o||(r=_ge("root"),o=r.clientHeight,n.safeExecute(function(){var n=_ge("permanentDisambig").firstChild.offsetHeight;a!=n&&(_ge("container").style.height=o-n+"px",a=n)},"getting permanent disambig height")),i=o-t.numberOfTopResultsNonAnswer2lines*ct-t.numberOfTopResultsNonAnswer3lines*vt-t.numberOfTopResultAnswers*at-t.numberOfGroups*lt-t.numberOfSuggestions*p-a}function et(n){for(var r={numberOfTopResultsNonAnswer2lines:n.numberOfTopResultsNonAnswer2lines,numberOfTopResultsNonAnswer3lines:n.numberOfTopResultsNonAnswer3lines,numberOfTopResultAnswers:n.numberOfTopResultAnswers,numberOfGroups:0,numberOfSuggestions:0},u,i=n.numberOfGroups+1;;++i)if(r.numberOfGroups=i-n.numberOfGroups,r.numberOfSuggestions=n.numberOfSuggestions+r.numberOfGroups*t.MinimumNumberOfSuggestionsPerGroup,u=d(r),u<0)return i-1;return 0}function ot(n){var t=d(n);return t>=p}function rt(n,t){return(n+"\t"+t).toLowerCase()}function st(n){return n||(n=new Date),Math.round(n.getTime()/1e3)}function ft(n,t){var u,r,i,e,f;if(!n)return!0;if(!t)return!1;for(u=n.split("."),r=t.split(".");u.length>r.length;)r.push("0");for(i=0;i<u.length;++i){if(e=r[i],f=u[i],e<f)return!1;if(e>f)return!0}return!0}function ut(n,t,i,r,u,f,e,o,s,h,c,l,a,v){return{text:n,secondaryText:t,getIcon:r,icon:u,topResultPrimaryTextClass:null,secondaryTextClass:i,type:f,dataPartnerTag:o,query:e,id:l,click:a,handoffType:c,instItem:s,additionalInfoText:h,answerHtml:null,isSynthetic:v,selected:!1,canAutocomplete:!v,featureStore:undefined}}var ni,f,r,e,i,w,u,it,g;(function(n){n[n.Apps=0]="Apps",n[n.Settings=1]="Settings",n[n.Cortana=2]="Cortana",n[n.Command=3]="Command",n[n.Photos=4]="Photos",n[n.Videos=5]="Videos",n[n.Music=6]="Music",n[n.Documents=7]="Documents",n[n.Folders=8]="Folders",n[n.Emails=9]="Emails",n[n.Store=10]="Store",n[n.Web=11]="Web",n[n.PathCompletion=12]="PathCompletion",n[n.PowerBi=13]="PowerBi"})(t.GroupType||(t.GroupType={})),ni=t.GroupType,f=function(){function n(){}return n.AppsGroupHeader="GA",n.SettingsGroupHeader="GS",n.PhotosGroupHeader="GP",n.VideosGroupHeader="GV",n.MusicGroupHeader="GM",n.DocumentsGroupHeader="GF",n.FoldersGroupHeader="GFD",n.PathCompletionGroupHeader="GPT",n.EmailsGroupHeader="GE",n.StoreGroupHeader="GT",n.WebGroupHeader="GW",n.PersistentSearchMyStuff="PM",n.PersistentSearchTheWeb="PW",n.TopSearchMyStuff="SM",n.TopSearchTheWeb="SW",n.Protocol="PWL",n.Handoffs=function(){var t={};return t[n.AppsGroupHeader]=4,t[n.SettingsGroupHeader]=4,t[n.PhotosGroupHeader]=4,t[n.VideosGroupHeader]=4,t[n.MusicGroupHeader]=4,t[n.DocumentsGroupHeader]=4,t[n.FoldersGroupHeader]=4,t[n.PathCompletionGroupHeader]=4,t[n.EmailsGroupHeader]=4,t[n.StoreGroupHeader]=3,t[n.WebGroupHeader]=0,t[n.PersistentSearchMyStuff]=4,t[n.PersistentSearchTheWeb]=0,t[n.TopSearchMyStuff]=4,t[n.TopSearchTheWeb]=0,t[n.Protocol]=1,t}(),n.Groups=function(){var t={};return t[n.AppsGroupHeader]=104,t[n.SettingsGroupHeader]=104,t[n.PhotosGroupHeader]=104,t[n.VideosGroupHeader]=104,t[n.MusicGroupHeader]=104,t[n.DocumentsGroupHeader]=104,t[n.FoldersGroupHeader]=104,t[n.PathCompletionGroupHeader]=104,t[n.EmailsGroupHeader]=104,t[n.StoreGroupHeader]=104,t[n.WebGroupHeader]=104,t[n.PersistentSearchMyStuff]=101,t[n.PersistentSearchTheWeb]=100,t[n.TopSearchMyStuff]=101,t[n.TopSearchTheWeb]=100,t[n.Protocol]=103,t}(),n}(),t.NonSuggestionQSCodes=f,t.GroupHeaderQSCodes=function(){var n={};return n[0]=f.AppsGroupHeader,n[1]=f.SettingsGroupHeader,n[2]=null,n[3]=null,n[4]=f.PhotosGroupHeader,n[5]=f.VideosGroupHeader,n[6]=f.MusicGroupHeader,n[7]=f.DocumentsGroupHeader,n[8]=f.FoldersGroupHeader,n[9]=f.EmailsGroupHeader,n[10]=f.StoreGroupHeader,n[11]=f.WebGroupHeader,n[12]=f.PathCompletionGroupHeader,n}(),r=function(){function n(){}return n.OnlineSuggestionsThatMapToApps="OSTMA",n.LocalMedia="LM",n.BingContentStore="BCS",n.ReactiveAgents="RAF",n.AppRelatedReactiveAgents="ARAF",n.MRUSignals="MRU",n}(),t.ResponseTypes=r,t.getEditDistance=nt,t.getEditDistanceIgnoreCase=gt,t.isSensitiveResponseType=ti,t.isSensitiveSuggestionType=ri,t.getSuggestionKey=ii,e=function(){function n(){}return n.Store="CS",n.SpellCorrectedApp="QP",n.SpellCorrectedSetting="QS",n.DirectNav="MD",n.Weather="WA",n.LocalCity="LC",n.Cat1_VCD="VCD",n}(),t.OnlineSuggestionTypes=e,i=function(){function n(){}return n.App="PP",n.Setting="ST",n.Music="MU",n.Photo="LI",n.Video="LV",n.File="FL",n.Folder="FD",n.PathCompletion="PT",n.CommandLine="CG",n.Email="LE",n.BCSApp="BQP",n.BCSSetting="BQS",n.Cat1_LaunchApp="ALC",n.PowerBi="PBI",n}(),t.LocalSuggestionTypes=i;var wt=[i.App,i.BCSApp,e.SpellCorrectedApp],pt=[i.Setting,i.BCSSetting,e.SpellCorrectedSetting],bt=[i.Photo,i.Video,i.Music];t.isApp=c,t.isSetting=tt,t.isMedia=dt,t.isModernSetting=kt,t.getAppItem=ui,t.getItemWithFileMetadata=li,t.getFileItem=ci,t.getRafItem=ai,t.getEmailItem=yi,t.getCommandLineItem=vi,t.getPathCompletionItem=ei,w=function(){function n(){}return n.GroupHeader="WNSHED",n.PersistentDisambig="WNSMYS",n}(),t.MyStuffFormCodes=w,function(n){n.GlobalNavButton="&#xE700",n.Wifi="&#xE701",n.Bluetooth="&#xE702",n.QuietHours="&#xE708",n.Airplane="&#xE709",n.ChevronDown="&#xE70D",n.ChevronUp="&#xE70E",n.Edit="&#xE70F",n.Add="&#xE710",n.Cancel="&#xE711",n.More="&#xE712",n.Settings="&#xE713",n.Mail="&#xE715",n.Phone="&#xE717",n.Shop="&#xE719",n.AllApps="&#xE71D",n.Microphone="&#xE720",n.Search="&#xE721",n.Attach="&#xE723",n.Forward="&#xE72A",n.Back="&#xE72B",n.Lock="&#xE72E",n.Blocked="&#xE733",n.FavoriteStar="&#xE734",n.FavoriteStarFill="&#xE735",n.Remove="&#xE738",n.OEM="&#xE74C",n.Delete="&#xE74D",n.Play="&#xE768",n.ChevronLeft="&#xE76B",n.ChevronRight="&#xE76C",n.Emoji2="&#xE76E",n.ContactInfo="&#xE779",n.WindowsLogo="&#xE782",n.Unlock="&#xE785",n.Calendar="&#xE787",n.Financial="&#xE7BB",n.Train="&#xE7C0",n.Flag="&#xE7C1",n.Page="&#xE7C3",n.HalfStarLeft="&#xE7C6",n.HalfStarRight="&#xE7C7",n.Record="&#xE7C8",n.Ferry="&#xE7E3",n.Game="&#xE7FC",n.Car="&#xE804",n.Bus="&#xE806",n.EatDrink="&#xE807",n.Home="&#xE80F",n.IncidentTriangle="&#xE814",n.MapDirections="&#xE816",n.History="&#xE81C",n.Accident="&#xE81F",n.Work="&#xE821",n.Recent="&#xE823",n.MapApp="&#xE828",n.News="&#xE900",n.Help="&#xE897",n.Document="&#xE8A5",n.Folder="&#xE8B7",n.Message="&#xE8BD",n.CalendarDay="&#xE8BF",n.Important="&#xE8C9",n.GotoToday="&#xE8D1",n.Audio="&#xE8D6",n.CellPhone="&#xE8EA",n.Calculator="&#xE8EF",n.Library="&#xE8F1",n.AlarmClock="&#xE919",n.Movies="&#xE8B2",n.FeedbackApp="&#xE939",n.UniversalApp="&#xE8CC",n.ChatBubbles="&#xE8F2",n.Info="&#xE946",n.Health="&#xE95E",n.Dictionary="&#xE82D",n.Sunny="&#xE9BD",n.CloudWeather="&#xE9BE",n.CloudyDay="&#xE9BF",n.PartlyCloudyDay="&#xE9C0",n.PartlyCloudyNight="&#xE9C1",n.ClearNight="&#xE9C2",n.RainShowersDay="&#xE9C3",n.RainDay="&#xE9C4",n.HeavyRainDay="&#xE9C5",n.ThunderstormsDay="&#xE9C6",n.RainSnowDay="&#xE9C7",n.SnowDay="&#xE9C8",n.BlowingSnowDay="&#xE9C9",n.Frigid="&#xE9CA",n.FogDay="&#xE9CB",n.SquallsDay="&#xE9CC",n.DuststormDay="&#xE9CD",n.Precipitation="&#xE9CF",n.StoreLogo="&#xEA96",n.ContactInfoMirrored="&#xEA4A",n.HelpMirrored="&#xEA51",n.DietPlanNotebook="&#xEAC8",n.Running="&#xEADA",n.Trackers="&#xEADF",n.MoreSports="&#xEB22",n.PopularAthletes="&#xEB2B",n.ReminderFill="&#xEB4F",n.Reminder="&#xEB50",n.Ticket="&#xEB54",n.BingLogo="&#xEB6B",n.SkypeLogo="&#xEB6F",n.CortanaNotebook="&#xEB7F",n.ReminderReactivated="&#xEB80",n.Photo2="&#xEB9F",n.Transportation="&#xEBF1",n.MeetingPlanner="&#xEBF2",n.Leisure="&#xEBF3",n.DeliveryTruck="&#xEBF4",n.HomeAutomation="&#xEBF5",n.HeadphoneAudio="&#xEBF6",n.ReminderPerson="&#xEBF7",n.ReminderGroup="&#xEBF8",n.ReminderTime="&#xEBF9",n.ReminderPlace="&#xEBFA",n.ServiceBell="&#xEC1D",n.Commitments="&#xEC4D",n.MusicInCollection="&#xE940",n.MusicInfo="&#xE90B"}(u=t.ClientFontIcons||(t.ClientFontIcons={})),t.ScopeConfig=function(){var t={};return t[0]={prefixes:[],enabledProviderResponses:null,webResponseNeeded:!0,myStuffLocString:"SearchMyStuff",myStuffIcon:u.WindowsLogo,myStuffPivot:""},t[1]={prefixes:["apps","app"],enabledProviderResponses:[{responseType:r.BingContentStore},{responseType:i.App},{responseType:i.BCSApp},{responseType:r.OnlineSuggestionsThatMapToApps}],webResponseNeeded:!0,myStuffLocString:"SearchApps",myStuffIcon:u.AllApps,myStuffPivot:"apps"},t[2]={prefixes:["settings","setting"],enabledProviderResponses:[{responseType:r.BingContentStore},{responseType:i.Setting},{responseType:i.BCSSetting},{responseType:e.SpellCorrectedSetting}],webResponseNeeded:!0,myStuffLocString:"SearchSettings",myStuffIcon:u.Settings,myStuffPivot:"settings"},t[3]={prefixes:["photos","photo","images","image","pictures","picture"],enabledProviderResponses:[{responseType:r.LocalMedia,suggestionIsEnabled:function(n){return n.type==i.Photo}}],webResponseNeeded:!1,myStuffLocString:"SearchPhotos",myStuffIcon:u.Photo2,myStuffPivot:"pictures"},t[4]={prefixes:["videos","video","movies","movie","films","film"],enabledProviderResponses:[{responseType:r.LocalMedia,suggestionIsEnabled:function(n){return n.type==i.Video}}],webResponseNeeded:!1,myStuffLocString:"SearchVideos",myStuffIcon:u.Movies,myStuffPivot:"videos"},t[5]={prefixes:["music","songs","song"],enabledProviderResponses:[{responseType:r.LocalMedia,suggestionIsEnabled:function(n){return n.type==i.Music}}],webResponseNeeded:!1,myStuffLocString:"SearchMusic",myStuffIcon:u.Audio,myStuffPivot:"music"},t[6]={prefixes:["documents","document","docs","doc"],enabledProviderResponses:[{responseType:i.File,suggestionIsEnabled:function(n){return n.type==i.File}}],webResponseNeeded:!1,myStuffLocString:"SearchDocuments",myStuffIcon:u.Document,myStuffPivot:"files"},t[7]={prefixes:["files","file"],enabledProviderResponses:[{responseType:i.File,suggestionIsEnabled:function(n){return n.type==i.File}},{responseType:r.LocalMedia}],webResponseNeeded:!1,myStuffLocString:"SearchFiles",myStuffIcon:u.WindowsLogo,myStuffPivot:""},t[8]={prefixes:["folders","folder"],enabledProviderResponses:[{responseType:i.File,suggestionIsEnabled:function(n){return n.type==i.Folder}}],webResponseNeeded:!1,myStuffLocString:"SearchFolders",myStuffIcon:u.Folder,myStuffPivot:"folders"},t[9]={prefixes:["emails","email"],enabledProviderResponses:[{responseType:i.Email}],webResponseNeeded:!1,myStuffLocString:"SearchEmails",myStuffIcon:u.Mail,myStuffPivot:"emails"},t[10]={prefixes:["mystuff","device"],enabledProviderResponses:[{responseType:r.BingContentStore},{responseType:i.App},{responseType:i.BCSApp},{responseType:r.OnlineSuggestionsThatMapToApps},{responseType:i.Setting},{responseType:i.BCSSetting},{responseType:e.SpellCorrectedSetting},{responseType:r.LocalMedia},{responseType:i.File},{responseType:i.PathCompletion},{responseType:i.Email},{responseType:r.ReactiveAgents},{responseType:n.WebResponseType,suggestionIsEnabled:function(n){return n.handoffType==4||n.handoffType==5}}],webResponseNeeded:!0,myStuffLocString:"SearchMyStuff",myStuffIcon:u.WindowsLogo,myStuffPivot:""},t[11]={prefixes:["web","bing"],enabledProviderResponses:[{responseType:n.WebResponseType,suggestionIsEnabled:function(n){return n.handoffType==6||n.handoffType==0||n.handoffType==1}}],webResponseNeeded:!0,myStuffLocString:null,myStuffIcon:null,myStuffPivot:null},t[12]={prefixes:[],enabledProviderResponses:[{responseType:i.PathCompletion},{responseType:i.CommandLine},],webResponseNeeded:!1,myStuffLocString:"SearchMyStuff",myStuffIcon:u.WindowsLogo,myStuffPivot:""},t}(),t.prefixesToScope,it=/^https?:|^www\.|^\/+/,g=/^[a-z]:\\|^%[^%]+%\\|^\\/,t.isCortanaEnabledCache=CortanaApp.isCortanaEnabled,t.isBingEnabledCache=CortanaApp.isBingEnabled,t.isMyStuffEnabled=!CortanaApp.isMobile,t.regionCache=CortanaApp.region,t.uiLanguageCache=CortanaApp.uiLanguage,t.parseQuery=hi,t.CssClass_Annotation="annotation",t.CssClass_Action="action",t.getGroupType=si,t.tryGetGroupType=b,t.getSectionType=yt,t.MinimumNumberOfSuggestionsPerGroup=3,t.IconSize_SingleLineSuggestion=16,t.IconSize_Suggestion=16,t.IconSize_TopResult=32;var k=8,s=12,y=3,l=1,h=20,v=16,p=h+2*k,lt=v+2*k,ct=h+v+y+l+2*s,vt=h+2*(v+y)+l+2*s,at=80+2*s,a=h+2*s+l,o=0;t.resetPaneSizeCaches=ht,t.getMaxNumberOfGroups=et,t.canFitSuggestion=ot,t.getEngagementSignalKey=rt,t.getUnixTime=st,t.compliesWithMinVersion=ft,t.createSuggestion=ut})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var r,i;(function(t){function s(t,i,r,u,f,e){try{var o,h=function(i){o&&f.unregister(o),n.reportException(i,t,e),u&&u(i)},s=i();f&&(o=f.register(function(){return n.safeExecute(function(){return s.cancel()},t+" cancellation")})),s.done(function(i){o&&f.unregister(o),n.safeExecute(function(){return r(i)},t+" completion")},h)}catch(c){h(c)}}function o(n,i,r){var o,s,e,u=[],f=function(n){o=n,e=!0,u.forEach(function(t){return t(n)}),u=null};return function(h){e?h(o):(u.push(h),s||(s=!0,t.safeChain(n,function(){return i()},function(n){return f(r?r(n):n)},function(){return f(null)})))}}function r(t,i,r,u){i.completed=!0,i.result=r,i.pendingCallbacks.forEach(function(t){return n.safeExecute(function(){return t(r)},u)}),i.pendingCallbacks=null}function e(){i={}}function u(){var t=[],n;for(n in i)i[n].completed||t.push(n);t.forEach(function(n){return delete i[n]})}function f(u,f,e,o,s,h){return function(c,l){var v=e(c),a=i[v];a||(a={started:!1,completed:!1,result:null,pendingCallbacks:[]},i[v]=a),a.completed?l(a.result):(a.pendingCallbacks.push(l),a.started||(a.started=!0,t.safeChain(u,function(){return f(c)},function(n){return r(v,a,o?o(n):n,u)},function(t){n.isCancellation(t)?r(v,a,null,u):r(v,a,s,u)},null,h)))}}t.safeChain=s,t.safeChainWithCaching=o;var i={};t.clearGlobalCache=e,t.clearPendingItemsFromCache=u,t.safeChainWithGlobalCaching=f})(r=t.Promise||(t.Promise={})),function(n){function t(n,t,i){var f={},e,r,u;for(e in n)r=n[e],u=t[r],u&&(f[r]=i(u));return f}n.map=t}(i=t.Map||(t.Map={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){function e(n,t,r,u){typeof indexedDB!="undefined"&&new i(n,u,t,r)}function f(n,t,r,u){typeof indexedDB!="undefined"&&new i(n,u,t,r)}function s(n,t,r,u,f){typeof indexedDB!="undefined"&&new i(n,f,t,r,u)}function r(n,t,r,u,f){typeof indexedDB!="undefined"&&new i(n,f,t,r,u)}function u(t){n.safeExecute(function(){return indexedDB.deleteDatabase(t)},"delete "+t)}var o=function(){function n(){}return n.ConnectionNotEstablished="X",n.ErrorWhenQueryingDb="E",n.QuerySucceeded="R",n}(),i;t.StorageState=o,t.instanceWithNumberKeys=e,t.instanceWithStringKeys=f,t.instanceWithNumberKeysAndSecondaryKey=s,t.instanceWithStringKeysAndSecondaryKey=r,t.deleteInstance=u,i=function(){function n(n,t,i,r,u){var f=this;this.database=null,this.closed=!1,this.safeExecute(function(){f.databaseName=n,f.storeName=n+"Store",f.secondaryIndex=u;var e;try{e=indexedDB.open(n,t||1)}catch(o){r(new Error("IndexedDbClientSideStorage.const: Could not open database"));return}e.onsuccess=function(n){f.database=n.target.result,i&&i(f)},e.onupgradeneeded=function(n){var t=n.target.result,i;t.objectStoreNames.contains(f.storeName)&&t.deleteObjectStore(f.storeName),i=t.createObjectStore(f.storeName),f.secondaryIndex&&i.createIndex(f.secondaryIndex,f.secondaryIndex,{unique:!1})},e.onerror=function(t){indexedDB.deleteDatabase(n),f.handleErrorEvent("openDbRequest.onerror",r)(t)},e.onblocked=f.handleErrorEvent("openDbRequest.onblocked",r)},r,!0)}return n.prototype.put=function(n,t,i,r){var u=this;this.safeExecute(function(){var e=u.database.transaction(u.storeName,"readwrite").objectStore(u.storeName),f=e.put(t,n);f.onsuccess=i,f.onerror=u.handleErrorEvent("putRequest.onerror",r)},r)},n.prototype.putMultiple=function(n,t,i){var r=this;this.safeExecute(function(){var e=r.database.transaction(r.storeName,"readwrite").objectStore(r.storeName),u=0,f=function(){if(u<n.length){var o=e.put(n[u].value,n[u].key);u+=1,o.onsuccess=u==n.length-1?t:f,o.onerror=r.handleErrorEvent("putRequest.onerror",i)}};f()},i)},n.prototype.getValue=function(n,t,i){var r=this;this.safeExecute(function(){var f=r.database.transaction(r.storeName,"readonly").objectStore(r.storeName),u=f.get(n);u.onsuccess=function(n){var i=n.target.result;t(i)},u.onerror=r.handleErrorEvent("getRequest.onerror",i)},i)},n.prototype.getRange=function(n,t,i,r){var u=this;this.safeExecute(function(){var o=u.database.transaction(u.storeName,"readonly").objectStore(u.storeName),e=IDBKeyRange.bound(n,t,!1,!0),f=o;u.parseOpenCursorRequest(f.openCursor(e),i,r)},r)},n.prototype.getRangeOnSecondaryKey=function(n,t,i,r){var u=this;this.safeExecute(function(){var e=u.database.transaction(u.storeName,"readonly").objectStore(u.storeName),o=IDBKeyRange.bound(n,t,!1,!0),f;u.secondaryIndex?(f=e.index(u.secondaryIndex),u.parseOpenCursorRequest(f.openCursor(o),i,r)):r(new Error("getRangeOnSecondaryKey: Index name is missing"))},r)},n.prototype.remove=function(n,t,i){var r=this;this.safeExecute(function(){var e=r.database.transaction(r.storeName,"readwrite").objectStore(r.storeName),u=0,f=function(){if(u<n.length){var o=e["delete"](n[u]);o.onsuccess=u==n.length-1?t:f,o.onerror=r.handleErrorEvent("removeRequest.onError",i)}};f()},i)},n.prototype.getAll=function(n,t){var i=this;this.safeExecute(function(){var r=i.database.transaction(i.storeName,"readonly").objectStore(i.storeName);i.parseOpenCursorRequest(r.openCursor(),n,t)},t)},n.prototype.close=function(){this.closed=!0,this.database&&(this.database.close(),this.database=null)},n.prototype.isClosed=function(){return this.closed},n.prototype.parseOpenCursorRequest=function(n,t,i){var r=[];n.onsuccess=function(n){var i=n.target.result;if(!i){t(r);return}r.push({key:i.primaryKey,value:i.value}),i["continue"]()},n.onerror=this.handleErrorEvent("openCursorRequest.onError",i)},n.prototype.safeExecute=function(n,t,i){try{i||this.database?n():this.reportError(t,"Database not initialized")}catch(r){this.reportError(t,r.message)}},n.prototype.handleErrorEvent=function(n,t){var i=this;return function(r){var u=n;try{u+=" "+r.target.error.name}catch(f){}i.reportError(t,u)}},n.prototype.reportError=function(n,t){var i=new Error(t);n(i)},n}()})(t=n.ClientSideStorage||(n.ClientSideStorage={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var r=100,i=function(){function i(n,t,i,r,u,f,e){var o=this;this._storageOpenInProgress=!1,this._pendingQueries=[],this._config=n,this._storageFactory=t,this._createResponse=i,this._dataPopulated=r,this._getProviderState=u,this._responseType=f,e?(e.bindAppVisible(function(){return o.initStorage()}),e.bindDismissed(function(){return o._pendingQueries=[]}),e.bindAppHidden(function(){return o.teardownStorage()})):this.initStorage()}return i.prototype.teardownStorage=function(){this._storage&&(this._storage.close(),this._storage=null)},i.prototype.initStorage=function(){var n=this;!this._storageOpenInProgress&&this._dataPopulated()&&(this._storageOpenInProgress=!0,this._storageFactory(function(t){n._storage=t,n._storageOpenInProgress=!1,n._pendingQueries.forEach(function(n){return n()}),n._pendingQueries=[]},function(t){n.onError(t,"open "+n._responseType+" storage");n._storageOpenInProgress=!1,n._pendingQueries.forEach(function(n){return n()}),n._pendingQueries=[]}))},i.prototype.onError=function(t,i){var r=this;n.reportException(t,i),this.teardownStorage(),setTimeout(function(){return r.initStorage()},0)},i.prototype.reloadStorage=function(){this.teardownStorage(),this.initStorage()},i.prototype.isReady=function(){return!!this._storage},i.prototype.fetch=function(i,r,u,f,e){var s=this,o;n.isResponseTypeEnabled(this._responseType,i,this._config)&&(o=function(n,t){e()&&r(s._responseType,s._createResponse(i,n),s._getProviderState(t))},this.queryStorage(i,function(n){return o(n,t.StorageState.QuerySucceeded)},function(){return o(null,t.StorageState.ErrorWhenQueryingDb)},function(){return o(null,t.StorageState.ConnectionNotEstablished)}))},i.prototype.withStorage=function(n){this._storage&&n(this._storage)},i.prototype.queryStorage=function(n,t,i,u){var e=this,o=null,f=!1,s=function(){f||(f=!0,o&&clearTimeout(o),e._storage?e._storage.getValue(n.queryToFetch,function(n){return t(n)},function(n){e.onError(n,"query "+e._responseType);i()}):u())};this._storage?s():(this.initStorage(),this._storageOpenInProgress?(this._pendingQueries.push(s),o=setTimeout(function(){f||(f=!0,u())},r)):u())},i}();t.StorageBasedDataProvider=i})(t=n.ClientSideStorage||(n.ClientSideStorage={}))})(AutoSuggest||(AutoSuggest={}));var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},AutoSuggest;(function(n){var t;(function(t){var u="mruWithIndex",r="LastUpdated",i=function(i){function f(f,e,o,s){var h=this;e&&e(function(n,t,i){return h.onLaunch(n,t,i)});var a=function(n,t){return o(u,function(t){n(t),h.prune(function(){})},t,r)},v=function(n,t){return h._queryBuffer=n,h._responseBuffer=t,t},c=function(){return!0},l=function(t){return t==n.ClientSideStorage.StorageState.QuerySucceeded?undefined:t};i.call(this,f,a,v,c,l,t.ResponseTypes.MRUSignals,s)}return __extends(f,i),f.prototype.onLaunch=function(t,i,r){var f=this,u=r?r[n.WebResponseType]:null;this.isLastHit(i)?this.updateAndSaveConditionalLaunch(i,this._responseBuffer,t,u):this.queryStorage(i,function(n){return f.updateAndSaveConditionalLaunch(i,n,t,u)},function(){},function(){})},f.updateLaunchData=function(n,i,r){var f=t.getSuggestionKey(r),u;return i?(i.PrefixSuggestions||(i.PrefixSuggestions={}),u=i):u={PrefixSuggestions:{},LastUpdated:t.getUnixTime()},u.PrefixSuggestions[f]?(u.PrefixSuggestions[f].prefixLaunchCount+=1,u.PrefixSuggestions[f].lastLaunchTime=t.getUnixTime()):u.PrefixSuggestions[f]={prefixLaunchCount:1,lastLaunchTime:t.getUnixTime()},u},f.prototype.updateAndSaveConditionalLaunch=function(i,r,u,e){var h=this,s=f.updateLaunchData(i,r,u),o,c;s.RankingSignals=e,o=new Date,o.setDate(o.getDate()-180),c=t.getUnixTime(o),s.LastUpdated=t.getUnixTime(),f.removeOldLaunches(s,c),this.withStorage(function(t){return t.put(i.fullPartialQuery,s,function(){},function(t){h._queryBuffer=null,h._responseBuffer=null,n.reportException;h.onError(t,"MRUDataProvider put")})})},f.removeOldLaunches=function(n,t){var r=Object.keys(n.PrefixSuggestions),i;for(i in r)n.PrefixSuggestions[r[i]].lastLaunchTime&&n.PrefixSuggestions[r[i]].lastLaunchTime<t&&delete n.PrefixSuggestions[r[i]]},f.prototype.prune=function(n){var u=this,i=new Date,r,f;i.setDate(i.getDate()-180),r=t.getUnixTime(i),f=String(r),this.withStorage(function(r){return r.getRangeOnSecondaryKey(0,t.getUnixTime(i),function(t){return r.remove(t.map(function(n){return n.key}),n,function(n){return u.onError(n,"MRUDataProvider remove")})},function(n){return u.onError(n,"MRUDataProvider getRange")})})},f.prototype.isLastHit=function(n){return this._queryBuffer?n.fullPartialQuery==this._queryBuffer.fullPartialQuery:!1},f}(n.ClientSideStorage.StorageBasedDataProvider);t.MRUDataProvider=i})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var i;(function(i){var r=function(){function i(){this._countTasks=0,this._numTasks=-1,this._partialChunkFromPreviousBatch="",this._taskCache={},this._version=-1,this._prefixCount=-1}return i.prototype.getVersion=function(){return this._version},i.prototype.getPrefixCount=function(){return this._prefixCount},i.prototype.parse=function(n){return this.parseLines(this.splitToCompleteData(n))},i.prototype.flush=function(){return this._partialChunkFromPreviousBatch?this.parseLines([this._partialChunkFromPreviousBatch]):[]},i.prototype.splitToCompleteData=function(n){if(n.length>0){var t=n.split("\n").map(function(n){return n.trim()});return t.length>0&&(t[0]=this._partialChunkFromPreviousBatch+t[0],this._partialChunkFromPreviousBatch=t.pop()),t}return[]},i.prototype.parseLines=function(t){for(var s=[],r,f,o,h,e,u=0;u<t.length;u++){if(r=n.safeExecute(function(){return JSON.parse(t[u])},"BCSParser JSON.parse",null,t[u]),!r)return null;if(this._numTasks==-1)if(f=i.unpackContentHeader(r),f)this._numTasks=f.taskCount,this._version=f.version,this._prefixCount=f.prefixCount;else return n.reportException(new Error("Malformed BCS header"),"BCSParser unpackContentHeader",t[u]),null;else this._countTasks<this._numTasks?(this._countTasks++,o=i.unpackTask(r),o&&(h=Object.keys(r)[0],this._taskCache[+h]=o)):(e=i.unpackPrefix(r,this._taskCache),e&&s.push(e))}return s},i.unpackTask=function(n){var r=Object.keys(n)[0],t=n[r],i;return t&&t.length==2?i={id:t[0],type:parseInt(t[1])}:null},i.unpackPrefix=function(n,t){var o=Object.keys(n)[0],u=n[o],e={prefix:o,tasks:[],suppressions:[],engagementSignals:{}},r,f;if(u.TSK)for(r=0;r<u.TSK.length;r++)f=u.TSK[r],f in t&&e.tasks.push(t[f]);if(u.SUP)for(r=0;r<u.SUP.length;r++)f=n[o].SUP[r],f in t&&e.suppressions.push(t[f]);return u.LL&&(e.engagementSignals=i.unPackSignal(u.LL)),e},i.unPackSignal=function(n){for(var e={},i,f,u,r=0;r<n.length;r++)i=n[r],i.length==3&&(f=t.getEngagementSignalKey(i[0],String(i[1])),u={SuggestionGroup:i[1],ProbSugClickGivenPref:i[2]},e[f]=u);return e},i.unpackContentHeader=function(n){return n.length==3?{version:parseInt(n[0]),taskCount:parseInt(n[1]),prefixCount:parseInt(n[2])}:null},i}();i.BCSParser=r})(i=t.Bcs||(t.Bcs={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var i;(function(i){var f=65536,u=500,r=function(){function i(n,i,r,u,f,e){var o=this;this._bcsDataReader=i,this._parser=r,this._rowsToSkip=u,this._onLoadingStopped=e,this._progress=u,t.Promise.safeChain("bcsDataReader.tryOpenFileAsync",function(){return i.tryOpenFileAsync(n)},function(n){n?f(function(n){o._storage=n,setTimeout(function(){return o.loadBatch()},0)}):o.close()},function(){return o.close()})}return i.prototype.cancel=function(){this._cancelRequested=!0},i.prototype.loadBatch=function(){var n=this;if(this._cancelRequested){this.close();return}t.Promise.safeChain("bcsDataReader.loadAsync",function(){return n._bcsDataReader.loadAsync(f)},function(t){if(t<=0){n.addToDatabase(n._parser.flush(),function(){return n.close()});return}if(n._cancelRequested){n.close();return}var i=n._bcsDataReader.readString(t);n.addToDatabase(n._parser.parse(i),function(){return n.loadBatch()})},function(){return n.close()})},i.prototype.addToDatabase=function(t,i){var r=this,f;if(!t){this.close();return}this._rowsToSkip&&(t.length>this._rowsToSkip?(t=t.slice(this._rowsToSkip),this._rowsToSkip=0):(this._rowsToSkip-=t.length,t=[])),t.length>0?(f=t.map(function(n){return{key:n.prefix,value:n}}),this._storage.putMultiple(f,function(){if(r._progress+=f.length,r._cancelRequested){r.close();return}setTimeout(function(){return i()},u)},function(t){n.reportException(t,"BCSDataLoader addToDatabase"),r.close()})):i()},i.prototype.close=function(){this._bcsDataReader&&(this._bcsDataReader.close(),this._bcsDataReader=null),this._storage=null,this._onLoadingStopped&&(this._onLoadingStopped(this._progress),this._onLoadingStopped=null)},i}();i.BCSDataLoader=r})(i=t.Bcs||(t.Bcs={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var i;(function(i){var s="BingClientStore",l="BingClientStore2",h="bcs_population_status",f=" ",o=2,e=function(){function n(){}return n.Populated="P",n.NotPopulated="X",n}(),u=function(){function n(){}return n.LoadingFromClient="C",n.LoadingFromServer="S",n.NotLoading="X",n}(),a=e.Populated+u.NotLoading+n.ClientSideStorage.StorageState.QuerySucceeded,r=function(){function n(){}return n.Start="S",n.Pause="P",n.Resume="R",n.Complete="C",n.Active="A",n.Inactive="I",n}(),c=function(){function c(n,t,i,r,u,f,e){var o=this;this._status=null,this._allowPopulation=!1,this._config=n,this._clientSideStorageFactory=t,this._bcsDataReader=i,this._lightweightStorage=r,this._onDataPopulated=u,this._instrumentationHelper=e,f?(f.bindConversationStart(function(){o._allowPopulation=!0,o.checkStatus()}),f.bindDismissed(function(){o._allowPopulation=!1,o._loader&&o._loader.cancel()})):this.checkStatus()}return c.prototype.dbPopulatedForCurrentLanguage=function(){if(!this._status)return!1;var n=this.getActiveDb();return this.isFullyPopulated(n)&&n.language==t.uiLanguageCache.toLowerCase()},c.prototype.getProviderState=function(n){var i=this.dbPopulatedForCurrentLanguage()?e.Populated:e.NotPopulated,r=this._dbBeingPopulated?this._dbBeingPopulated.source==0?u.LoadingFromClient:u.LoadingFromServer:u.NotLoading,t=i+r+n;return t==a?undefined:t},c.prototype.getActiveBCSStorage=function(n,t){this.getStorage(n,t,this.getActiveDb(),!0)},c.prototype.getActiveDb=function(){return this._status.activeDb==this._status.dbA.name?this._status.dbA:this._status.dbB},c.prototype.getInactiveDb=function(){return this._status.activeDb==this._status.dbA.name?this._status.dbB:this._status.dbA},c.prototype.resetDbStatus=function(n){n.version=-1,n.language=null,n.source=null,n.populatedRecords=0,n.totalRecords=-1,n.schemaVersion=n.schemaVersion?n.schemaVersion+1:1},c.prototype.deleteDb=function(t){this.resetDbStatus(t),n.ClientSideStorage.deleteInstance(t.name),t.schemaVersion=0},c.prototype.isFullyPopulated=function(n){return n.totalRecords>0&&n.populatedRecords==n.totalRecords},c.prototype.isPopulationInProgress=function(n){return n.totalRecords>0&&n.populatedRecords>0&&n.populatedRecords<n.totalRecords},c.prototype.checkStatus=function(){var e,c,i,f,u;this._loader||(this._status||(e=this._lightweightStorage()[h],e&&(c=n.safeExecute(function(){return JSON.parse(e)},"parse BCS metadata"),c.schemaVersion==o&&(this._status=c)),!this._status&&this._allowPopulation&&(this._status={dbA:{name:s},dbB:{name:l},activeDb:s,schemaVersion:o},this.resetDbStatus(this._status.dbA),this.resetDbStatus(this._status.dbB),this.saveStatus())),this._allowPopulation)&&(i=this.getActiveDb(),f=t.uiLanguageCache.toLowerCase(),this.isFullyPopulated(i)?(u=this.getInactiveDb(),this.isPopulationInProgress(u)&&u.language==f?(this.instrument(u,r.Resume),this.load(u)):(i.version<this._config.serverBcsVersion||i.language!=f)&&this._config.serverBcsSupportedMarkets[f]&&(this.resetDbStatus(u),u.version=this._config.serverBcsVersion,u.source=1,u.language=f,this.instrument(u,r.Start),this.saveStatus(),this.load(u))):this.isPopulationInProgress(i)&&i.language==f?(this.instrument(i,r.Resume),this.load(i)):f=="en-us"?(this.resetDbStatus(i),i.source=0,i.language=f,this.instrument(i,r.Start),this.saveStatus(),this.load(i)):this._config.serverBcsSupportedMarkets[f]&&(this.resetDbStatus(i),i.version=this._config.serverBcsVersion,i.source=1,i.language=f,this.instrument(i,r.Start),this.saveStatus(),this.load(i)))},c.prototype.saveStatus=function(){this._lightweightStorage()[h]=JSON.stringify(this._status)},c.prototype.getStorage=function(n,t,i,r){var e=this,u=function(n){r&&(e.deleteDb(i),e.saveStatus(),setTimeout(function(){return e.checkStatus()},0)),t(n)};if(r&&!this.isFullyPopulated(i))return t(new Error("Tried to open unpopulated db: "+i.name)),null;this._clientSideStorageFactory(i.name,function(t){r?t.getValue(f,function(r){r&&r.prefix==f&&r.count==i.totalRecords?n(t):(t.close(),u(new Error("Not all records present")))},function(n){t.close(),u(n)}):n(t)},u,i.schemaVersion)},c.prototype.load=function(t){var u=this,s=new i.BCSParser,o,e=function(){o&&o.close(),u._dbBeingPopulated=null,u._loader=null},c=function(i){u.getStorage(function(n){o=n,i(n)},function(i){n.reportException(i,"open "+t.name+" db"),e(),setTimeout(function(){return u.checkStatus()},0)},t,!1)},h=function(i){var c,h;if(t.populatedRecords==i){u.instrument(t,r.Pause),e();return}c={prefix:f,engagementSignals:null,tasks:[],suppressions:[],count:i},t.populatedRecords=i,t.totalRecords=s.getPrefixCount(),t.source==0&&(t.version=s.getVersion()),u.isFullyPopulated(t)?(h=u.dbPopulatedForCurrentLanguage(),u.instrument(t,r.Complete),u._status.activeDb=t.name,u.saveStatus(),o.put(f,c,function(){n.safeExecute(function(){return u._bcsDataReader.cleanupFilesAsync()},"cleanupFilesAsync"),e(),h||u._onDataPopulated(),setTimeout(function(){return u.checkStatus()},0)},function(t){n.reportException(t,"saving BCS populated records count"),e()})):(u.instrument(t,r.Pause),u.saveStatus(),e())};this._dbBeingPopulated=t,this._loader=new i.BCSDataLoader(this.getUrl(t),this._bcsDataReader,s,t.populatedRecords,c,h)},c.prototype.getUrl=function(n){return n.source==0?"http://BuiltInBcs":_w.location.protocol+"//"+_w.location.host+"/bcs/"+n.version+"/"+n.language+".js"},c.prototype.instrument=function(n,t){if(this._instrumentationHelper){var i=(n.source==0?u.LoadingFromClient:u.LoadingFromServer)+(n.version==-1?"":n.version);t+=this._status.activeDb==n.name?r.Active:r.Inactive,this._instrumentationHelper.instrumentBcsPopulationEvent(i,t)}},c}();i.BCSPopulationManager=c})(i=t.Bcs||(t.Bcs={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},AutoSuggest;(function(n){var t;(function(t){var i;(function(i){i.appLimits={maxUpTo3chars:2,maxAfter3chars:4,maxAfter8chars:9},i.settingLimits={maxUpTo3chars:3,maxAfter3chars:5,maxAfter8chars:11};var r=function(r){function u(n,f,e,o){var a=this,v=function(){return _w.localStorage},y=function(){return a.reloadStorage()},s=new i.BCSPopulationManager(n,f,CortanaApp.bcsDataReader,v,y,e,o),c=function(n,t){return s.getActiveBCSStorage(n,t)},l=function(){return s.dbPopulatedForCurrentLanguage()},h=function(n){return s.getProviderState(n)};r.call(this,n,c,u.createBcsResponse,l,h,t.ResponseTypes.BingContentStore,e)}return __extends(u,r),u.getMaxSuggestions=function(n,t,i){return t!=0&&t!=10?i.maxAfter8chars:n.length>8?i.maxAfter8chars:n.length>3?i.maxAfter3chars:i.maxUpTo3chars},u.createBcsResponse=function(t,r){return r?n.safeExecute(function(){for(var c=[],h=[],a=u.getMaxSuggestions(t.queryToFetch,t.scope,i.appLimits),v=u.getMaxSuggestions(t.queryToFetch,t.scope,i.settingLimits),e,o,s,f,l,n=0;n<r.suppressions.length;n++)e=r.suppressions[n],e.type==1?c.push(e.id):h.push(e.id);for(o=[],s=[],n=0;n<r.tasks.length;n++)f=r.tasks[n],f.type==1?o.length<a&&c.indexOf(f.id)<0&&o.push(f.id):s.length<v&&h.indexOf(f.id)<0&&s.push(f.id);return l={appIds:o,settingIds:s,suppressedAppIds:c,suppressedSettingIds:h,engagementSignals:r.engagementSignals}},"createBcsResponse"):{appIds:[],settingIds:[],suppressedAppIds:[],suppressedSettingIds:[],engagementSignals:{}}},u}(n.ClientSideStorage.StorageBasedDataProvider);i.BCSDataProvider=r})(i=t.Bcs||(t.Bcs={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){function i(n,i,r,u,f){var o="getIcon "+r,e=t.isSensitiveResponseType(n,r)?null:i.id,h=t.Promise.safeChainWithGlobalCaching(o,function(n){return i.getImageAsync(n?t.IconSize_TopResult:t.IconSize_Suggestion)},function(n){return(n?"T_":"S_")+i.id},function(n){return t.toIcon(n,o,u,f,e)},{content:u,type:1},e);return{deviceItem:i,getIcon:h}}function u(n,t,i){i===void 0&&(i=!0);return{deviceItem:n,icon:{content:t,type:i?1:0}}}function e(n,i,r,u,f,e,o){var h,s,c,l;if(n.length==0)i({});else{for(h={},s=n.slice(0),c=n.length-1;c>=0;--c)l=n[c],o.hasOwnProperty(l)&&(h[l]=o[l],s.splice(c,1));s.length==0?i(h):t.Promise.safeChain(u,function(){return f(s)},function(r){var f=t.Map.map(s,r,function(n){return e(n)}),u;if(s.forEach(function(n){return o[n]=f[n]}),s.length!=n.length)for(u in h)h.hasOwnProperty(u)&&(f[u]=h[u]);i(f)},function(){return i({})},r,s.toString())}}function v(n,i){if(!i.launchArguments||s.test(n.query))return!0;var r=i.id.toLowerCase();return t.BlacklistedSystemCommandsWhenNoArgs.some(function(n){return r.indexOf(n)>=0})?!0:!1}var c={getResultsContainer:function(n){return n.apps},responseType:t.LocalSuggestionTypes.App,maxUpTo3chars:4,maxAfter3chars:7,maxAfter8chars:15,addImage:function(n,r){return i(n,r,t.LocalSuggestionTypes.App,undefined,r.isImmersive?r.logoBackgroundColor:undefined)}},h={getResultsContainer:function(n){return n.settings},responseType:t.LocalSuggestionTypes.Setting,maxUpTo3chars:4,maxAfter3chars:7,maxAfter8chars:15,addImage:function(n,r){return n.showThumbnailsForControlPanelSettings&&!t.isModernSetting(r)?i(n,r,t.LocalSuggestionTypes.Setting,t.ClientFontIcons.Settings):u(r,t.ClientFontIcons.Settings)}},a=[c,h,{getResultsContainer:function(n){return n.media},responseType:t.ResponseTypes.LocalMedia,maxUpTo3chars:7,maxAfter3chars:10,maxAfter8chars:18,addImage:function(n,r){return i(n,r,t.ResponseTypes.LocalMedia)}},{getResultsContainer:function(n){return n.files},responseType:t.LocalSuggestionTypes.File,maxUpTo3chars:7,maxAfter3chars:10,maxAfter8chars:18,addImage:function(n,r){return i(n,r,t.LocalSuggestionTypes.File)}},{getResultsContainer:function(n){return n.powerBi},responseType:t.LocalSuggestionTypes.PowerBi,maxUpTo3chars:4,maxAfter3chars:7,maxAfter8chars:15,addImage:function(n,t){return u(t,"https://pbipmprodbqt1.analysis.windows-int.net/images/PowerBI_Favicon.ico",!1)}},{getResultsContainer:function(n){return n.windowsDeviceSearchEmails},responseType:t.LocalSuggestionTypes.Email,maxUpTo3chars:4,maxAfter3chars:7,maxAfter8chars:15,addImage:function(n,i){return u(i,t.ClientFontIcons.Mail)}},{getResultsContainer:function(n){return n.reactiveAgents},responseType:t.ResponseTypes.ReactiveAgents,maxUpTo3chars:4,maxAfter3chars:7,maxAfter8chars:15,addImage:function(n,t){return u(t,null)}},{getResultsContainer:function(n,t){return CortanaApp.queryFormulationView.startPathCompletionQuery(t.originalQuery,"")},responseType:t.LocalSuggestionTypes.PathCompletion,maxUpTo3chars:15,maxAfter3chars:15,maxAfter8chars:15,addImage:function(n,r){return i(n,r,t.LocalSuggestionTypes.PathCompletion)},customCancellation:function(){return CortanaApp.queryFormulationView.cancelLastPathCompletionQuery()}},{getResultsContainer:function(n,t){return CortanaApp.queryFormulationView.startCommandLineQuery(t.originalQuery,"")},responseType:t.LocalSuggestionTypes.CommandLine,maxUpTo3chars:1,maxAfter3chars:1,maxAfter8chars:1,addImage:function(n,r){return i(n,r,t.LocalSuggestionTypes.CommandLine)},singleItem:!0,customCancellation:function(){return CortanaApp.queryFormulationView.cancelLastCommandLineQuery()}},],r={suggestions:[]},l={},f={},s,o;t.BlacklistedSystemCommands=["\\system32\\user.exe","\\system32\\sidebar.exe","\\system32\\at.exe","\\system32\\change.exe","\\system32\\control.exe","\\system32\\find.exe","\\system32\\net.exe","\\system32\\share.exe","\\system32\\rundll32.exe","\\system32\\append.exe","\\system32\\choice.exe","\\system32\\clip.exe","\\system32\\comp.exe","\\system32\\compact.exe","\\system32\\consent.exe","\\system32\\convert.exe","\\system32\\format.exe","\\system32\\graphics.com","\\system32\\label.exe","\\system32\\mem.exe","\\system32\\mode.com","\\system32\\more.com","\\system32\\recover.exe","\\system32\\replace.exe","\\system32\\reset.exe","\\system32\\shadow.exe","\\system32\\sort.exe","\\system32\\tree.com","\\system32\\webcam.exe","\\system32\\systemsettings.exe","\\system32\\command.com","\\system32\\tabtip.exe","\\system32\\services.exe","\\system32\\help.exe","\\system32\\where.exe","\\system32\\skydrive.exe","\\system32\\calc.exe","\\accessories\\wordpad.exe",],t.BlacklistedSystemCommandsWhenNoArgs=["\\system32\\finger.exe","\\system32\\ping.exe","\\system32\\print.exe","\\system32\\shutdown.exe","\\system32\\expand.exe","\\system32\\tskill.exe","\\system32\\reg.exe","\\system32\\sc.exe",],t.BlacklistedCommands=["uninstall","outlook","excel","skype","nero","onenote","lync","vmware","firefox","itunes","photoshop","print","opera","visio","thunderbird"],s=/[\/\.\-\\]/,t.isRealCommand=v,o=function(){function i(n,t){this._config=n,t.bindAppHidden(function(){l={},f={}})}return i.prototype.fetch=function(i,r,u,f,e){var h=this,c,o,l,s;if(this._config.th&&(c=n.LocalMachineDataMockProvider.getMockedLocalResults(i.queryToFetch),c&&updateMockData(c)),o=a.filter(function(t){return!t.customCancelation&&n.isResponseTypeEnabled(t.responseType,i,h._config)}),o.length>0){if(!i.queryToFetch)throw new Error("Local provider doesn't support empty query");f&&f.register(function(){t.Promise.clearPendingItemsFromCache(),CortanaApp.queryFormulationView.cancelLastDeviceQuery()}),CortanaApp.queryFormulationView.startDeviceQuery?(l=n.safeExecute(function(){return CortanaApp.queryFormulationView.startDeviceQuery(i.queryToFetch)},"startDeviceQuery"),l?this.searchFolders(o,l,i,r,e):this.emptyFetch(o,r)):t.Promise.safeChain("startDeviceQueryAsync",function(){return CortanaApp.queryFormulationView.startDeviceQueryAsync(i.queryToFetch)},function(n){e()&&h.searchFolders(o,n,i,r,e)},function(){return h.emptyFetch(o,r)},f)}if(s=a.filter(function(t){return t.customCancelation&&n.isResponseTypeEnabled(t.responseType,i,h._config)}),s.length>0){if(!i.queryToFetch)throw new Error("Local provider doesn't support empty query");f&&s.forEach(function(n){return f.register(function(){return n.customCancelation()})}),this.searchFolders(s,null,i,r,e)}},i.prototype.searchFolders=function(n,t,i,r,u){var f=this;n.forEach(function(n){return f.searchFolder(i,t,n,r,u)})},i.prototype.emptyFetch=function(n,t){n.forEach(function(n){return t(n.responseType,r,null)})},i.prototype.getMax=function(n,t,i){return t!=0&&t!=10?i.maxAfter8chars:n.length>8?i.maxAfter8chars:n.length>3?i.maxAfter3chars:i.maxUpTo3chars},i.prototype.searchFolder=function(u,f,e,o){var v=this,h=e.responseType,c=n.safeExecute(function(){return e.getResultsContainer(f,u)},"getResultsContainer "+h),y,l,a;c?e.singleItem?(y=c,t.Promise.safeChain("search "+h,function(){return y.tryGetResultAsync()},function(n){return o(h,{suggestions:n?[e.addImage(v._config,n)]:[]},null)},function(){return o(h,r,null)})):(l=c,a=this.getMax(u.queryToFetch,u.scope,e),t.Promise.safeChain("search "+h,function(){return l.getItemsAsync(0,a)},function(n){var t=n.resultSet;t||(t=n),o(h,{suggestions:t.map(function(n){return e.addImage(v._config,n)})},i.getState(n))},function(){return o(h,r,null)})):o(h,r,null)},i.getState=function(n){switch(n.state){case 1:return"NI";case 2:return"PI"}return undefined},i.getApps=function(n,t,i,r,u){e(i,r,u,"getApps",function(n){return CortanaApp.queryFormulationView.deviceSearch.findAppsAsync(n)},function(t){return c.addImage(n,t)},l)},i.getSettings=function(n,t,i,r,u){e(i,r,u,"getSettings",function(n){return CortanaApp.queryFormulationView.deviceSearch.findSettingsAsync(n)},function(t){return h.addImage(n,t)},f)},i}(),t.LocalDataProvider=o})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var i=function(){function i(n,t){this._sequenceNumberToClientImpressionId={},this._config=n,this._cortanaApp=t}return i.prototype.logProfilerMarker=function(n,t,i,r,u,f){var o,e;switch(t){case 0:o=0;break;case 1:o=1;break;case 2:o=2;break;default:throw"No matching marker type";}(this._cortanaApp.logTelemetry||this._cortanaApp.logVerboseTrace)&&(f||(f={I:r,ID:u}),e=this._sequenceNumberToClientImpressionId[r],e||(e=this._cortanaApp.impressionId,this._sequenceNumberToClientImpressionId[r]=e),n==1&&this._cortanaApp.logMeasure?this._cortanaApp.logMeasure("Bing_QF_"+i,o,"QF",JSON.stringify(f),e):this._cortanaApp.logVerboseTrace?this._cortanaApp.logVerboseTrace("Bing_QF_"+i,o,"QF",JSON.stringify(f),e):this._cortanaApp.logTelemetry("Bing_QF_"+i,o,"QF",JSON.stringify(f),e))},i.prototype.reset=function(){this._sequenceNumberToClientImpressionId={}},i.prototype.getInitPageName=function(){return"Page.SmartSearch.AS.Init"},i.prototype.getSuggestionsPageName=function(){return"Page.SmartSearch.AS.Suggestions"},i.prototype.getApplicationName=function(){return"SmartSearch"},i.prototype.getRankerModelIds=function(){return{fastRankModelId:t.Ranking.suggestionRankingModelId,fastRankClassifierModelId:t.Ranking.topHitConfidenceModelId}},i.prototype.getDataSourceNameMap=function(){var i={};return i[n.WebResponseType]=n.DataSourceNames.WebSuggestions,i[t.ResponseTypes.OnlineSuggestionsThatMapToApps]=n.DataSourceNames.AppsOnline,i[t.OnlineSuggestionTypes.SpellCorrectedSetting]=n.DataSourceNames.SettingsOnline,i[t.LocalSuggestionTypes.BCSApp]=n.DataSourceNames.BCSApps,i[t.LocalSuggestionTypes.BCSSetting]=n.DataSourceNames.BCSSettings,i[t.LocalSuggestionTypes.App]=n.DataSourceNames.LocalApps,i[t.LocalSuggestionTypes.Setting]=n.DataSourceNames.LocalSettings,i[t.ResponseTypes.LocalMedia]=n.DataSourceNames.LocalMedia,i[t.LocalSuggestionTypes.PowerBi]=n.DataSourceNames.LocalPowerBI,i[t.LocalSuggestionTypes.File]=n.DataSourceNames.LocalFiles,i[t.LocalSuggestionTypes.Email]=n.DataSourceNames.LocalEmails,i[t.ResponseTypes.ReactiveAgents]=n.DataSourceNames.ReactiveAgents,i[t.ResponseTypes.AppRelatedReactiveAgents]=n.DataSourceNames.ReactiveAgents,i[t.LocalSuggestionTypes.PathCompletion]=n.DataSourceNames.PathCompletion,i[t.LocalSuggestionTypes.CommandLine]=n.DataSourceNames.CommandLine,i},i.prototype.createDataSource=function(i,r,u){var o=this,e=t.isSensitiveResponseType(this._config,i),f={T:"D.Url",Tx:e?"":u.text,K:u.instItem.getKValue(),Q:e?"":u.query,Val:u.type,Ho:u.handoffType,Gr:t.getGroupType(u)};return u.deviceItem&&(f.DeviceSignals=n.safeExecute(function(){return o.buildDeviceItemDataSource(e,u)},"buildDeviceItemDataSource")),this._config.logRankerOutput&&(f.RankerSignals=this.buildRankerOutputDataSource(u)),f},i.prototype.buildRankerOutputDataSource=function(n){if(!n.rankingScore&&!n.featureStore&&!n.topHitConfidenceScore)return undefined;return{rankingScore:n.rankingScore,featureStore:n.featureStore,topHitConfidenceScore:n.topHitConfidenceScore}},i.prototype.buildDeviceItemDataSource=function(n,i){var e=i.deviceItem,r={Rank:e.rankScore,PHits:e.getProperty("System.Search.QueryPropertyHits")},u,h,s,c,o,f;if(n||(r.Id=e.id,r.DName=e.displayName),this._config.th&&(r.kind=e.kind),i.hc&&(r.HC=1),t.isSetting(i))return r.MDN=t.isModernSetting(e)?1:0,r;if(u=t.getAppItem(i),u)return r.LAD=u.lastAccessed?u.lastAccessed.toJSON():"",r.AppLnch=u.totalLaunches,r.Args=u.launchArguments?1:0,r.MDN=u.isImmersive?1:0,(this._config.th||this._config.suppressDesktopAppsBasedOnExtensionAndIdPrefix)&&(r.Ext=u.extension),this._config.th&&(r.CDT=u.createdDate?u.createdDate.toJSON():"",r.LMD=u.lastModifiedDate?u.lastModifiedDate.toJSON():"",r.launchArguments=u.launchArguments,r.filePath=u.filePath),r;if(h=t.getRafItem(i),h)return this._config.th&&(r.appId=h.appId,r.taskFrame=h.taskFrame),r;if(s=t.getEmailItem(i),s)return this._config.th&&(r.senderName=s.senderName,r.fromName=s.fromName),r;if(c=t.getItemWithFileMetadata(i),c){if(this._config.th&&(r.Ext=c.extension,r.itemTypeDisplayName=c.itemTypeDisplayName),o=t.getCommandLineItem(i),o)return this._config.th&&(r.launchArguments=o.launchArguments,r.encodedPath=o.encodedPath),r;t.getPathCompletionItem(i)||(f=i.deviceItem,r.CDT=f.createdDate?f.createdDate.toJSON():"",r.LMD=f.lastModifiedDate?f.lastModifiedDate.toJSON():"",r.Ext=f.extension?f.extension:"")}return r},i.prototype.createNonSuggestionDataSourceItems=function(i){var e=[],u,r,f;for(u in t.NonSuggestionQSCodes)t.NonSuggestionQSCodes.hasOwnProperty(u)&&u!="Handoffs"&&u!="Groups"&&(r=t.NonSuggestionQSCodes[u],f={T:"D.Url",K:n.InstrumentedItem.getNonSuggestionInstrumentedItem(r).getKValue(),Val:r,N:u,Ho:t.NonSuggestionQSCodes.Handoffs[r],Gr:t.NonSuggestionQSCodes.Groups[r]},this._config.logRankerOutput&&i.hasOwnProperty(r)&&(f.RankerSignals=this.buildRankerOutputDataSource(i[r])),e.push(f));return e},i.prototype.logMasterPageImpressionForClient=function(t){n.safeExecute(function(){var n=+CortanaApp.queryFormulationView.perfMetrics.lookup(32);n&&n!=-933981677285477&&(t.clientUserInfo.fallback=n)},"perfMetricsFallbackLookup"),n.safeExecute(function(){return ThresholdInst.LogPageImpression(t,null,t.clientUserInfo)},"WindowsCortanaPaneInstrumentationProvider.logMasterImpressionForClient")},i}();t.WindowsCortanaPaneInstrumentationProvider=i})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var i="SA_SUPERFRESH_SUPPRESS",t="SUPPRESS",r=function(){function r(r,u,f){var e=this,o;this._isReloadSuppressed=!1,this._isQueryChanged=!1,this._pendingReload=!1,this._emptyQuery=!1,this._config=r,this._host=u,this._appCacheInstrumentationHelper=f,this._appCacheInstrumentationHelper.registerSuperFresh(),u.bindQueryChanged(function(){e._isReloadSuppressed=!0,e._isQueryChanged=!0}),u.bindAppHidden(function(){e._isReloadSuppressed=!1,e._isQueryChanged=!1,sj_cook.set(i,t,"0"),e._pendingReload&&(e.logReloadAttempt(),e.reload())}),o=sj_cook.get(i,t),o=="1"&&(this._isReloadSuppressed=!0),sj_be(applicationCache,"updateready",function(){return e.onUpdateReady()}),u.bindConversationStart(function(){e._isReloadSuppressed=!0,applicationCache.status!=0&&n.safeExecute(function(){return applicationCache.update()},"probe for manifest update")})}return r.prototype.onUpdateReady=function(){this.logReloadAttempt(),this._isReloadSuppressed?this._pendingReload=!0:this.reload()},r.prototype.reload=function(){sj_cook.set(i,t,"1"),this._host.reloadWebView()},r.prototype.logReloadAttempt=function(){this._appCacheInstrumentationHelper.instrumentSuperFreshUpdate(this._isQueryChanged,this._isReloadSuppressed)},r}();n.SuperFreshAppCache=r})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var u=function(){function n(){}return n.WebSuggestions="WebSuggestions",n.AppsOnline="AppsOnline",n.SettingsOnline="SettingsOnline",n.BCSApps="BCSApps",n.BCSSettings="BCSSettings",n.LocalApps="LocalApps",n.LocalSettings="LocalSettings",n.LocalMedia="LocalMedia",n.LocalFiles="LocalFiles",n.LocalEmails="LocalEmails",n.ReactiveAgents="LocalCat1",n.LocalPowerBI="LocalPowerBI",n.PathCompletion="PathCompletion",n.CommandLine="CommandLine",n.Local="Local",n.TypedUrls="TypedUrls",n.Synthetic="Synthetic",n}(),t,r,i;n.DataSourceNames=u,t=function(){function n(){}return n.createPerfPingEvent=function(t,i,r,u,f){var e={T:n.QFPERFPING_EVENT_NAME,ST:r,CVID:u,OFFSETS:i,STATE:f,V:n.QFPERFPING_VERSION};return{ImpressionGuid:t,EventType:n.CLIENTINST_EVENT_TYPE,Data:e}},n.CLIENTINST_EVENT_TYPE="ClientInst",n.QFPERFPING_EVENT_NAME="QFPerfPing",n.CLICK_EVENT_TYPE="Click",n.QFPERFPING_VERSION="2",n.QFPERFPING_INVALID_MEASURE=-2,n.INVALID_SEQUENCE_NUMBER=-2,n.KVALUE_SUGGESTIONS_START=1e3,n.KVALUE_SUFFIX_START=1,n.KVALUE_NON_SUGGESTIONS_START=100,n.DEFAULT_APP_NAMESPACE="SmartSearch",n.DEFAULT_SERVICE_NAME="AutoSuggest",n}(),n.InstrumentationCommon=t,r=function(){function n(n,i,r){this._kValue=n,this._appNS=i==t.DEFAULT_APP_NAMESPACE?i+"_":i,this._suffix=t.KVALUE_SUFFIX_START,this._mergedLogging=r}return n.prototype.shouldLog=function(){return this._mergedLogging||this.getAppNS()==t.DEFAULT_APP_NAMESPACE},n.prototype.shouldMerge=function(){return this._mergedLogging},n.createInstrumentedItem=function(i){var r=new n(n.generateKValue(i),"");return r._appNS=t.DEFAULT_APP_NAMESPACE,r},n.getNonSuggestionInstrumentedItem=function(i){var r=this._nonSuggestionInstrumentedItems[i];return r||(r=new n(++this._nonSuggestionInstrumentedItemsCount+t.KVALUE_NON_SUGGESTIONS_START,""),r._appNS=t.DEFAULT_APP_NAMESPACE,this._nonSuggestionInstrumentedItems[i]=r),r._suffix=t.KVALUE_SUFFIX_START,r},n.prototype.getKValue=function(){return this._kValue},n.prototype.getAppNS=function(){return this._appNS},n.prototype.getLayoutKValue=function(){return this._kValue+"."+this._suffix},n.prototype.getHValue=function(){return"ID="+this._appNS+","+this._kValue+"."+this._suffix},n.resetKValues=function(n){delete this._keystrokesKValues[n]},n.generateKValue=function(n){var r=n,i=this._keystrokesKValues[r];return i>0||(i=t.KVALUE_SUGGESTIONS_START),this._keystrokesKValues[r]=++i,i},n._keystrokesKValues={},n._nonSuggestionInstrumentedItems={},n._nonSuggestionInstrumentedItemsCount=0,n}(),n.InstrumentedItem=r,i=function(){function n(){}return n.logLayout=function(n){var u,r,f,t,i;if(n){if(n.parentElement&&(n=n.parentElement),u=n.querySelectorAll(this._instElemSelector),r=u.length,r==0)return[];for(f=[],t=0;t<r;t++)i=this.findChildNodes(u,t,r),i&&(t=i.lastProcessedIndex,f.push(i));return f.map(function(n){return n.layout})}},n.findChildNodes=function(n,t,i){var o=[],e=n[t],s=this.createLayoutRecord(e),u,r,h,f;if(!s)return null;if(u={isContainer:e.hasAttribute(this._regionAttr),lastProcessedIndex:t,layout:s},!u.isContainer)return u;for(r=t+1;r<i;r++)if(h=n[r],e.contains(h))f=this.findChildNodes(n,r,i),f&&(r=f.lastProcessedIndex,o.push(f.layout));else break;return o.length>0&&(s.L=o),u.lastProcessedIndex=r-1,u},n.createLayoutRecord=function(i){var e=i.getAttribute(n._regionAttr),r=null,s=i.getAttribute(this._hValueAttr),o=t.DEFAULT_APP_NAMESPACE,f=this.parseHValue(s);if(f&&(r=f.K,o=f.AppNS),e||r!=null){var c=!i.hasAttribute(this._regionAttr),h=c?n._layoutUrlType:n._regionType,u={T:h,AppNS:o};return r!=null&&(u.K=r),e&&(u.Region=e),u}},n.parseHValue=function(n){if(n){var t=this._hValueRegex.exec(n);return t&&t.length==3?{AppNS:t[1],K:t[2]}:null}return null},n._hValueAttr="data-h",n._regionAttr="data-region",n._instElemSelector="["+n._regionAttr+"], ["+n._hValueAttr+"]",n._hValueRegex=/ID=(\w+),(\d+(?:\.\d+)*)/i,n._regionType="L.Box",n._layoutUrlType="L.Url",n}(),n.InstrumentLayout=i})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){function r(n,t,r){return new i(n,t,r)}var t=function(){function n(){}return n.checking="checking",n.downloading="downloading",n.error="error",n.noUpdate="noupdate",n.obsolete="obsolete",n.updateReady="updateready",n}(),i=function(){function i(n,i,r){r===void 0&&(r=function(){return+Date.now()}),this.appCacheTimeline=null,this.appCacheEventIndex=1,this.appCacheEvents=[t.checking,t.downloading,t.error,t.noUpdate,t.obsolete,t.updateReady],this.superFreshEnabled=!1,this.autoSuggestHost=n,this.getNowTimestamp=r,this.instrumentationHelper=i,this.appCache=_w.applicationCache,this.subscribeForEvents()}return i.prototype.instrumentSuperFreshUpdate=function(n,t){this.appCacheTimeline||(this.appCacheTimeline=this.createAppCacheTimelineObject()),this.appCacheTimeline.SuperFreshUpdateData.Q=n,this.appCacheTimeline.SuperFreshUpdateData.T=this.getNowTimestamp(),this.appCacheTimeline.SuperFreshUpdateData.S=t,this.sendAppCacheEvents()},i.prototype.registerSuperFresh=function(){this.superFreshEnabled=!0},i.prototype.subscribeForEvents=function(){var n=this;this.appCacheEvents.forEach(function(t,i){return sj_be(n.appCache,t,function(){return n.handleAppCacheEvent(t,i)})})},i.prototype.handleAppCacheEvent=function(n,i){n!=t.checking&&this.appCacheTimeline||(this.appCacheTimeline=this.createAppCacheTimelineObject()),this.appCacheTimeline.AppCacheEvents[i]=this.getNowTimestamp();switch(n){case t.error:case t.obsolete:case t.noUpdate:this.sendAppCacheEvents();break;case t.updateReady:this.superFreshEnabled||this.sendAppCacheEvents()}},i.prototype.sendAppCacheEvents=function(){var i=this.appCacheTimeline,r,u,t;if(i){if(!Log2){r={message:"Log2 is not defined",name:"appCache inst"},n.reportException(r,"appCacheInst");return}u=[{I:i.EventIndex,E:i.AppCacheEvents,S:i.SuperFreshUpdateData,ABT:this.instrumentationHelper.getConversationStartTimestamp()}],t=n.InstrumentationCommon.createPerfPingEvent(this.autoSuggestHost.getConversationId(),u,"AppCache",this.autoSuggestHost.getConversationId()),Log2.LogEvent(t.EventType,t.Data,n.InstrumentationCommon.QFPERFPING_EVENT_NAME,null,null,t.ImpressionGuid),this.appCacheTimeline=this.createAppCacheTimelineObject()}},i.prototype.createAppCacheTimelineObject=function(){var t={EventIndex:this.appCacheEventIndex,AppCacheEvents:{},SuperFreshUpdateData:{Q:null,T:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,S:null}};return this.appCacheEventIndex++,t},i}();n.AppCacheInstrumentationHelper=i,n.GetAppCacheLogger=r})(AutoSuggest||(AutoSuggest={})),AutoSuggest.QFAppCacheLogHelper={GetAppCacheLogger:AutoSuggest.GetAppCacheLogger};(function(){_w.GetUxClassificationSection=function(){return{client:"windows",clientversion:"M2"}}})();var Instrumentation;(function(n){function bt(n){u=n,sj_evt.fire("ClientInst.PageInstInfo",ht)}function at(n,t,i){if(_w.Log2){if(t){var r=s(t,!1);r&&(n.layoutNodes=r)}ft(n,i),Log2.LogMasterPageImpression(n)}}function vt(n,t){var u=s(n,!0),f,i,r;if(u&&u.length>0){for(f=[],i=0;i<u.length;i++)r=u[i],f.push({T:"L.MI",Action:"Update",AppNS:r.AppNS,K:r.K,L:r.L});Log2.LogEvent("ClientInst",null,null,t,f)}}function ti(n,r){var v=_w.location.href,a=[],p=r?r:_G.IG,o=t[p],y,u,s,c;if(o)for(y in o)if(u=o[y].tree,!u.IsInstrumented()){var l=u.GetValue(),e=u.GetChildren(),h=[];if(e.length>0){for(s in e)h.push(f(e[s]));l.DS=h}a.push(l),i(u)}return c={dataSources:a,layoutNodes:[],pageName:n,rawQuery:ThresholdUtilities.getDecodedQuery(),isQuery:!0,form:ThresholdUtilities.getUrlParameter(v,"form"),impressionUrl:v,appName:dt}}function ot(n,r){var h=s(n,!0),p=[],l,c,y,e,o,k,u,w;if(h&&h.length>0)for(l=0;l<h.length;l++)c=h[l],p.push({T:"L.MI",Action:"Update",AppNS:c.AppNS,K:c.K,L:c.L});if(y=_G.IG,r&&(y=r),e=[],o=t[y],o)for(k in o)if(u=o[k].tree,u.IsInstrumented())v(u,e);else{var d=u.GetValue(),a=u.GetChildren(),b=[];if(a.length>0){for(w in a)b.push(f(a[w]));d.DS=b}e.push(d),i(u)}(p.length>0||e.length>0)&&Log2.LogEvent("ClientInst",null,null,e,p)}function e(n,i,r,u,f,e){var a="D.Item",v="D.Url",h=_G.IG,o,s,l;if(f&&(h=f),t[h]||(t[h]=[]),o={AppNS:k,K:lt++,T:a},n&&(o.Url=n,o.T=v),i&&(o.N=i),e&&(o.T=e),r)for(s in r)r.hasOwnProperty(s)&&(string.IsNullOrWhiteSpace(r[s])||r[s].length===0?console.warn("Skipping logging datasource field key: "+s+" because it has no value."):ii[s]===!0?o[s]=r[s]:console.warn("Unknown datasource field key: "+s+". skipping logging value: "+r[s]));return u?(l=c(o,u,h),!l&&InstrumentationConfig.CopyDataCommand&&(rt(u,h),c(o,u,h))):t[h].push(new ri(new ut(o))),o}function ni(n,t,i,r){var u={},f;u.Service=t,u.Scenario=n;for(f in r)u[f]=r[f];return e(null,null,u,null,i,gt)}function kt(n,t,i){return a(e(n,t,null,i))}function a(n){return new it(n)}function h(n,r,u){var h,f,o,s;for(h in t){f=t[h];for(s in f)f[s].kValueExists(n)&&(o=s);if(o&&f[o].kValueExists(n)){var a=e(null,null,null,null,u,null),l=f[o].tree.GetValue(),c=[];c.push({T:"D.MI",Action:"Move",SrcAppNS:l.AppNS,SrcK:l.K,DestAppNS:a.AppNS,DestK:a.K}),Log2.LogEvent("ClientInst",null,null,c,null,null,h),t[u].push(f[o]),i(f[o].tree);return}}SharedLogHelper.LogError("missingDataSourceException","couldn't find data source with appNS "+r+" and k value "+n)}function rt(n,t){h(n.K.toString(),n.AppNS,t)}function c(n,i,r){var f=[],s=t[r],h,u,o,e,c;for(h in s)for(f.push(s[h].tree);f.length>0;){if(u=f.pop(),o=u.GetValue(),o.K===i.K&&o.AppNS===i.AppNS)return u.AddChild(n),s[h].addKValue(n.K.toString()),!0;e=u.GetChildren();for(c in e)f.push(e[c])}return!1}function f(n){var u=n.GetValue(),i=n.GetChildren(),r,t;if(i.length>0){for(r=[],t=0;t<i.length;t++)r.push(f(i[t]));u.DS=r}return u}function v(n,t){var u=n.GetChildren(),h=n.GetValue(),r,o;for(r in u)if(u[r].IsInstrumented())v(u[r],t);else{var c=u[r].GetValue(),e=u[r].GetChildren(),s=[];if(e.length>0){for(o in e)s.push(f(e[o]));c.DS=s}t.push({T:"D.MI",Action:"Append",AppNS:h.AppNS,K:h.K,DS:[c]}),i(u[r])}}function i(n){var r,t;for(n.SetIsInstrumented(),r=n.GetChildren(),t=0;t<r.length;t++)i(r[t])}function ft(n,t){var u={MUID:sj_cook.get("MUID","MUID")},i,r;if(t)for(i in t)t.hasOwnProperty(i)&&(u[i]=t[i]);n.clientUserInfo=u,r=GetUxClassificationSection(),r&&(n.uxClassification=r)}function ht(n){var f,e,t,i;if(u){f=n.clientUserInfo,f||(f={},n.clientUserInfo=f);for(t in o)o.hasOwnProperty(t)&&!f[t]&&(i=u[o[t]],i&&(f[t]=i));e={};for(t in r)r.hasOwnProperty(t)&&(i=u[r[t]],i&&(e[t]=i));n.userInfoOverrides=e}}function s(n,t){var s,f,i,r,u,o,e,h;if(n.parentElement&&(n=n.parentElement),s=n.querySelectorAll(st),f=s.length,f==0)return[];for(i=[],r=0;r<f;r++)u=y(s,r,f,null,t),u&&(r=u.lastProcessedIndex,i.push(u));if(t){e=[];for(h in i)ThresholdUtilities.pushOntoArray(e,b(i[h]));o=e.map(p)}else o=i.map(function(n){for(var t=n.layout,i;t.L&&t.L.length==1&&t.L[0].L;)i=t.AppNS,t=t.L[0],i&&!t.AppNS&&(t.AppNS=i);return t});return o}function b(n){var i=[],u=n.layout.AppNS,r,t;for(r in n.children)if(t=n.children[r],t.isLogged)t.layout.AppNS||(t.layout.AppNS=u),ThresholdUtilities.pushOntoArray(i,b(t));else{i.push(n);break}return i}function y(n,t,i,r,u){var h=[],o=n[t],a=o.hasAttribute(g),w=o.getAttribute(d)==="1",s,e,l,f,v,c;if(w&&!a)return null;if(s=et(o,r),e={isContainer:a,lastProcessedIndex:t,layout:s,isLogged:w,children:h},o.setAttribute(d,"1"),!e.isContainer)return e;for(l=s.AppNS,f=t+1;f<i;f++)if(v=n[f],o.contains(v))c=y(n,f,i,l?l:r,u),c&&(f=c.lastProcessedIndex,h.push(c));else break;if(h.length>0)s.L=h.map(p);else if(e.isContainer&&u)return null;return e.lastProcessedIndex=f-1,e}function p(n){return n.layout}function et(n,i,r){var f=null,e=null,p=!n.hasAttribute(g),w=n.getAttribute(yt),c,u,b,o,a;if(w&&(u=l(w),u&&(f=u.K,e=u.AppNS)),c=n.getAttribute(wt),c&&(u=l(c),u&&(f=u.K,e=u.AppNS)),f||(f=n.getAttribute(pt)),b=p?tt:ct,o={T:b},f){var y=f.split(".",1)[0],s=r?r:_G.IG,v=!1;for(a in t[s])if(t[s][a].kValueExists(y)){v=!0;break}!v&&InstrumentationConfig.CopyDataCommand&&h(y.toString(),e,s),o.K=f}return e&&e!=i?o.AppNS=e:e||i||(o.AppNS=k),!p&&n.hasAttribute(nt)&&(o.Region=n.getAttribute(nt)),o}function l(n){if(!n)return null;var t=w.exec(n);return t&&t.length==3?{AppNS:t[1],K:t[2]}:null}var it=function(){function n(n){this.hValue="ID="+n.AppNS+","+n.K,this.dsItem=n}return n.prototype.GetNamespacedKValue=function(){return this.hValue+".1"},n.prototype.GetKValue=function(){return this.dsItem.K.toString()+".1"},n.prototype.GetDataSource=function(){return this.dsItem},n.prototype.GetUrlWithFormCode=function(){return this.dsItem?this.dsItem.Url:null},n}(),ut=function(){function n(n){this.children=[],this.instrumented=!1,this.value=n}return n.prototype.AddChild=function(t){this.children.push(new n(t))},n.prototype.GetValue=function(){return this.value},n.prototype.GetChildren=function(){return this.children},n.prototype.IsInstrumented=function(){return this.instrumented},n.prototype.SetIsInstrumented=function(){this.instrumented=!0},n}(),ri=function(){function n(n){this.kValuesContained={},this.tree=n,this.kValuesContained[n.GetValue().K.toString()]=!0}return n.prototype.addKValue=function(n){this.kValuesContained[n]=!0},n.prototype.kValueExists=function(n){return this.kValuesContained[n]},n}(),lt=1,yt="h",wt="data-h",pt="data-k",nt="data-region",g="data-isregion",d="data-logged",st="[data-k], [data-isregion], [h], [data-h]",ct="L.Box",tt="L.Url",k="SERP",gt="D.MyStuff",dt="SmartSearch",ii={T:!0,Service:!0,Scenario:!0,AppNS:!0,K:!0,AppID:!0,AppName:!0,Url:!0,CDT:!0,LMD:!0,EXT:!0,PHits:!0,Rank:!0,SettingID:!0,DS:!0,SPDisplay:!0,PPMiss:!0,order:!0},u=null,t={},r,o,w;ThresholdUtilities.getCortanaHeaders(bt),r={Make:"X-Device-Manufacturer",Model:"X-Device-Product","Loc/RT":"X-Search-Location"},o={DeviceID:"X-Device-MachineId",IsTouch:"X-Device-Touch",DeviceSKU:"X-Device-SKU",OSSKU:"X-Device-OSSKU",ConnectionType:"X-Device-NetworkType",ClientMarket:"X-BM-RegionalSettings",AppLifetimeID:"X-Device-ClientSession",CortanaOptIn:"X-Device-IsOptIn"},ClientInstConfig.waitForPageInfo=!0,ClientInstConfig.isInstrumentationEnabled=SearchAppWrapper.CortanaApp.isBingEnabled,sj_evt.bind("ajax.threshold.pageStart",function(){ClientInstConfig.isInstrumentationEnabled=SearchAppWrapper.CortanaApp.isBingEnabled}),n.LogPageImpression=at,n.LogUpdatedLayout=vt,n.CreatePageImpression=ti,n.LogUpdatedLayoutCentralizedDataSources=ot,n.CreateDataSourceItem=e,n.CreateDataSourcesRoot=ni,n.CreateInstrumentedItem=kt,n.CreateInstrumentedItemFromDs=a,w=/ID=(\w+),(\d+(?:\.\d+)*)/i})(Instrumentation||(Instrumentation={})),_w.ThresholdInst=Instrumentation;var AutoSuggest;(function(n){var u="DSNameNotFound",f="/QF_KEYSTROKE_VIRTUAL_URL?",r="/QF_INIT_VIRTUAL_URL?",t="autosuggest",i=function(){function i(t,i,r,u,f){u===void 0&&(u=function(){return+Date.now()}),f===void 0&&(f=function(){return _w.location.protocol+"//"+_w.location.hostname}),this._perfPingConversationStartTimestamp=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,this._perfPingSubmissionBeginTime=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,this._perfPingSubmissionEndTime=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,this._keystrokesPerfPingData={},this._keystrokesInstrumentationData={},this._config=t,this._host=i,this._clientInstrumentationProvider=r,this._getNowTimestamp=u,this._getOrigin=f,this._dsNameMap=this._clientInstrumentationProvider.getDataSourceNameMap(),this.reset(!0)}return i.prototype.getImpressionGuid=function(n){var t=this._keystrokesInstrumentationData[n];if(t&&t.ImpressionGuid&&t.ImpressionGuid.length>0)return t.ImpressionGuid;throw"getImpressionGuid() : No IG for sequence "+n;},i.prototype.enrichTargetUrl=function(n,t,i,r){var u,f;return this._perfPingSubmissionEndTime=this.getOffsetedNow(),r||(r=this._config.targetLinkFormCode),u=i+"&form="+encodeURIComponent(r),u+="&qs="+encodeURIComponent(t),u+="&cvid="+encodeURIComponent(this._host.getConversationId()),u+="&pq="+encodeURIComponent(n),f=this.getSubmissionBeginTime()+this._perfPingConversationStartTimestamp,u+="&sbts="+f},i.prototype.instrumentItemClick=function(t){var i,r;this._perfPingSubmissionEndTime=this.getOffsetedNow(),i=this._keystrokesInstrumentationData[t],i?(i.IsLogged||this.logKeystrokeInstrumentationData(t),_G.IG!=i.ImpressionGuid&&n.reportException(new Error("IG ("+i.ImpressionGuid+") for sequenceNumber "+t+" does not match the page IG ("+_G.IG+")"),"instrumentItemClick")):n.reportException(new Error("No instrumentation data found for sequenceNumber:"+t+" ConversationID:"+this._host.getConversationId()),"instrumentItemClick"),r=[],r=r.concat(this.createSubmissionPerfPingEvents(i)),this.logPerfPingEvents(r)},i.prototype.instrumentKeyboardSubmitGping=function(t){_w.si_T&&n.safeExecute(function(){return _w.si_T(t)},"instrumentKeyboardSubmitGping")},i.prototype.safeLog=function(t,i,r,u,f){var e=this._keystrokesInstrumentationData[i];e?(this.logKeystrokeProfilerMarker(0,0,t,i),r(e)):n.reportException(new Error("No instrumentation data found for sequenceNumber "+i),u,f)},i.prototype.safePerfLog=function(t,i,r,u,f,e,o){var h=this,s=this._keystrokesPerfPingData[u];s?(r.forEach(function(n){return h.logKeystrokeProfilerMarker(t,i,n,u)}),f(s)):n.reportException(new Error("No instrumentation data found for sequenceNumber "+u),e,o)},i.prototype.instrumentRenderingStarted=function(n){var t=this;this.safeLog("renderingStarted",n,function(i){i.RenderingStarted=!0,t.updatePageIG(n)},"instrumentRenderingStarted")},i.prototype.instrumentBeginRequest=function(t,i,r){var s=this._keystrokesPerfPingData[t];s&&n.reportException(new Error("Duplicate BeginRequest for: "+t),"instrumentBeginRequest"),this.logKeystrokeProfilerMarker(1,0,"beginRequest",t);var f=this._host.getConversationId(),u=this._host.getImpressionGuid(t),h={ImpressionGuid:u,ConversationId:f,PartialQuery:i,PendingDataSources:{},DataSources:{},MergedDS:[],DuplicateDS:{},Layout:[],IsLogged:!1,RenderingStarted:!1,PendingSyntheticSuggestions:{}},e=this.getOffsetedNow(),o={ImpressionGuid:u,ConversationId:f,PrefixLength:i?i.length:0,RequestBegin:e-r,RenderQueued:{},ResponseReceived:{},ProviderSate:undefined,RenderFinished:{},Full:!1,AllProvidersArrived:!1,PendingIcons:0,RenderStopped:undefined,TopResultRendered:[],IconsRetrieved:{}};this._keystrokesInstrumentationData[t]=h,this._keystrokesPerfPingData[t]=o},i.prototype.instrumentResponseReceived=function(n,t,i){var r=this;this.safePerfLog(0,0,["responseReceived_"+t],n,function(n){n.ResponseReceived[t]=r.getOffsetedNow(),i&&(n.ProviderSate=n.ProviderSate||{},n.ProviderSate[t]=i)},"instrumentResponseReceived",t)},i.prototype.instrumentTopResultRendered=function(n,t){var i=this;this.safePerfLog(1,0,["topResultRendered"],n,function(n){return n.TopResultRendered.push({V:i.getOffsetedNow(),T:t.join(",")})},"instrumentTopResultRendered")},i.prototype.profileKeystroke=function(n,t,i){var r=t();try{return this.logKeystrokeProfilerMarker(0,1,r,n),i()}finally{this.logKeystrokeProfilerMarker(0,2,r,n)}},i.prototype.instrumentAggregatorCall=function(t,i){var r=this;this.safeLog("aggregatorCall",t,function(t){var u={T:"D.Aggregator",Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:"Aggregator",AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,DS:[]},e=r._clientInstrumentationProvider.getRankerModelIds(),f;e&&(u.rankerModelIds=e),f=i.topResults.map(function(t){var i={T:"D.DSRef",KRef:t.instItem.getKValue()};return t.instItem.getAppNS()!=n.InstrumentationCommon.DEFAULT_APP_NAMESPACE&&(i.AppNS=t.instItem.getAppNS()),i}),u.DS.push({T:"D.TopHit",DS:f}),t.DataSources.aggregator=u},"instrumentAggregatorCall")},i.prototype.addDuplicatesDataSource=function(t){var i=Object.keys(t.DuplicateDS).map(function(n){return t.DuplicateDS[n]});i.length>0&&(t.DataSources.duplicates={T:"D.Duplicates",Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:"Duplicates",AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,DS:i})},i.prototype.instrumentDuplicate=function(t,i,r){this.safeLog("duplicate",t,function(t){var u=t.DuplicateDS[i.instItem.getHValue()],f;u||(u={T:"D.Duplicate",DS:[{T:"D.DSRef",KRef:i.instItem.getKValue()}]},i.instItem.getAppNS()!=n.InstrumentationCommon.DEFAULT_APP_NAMESPACE&&(u.DS[0].AppNS=i.instItem.getAppNS()),t.DuplicateDS[i.instItem.getHValue()]=u),f={T:"D.DSRef",KRef:r.instItem.getKValue()},r.instItem.getAppNS()!=n.InstrumentationCommon.DEFAULT_APP_NAMESPACE&&(f.AppNS=r.instItem.getAppNS()),u.DS.push(f)},"instrumentDuplicate")},i.prototype.notifyFull=function(n){this.safePerfLog(1,0,["notifyFull"],n,function(n){return n.Full=!0},"notifyFull")},i.prototype.notifyAllProvidersArrived=function(n){var t=this;this.safePerfLog(0,0,["allProvidersArrived"],n,function(i){i.AllProvidersArrived=!0,i.RenderStopped&&t.finalizeKeystrokeLog(n)},"notifyAllProvidersArrived")},i.prototype.notifyIconPending=function(t,i,r,u){var f=this;this.safePerfLog(0,1,["Icon_"+(i?"TR":"SUG")],t,function(t){var e=r+(i?"T":"S");t.IconsRetrieved[e]?n.reportException(new Error("Retrieving icon more than once"),"notifyIconPending"):t.IconsRetrieved[e]={B:f.getOffsetedNow(),E:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,T:u},t.PendingIcons++},"notifyIconPending",i?"TR":"SUG")},i.prototype.notifyIconReady=function(t,i,r){var f=this;this.safePerfLog(0,2,["Icon_"+(i?"TR":"SUG")],t,function(t){var u=r+(i?"T":"S");t.IconsRetrieved[u]?t.IconsRetrieved[u].E=f.getOffsetedNow():n.reportException(new Error("Instrumenting unseen icon"),"notifyIconReady"),t.PendingIcons--},"notifyIconReady",i?"TR":"SUG")},i.prototype.tryInstrumentRenderStopped=function(t){var i=this;this.safePerfLog(null,null,[],t,function(r){r.Full&&r.PendingIcons==0&&(r.RenderStopped=i.getOffsetedNow(),r.AllProvidersArrived&&i.finalizeKeystrokeLog(t),i._config.th&&n.ClientTestHooks.ClientApiLog("RenderStopped()",null,!0))},"tryInstrumentRenderStopped")},i.prototype.finalizeKeystrokeLog=function(t){var i,r;this.logKeystrokeInstrumentationData(t),i=this._keystrokesPerfPingData[t],i&&(r=this.createKeystrokePerfPingEvent(t,i),this.logPerfPingEvents([r]),delete this._keystrokesPerfPingData[t],this._config.th&&n.ClientTestHooks.ClientApiLog("finalizeKeystrokeLog()",null,!0))},i.prototype.instrumentSubmissionBegin=function(){this._perfPingSubmissionBeginTime==n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE&&(this._perfPingSubmissionBeginTime=this.getOffsetedNow())},i.prototype.instrumentRenderFinished=function(t,i){var r=this;this.safePerfLog(0,0,i.map(function(n){return"renderFinished_"+n}),t,function(t){var u=r.getOffsetedNow();i.forEach(function(n){return t.RenderFinished[n]=u}),r._config.th&&n.ClientTestHooks.ClientApiLog("instrumentRenderFinished()",null,!0)},"instrumentRenderFinished",i.join(","))},i.prototype.instrumentSyntheticSuggestions=function(n,t){var i=this._keystrokesInstrumentationData[n];t.forEach(function(n){i.PendingSyntheticSuggestions[n.type]=n})},i.prototype.instrumentDataSource=function(n,t,i){this.safeLog("dataSource_"+t,n,function(n){n.PendingDataSources[t]=(i||[]).filter(function(n){return n.instItem.shouldLog()})},"instrumentDataSource",t)},i.prototype.processPendingDataSources=function(t){var o=this,r,e,f,i;for(r in t.PendingDataSources)e=t.PendingDataSources[r],e.length>0&&(f=[],i=this._dsNameMap[r],i||(i=u,n.reportException(new Error("Missing DS name mapping for responseType: "+r),"instrumentDataSource")),e.forEach(function(n){n.instItem.shouldMerge()?t.MergedDS.push(o.createMergedDS(r,i,n)):f.push(o._clientInstrumentationProvider.createDataSource(r,i,n))}),f.length>0&&(t.DataSources[r]={T:"D."+i,AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:i,SC:f.length,DS:f}))},i.prototype.instrumentSnRProviderFetchUrl=function(n,t){this.safeLog("SnRProviderFetchUrl",n,function(n){t&&(n.SnRProviderFetchUrl=t)},"instrumentSnRProviderFetchUrl")},i.prototype.reset=function(n){this._perfPingConversationStartTimestamp=this._getNowTimestamp(),this.logInitializationPhase(n),this._clientInstrumentationProvider.reset()},i.prototype.getConversationStartTimestamp=function(){return this._perfPingConversationStartTimestamp},i.prototype.createMergedDS=function(n,t,i){var r=this._clientInstrumentationProvider.createDataSource(n,t,i);return r.T="D.MI",r.Action="Update",r.AppNS=i.instItem.getAppNS(),r},i.prototype.logKeystrokeProfilerMarker=function(t,i,r,u){var f;f=u==n.InstrumentationCommon.INVALID_SEQUENCE_NUMBER?this._host.getConversationId():this._host.getImpressionGuid(u),this._clientInstrumentationProvider.logProfilerMarker(t,i,r,u,f)},i.prototype.createKeystrokePerfPingEvent=function(t,i){var r=[{I:t,PL:i.PrefixLength,K:i.RequestBegin,RRT:i.ResponseReceived,RFT:i.RenderFinished,TRR:i.TopResultRendered,RS:i.RenderStopped,IRT:i.IconsRetrieved}];return n.InstrumentationCommon.createPerfPingEvent(i.ImpressionGuid,r,"Keystroke",i.ConversationId,i.ProviderSate)},i.prototype.updatePageIG=function(n){_G&&(_G.IG=this.getImpressionGuid(n))},i.prototype.createMasterPageImpression=function(i,r,u,f,e,o,s,h,c){var l={dataSources:[],layoutNodes:[],pageName:i,rawQuery:f,isQuery:!1,form:e,impressionUrl:this.createVirtualImpressionURL(r,u),appName:this._clientInstrumentationProvider.getApplicationName()},a,y,v;return l.clientUserInfo={FDPartnerEntry:t},_G.nclid&&(l.clientUserInfo.nclid=_G.nclid),a=_w._CachedFlights,typeof a!="undefined"&&a.length&&(l.clientUserInfo.CachedFlights=a.join(",")),l.dataSources=[].concat(h||[],c||[]),o&&(y=_d.body,v=this.profileKeystroke(s,function(){return"logLayout"},function(){return n.InstrumentLayout.logLayout(y)}),v&&(l.layoutNodes=v)),l},i.prototype.logMasterPageImpressionForKeystroke=function(n){var t=this._keystrokesInstrumentationData[n],r,i;t&&(this.processPendingDataSources(t),this.addDuplicatesDataSource(t),r=Object.keys(t.DataSources).map(function(n){return t.DataSources[n]}).concat([this.createNonSuggestionsDataSource(t.PendingSyntheticSuggestions)]),i=this.createMasterPageImpression(this._clientInstrumentationProvider.getSuggestionsPageName(),f,t.SnRProviderFetchUrl?t.SnRProviderFetchUrl.substring(t.SnRProviderFetchUrl.indexOf("?")+1):"",t.PartialQuery,this._config.targetLinkFormCode,t.RenderingStarted,n,r,t.MergedDS),this.logMasterPageImpression(t.ImpressionGuid,i))},i.prototype.getSubmissionBeginTime=function(){return this._perfPingSubmissionBeginTime==n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE?this._perfPingSubmissionEndTime:this._perfPingSubmissionBeginTime},i.prototype.createSubmissionPerfPingEvents=function(t){var u=[],e=[{ISS:this.getSubmissionBeginTime(),ISE:this._perfPingSubmissionEndTime,ABT:this._perfPingConversationStartTimestamp}],f=t?t.ConversationId:this._host.getConversationId(),o=t?t.ImpressionGuid:f,i,r;u.push(n.InstrumentationCommon.createPerfPingEvent(o,e,"Submit",f));for(i in this._keystrokesPerfPingData)this._keystrokesPerfPingData.hasOwnProperty(i)&&(r=this._keystrokesPerfPingData[i],r&&(u.push(this.createKeystrokePerfPingEvent(i,r)),delete this._keystrokesPerfPingData[i]));return u},i.prototype.logPerfPingEvents=function(t){var r,i;if(t){for(r=0;r<t.length;r++)i=t[r],Log2.LogEvent(i.EventType,i.Data,n.InstrumentationCommon.QFPERFPING_EVENT_NAME,null,null,i.ImpressionGuid),this._clientInstrumentationProvider.logProfilerMarker(0,0,"QFPerfPing",n.InstrumentationCommon.INVALID_SEQUENCE_NUMBER,i.ImpressionGuid,i);this._config.th&&n.ClientTestHooks.ClientApiLog("perfPingEvent("+JSON.stringify(t)+")",null,!0)}},i.prototype.logMasterPageImpression=function(t,i){i&&(i.impressionGuid=t,this._clientInstrumentationProvider.logMasterPageImpressionForClient(i,this._host.getConversationId()),this._config.th&&n.ClientTestHooks.ClientApiLog("masterPageImpression("+JSON.stringify(i)+"), ImpressionGUID="+t,null,!0))},i.prototype.logInitializationPhase=function(t){var l=this.getOffsetedNow(),e=this.createMasterPageImpression(this._clientInstrumentationProvider.getInitPageName(),r,"","",this._config.targetLinkFormCode,!1,-1),i,f,o,s;t&&(e.clientUserInfo.isColdStart=1),e.clientUserInfo.isOffline=n.isBrowserOnline()?0:1,i=this._host.getConversationId(),this.logMasterPageImpression(i,e),i&&(f=-1,this._keystrokesInstrumentationData[f]={ImpressionGuid:i,ConversationId:i,PartialQuery:"",PendingDataSources:{},DataSources:{},MergedDS:[],DuplicateDS:{},Layout:[],IsLogged:!0,RenderingStarted:!1,PendingSyntheticSuggestions:{}},this.updatePageIG(f));var h=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,c=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,u=_w.performance;u&&u.timing&&(h=this.calculateOffsetTimePoint(u.timing.responseStart),c=this.calculateOffsetTimePoint(u.timing.responseEnd)),o=[{JS:l,FBR:h,LBR:c,ABT:this._perfPingConversationStartTimestamp}],s=n.InstrumentationCommon.createPerfPingEvent(i,o,"Init",i),this.logPerfPingEvents([s])},i.prototype.calculateOffsetTimePoint=function(n){return n-this._perfPingConversationStartTimestamp},i.prototype.getOffsetedNow=function(){return this.calculateOffsetTimePoint(this._getNowTimestamp())},i.prototype.createNonSuggestionsDataSource=function(t){var r={T:"D.ContentGroup",AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:"NonSuggestions",SC:0,DS:[]},i=this._clientInstrumentationProvider.createNonSuggestionDataSourceItems(t);return i&&(r.DS=i,r.SC=i.length),r},i.prototype.logKeystrokeInstrumentationData=function(t){var i=this._keystrokesInstrumentationData[t];i&&!i.IsLogged&&(this.logMasterPageImpressionForKeystroke(t),i.IsLogged=!0,i.DataSources={},i.PendingDataSources={},i.PendingSyntheticSuggestions={},n.InstrumentedItem.resetKValues(t))},i.prototype.createVirtualImpressionURL=function(t,i){var r=this._getOrigin()+t;return r+=i?i:n.Service.QueryParams.ConversationId+"="+encodeURIComponent(this._host.getConversationId()),_G.ServerIG&&(r+="&ASInitIG="+encodeURIComponent(_G.ServerIG)),r},i.prototype.instrumentBcsPopulationEvent=function(t,i){var u=this._host.getConversationId(),r=n.InstrumentationCommon.createPerfPingEvent(u,undefined,"BCSPopulation",u);r.Data.BCS_V=t,r.Data.EV=i,this.logPerfPingEvents([r])},i}();n.InstrumentationHelper=i})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t=function(){function n(n,t,i,r){i===void 0&&(i=function(){return Date.now()}),r===void 0&&(r=_w.location.protocol+"//"+_w.location.host),this._config=n,this._instrumentationHelper=t,this._getNowTimestamp=i,this._baseUrl=r}return n.prototype.getSearchUrl=function(n,t,i,r,u){r||(r="/search?q="+encodeURIComponent(t));var e=this._baseUrl+r,f=this._instrumentationHelper.enrichTargetUrl(n,i,e,u);return this.enrichTargetUrlWithFlightInfo(f)},n.prototype.enrichTargetUrlWithFlightInfo=function(t){var r=this._config.aC_sf,i;if(r)for(i=0;i<r.length;i++)t+=n.OPTIN_FLIGHT_QUERY_STRING+encodeURIComponent(r[i]);return _G.nclid&&(t+=n.HASHED_MUID_QUERY_STRING+encodeURIComponent(_G.nclid),t+=n.CURRENT_TIMESTAMP_QUERY_STRING+encodeURIComponent(this._getNowTimestamp().toString())),t},n.OPTIN_FLIGHT_QUERY_STRING="&sf=",n.HASHED_MUID_QUERY_STRING="&nclid=",n.CURRENT_TIMESTAMP_QUERY_STRING="&ts=",n}();n.NavigationHelper=t})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(n){function e(t){var i,e;if(!t)return[];var h=[],s=!1,o=0;for(i=0;i<=t.length;++i)s?t[i]==n.endMarker&&(e={text:t.substring(o,i).replace(u,""),highlighted:!0},e.text.length>0&&h.push(e),s=!1,o=i+1):t[i]==n.startMarker&&(e={text:t.substring(o,i).replace(f,""),highlighted:!1},e.text.length>0&&h.push(e),s=!0,o=i+1);return o!=t.length&&(e={text:r(t.substring(o)),highlighted:s},h.push(e)),h}function r(n){return n.replace(u,"").replace(f,"")}function s(r,u){var u;if(!r||!u)return r;if(u=u.toLowerCase(),r.toLowerCase()==u)return n.startMarker+r+n.endMarker;var f=i(r),h=[],l=i(u),c=[],e=-1,s=!1;return l.forEach(function(i,r){var v,u,l,o,a;if(i.length>0&&(v=t.indexOf(i[0])==-1,s||v)){for(u=0,l=++e;l<f.length+e;++l){if(u=l%f.length,!h[u]&&(o=f[u],a=t.indexOf(o[0])==-1,(s||a)&&o.toLowerCase()==i)){f[u]=n.startMarker+o+n.endMarker,h[u]=!0,c[r]=!0,s=!0;break}s=!1}e=u}}),e=-1,l.forEach(function(i,r){var u,l,o,a,v,s;if(!c[r]&&i.length>0){for(u=0,l=++e;l<f.length+e;++l)if(u=l%f.length,!h[u]&&(o=f[u],a=t.indexOf(o[0])==-1,a&&(v=o.toLowerCase(),s=v.indexOf(i),s>=0))){f[u]=o.substring(0,s)+n.startMarker+o.substr(s,i.length)+n.endMarker+o.substr(s+i.length),h[u]=!0;break}e=u}}),"".concat.apply("",f).replace(o,"")}function i(n){for(var u=[],i=0,r;i<n.length;){for(r=i;i<n.length&&t.indexOf(n[i])<0;)i++;for(i-r>0&&u.push(n.substr(r,i-r)),r=i;i<n.length&&t.indexOf(n[i])>=0;)i++;i-r>0&&u.push(n.substr(r,i-r))}return u}var t;n.startMarker=String.fromCharCode(57344),n.endMarker=String.fromCharCode(57345);var u=new RegExp(n.startMarker,"g"),f=new RegExp(n.endMarker,"g"),o=new RegExp(n.endMarker+n.startMarker,"g");n.split=e,n.removeMarkers=r,n.addMarkers=s,t=[" ",".","?","!",",","'",":",";","¿","¡","/",String.fromCharCode(160)]})(t=n.HitHighlighting||(n.HitHighlighting={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var u=[{actionUri:"action://Alarm/Create",qsCode:"LMC",locString:"CortanaAnnotation_AlarmCreate",icon:t.ClientFontIcons.AlarmClock},{actionUri:"action://Alarm/Off",qsCode:"LDC",locString:"CortanaAnnotation_AlarmOff",icon:t.ClientFontIcons.AlarmClock},{actionUri:"action://Alarm/Review",qsCode:"LRC",locString:"CortanaAnnotation_AlarmReview",icon:t.ClientFontIcons.AlarmClock},{actionUri:"action://Note/Create",qsCode:"NOC",locString:"CortanaAnnotation_Note",icon:t.ClientFontIcons.Page},{actionUri:"action://Calendar/CreateAppointment",qsCode:"CDCC",locString:"CortanaAnnotation_CalendarCreate",icon:t.ClientFontIcons.Calendar},{actionUri:"action://Calendar/UpdateAppointment",qsCode:"CDUC",locString:"CortanaAnnotation_CalendarUpdate",icon:t.ClientFontIcons.Calendar},{actionUri:"action://Calendar/QueryAppointment",qsCode:"CDQC",locString:"CortanaAnnotation_CalendarQuery",icon:t.ClientFontIcons.Calendar},{actionUri:"action://Reminder/Create",qsCode:"CRC",locString:"CortanaAnnotation_Reminder",icon:t.ClientFontIcons.Reminder},{actionUri:"action://Communication/Call",qsCode:"CLC",locString:"CortanaAnnotation_Calling",icon:t.ClientFontIcons.Phone},{actionUri:"action://Communication/TextMessage",qsCode:"CXC",locString:"CortanaAnnotation_Texting",icon:t.ClientFontIcons.Message},{actionUri:"action://Email/SendEmail",qsCode:"CEMC",locString:"CortanaAnnotation_Email",icon:t.ClientFontIcons.Mail},{actionUri:"action://VoiceCommand/Reco",qsCode:"VCDC"},{actionUri:"action://VaSettings/Settings",qsCode:"SGC",icon:t.ClientFontIcons.Settings},{actionUri:"action://VaMusic/Play",qsCode:"MAC",locString:"CortanaAnnotation_PlayMusic",icon:t.ClientFontIcons.MusicInCollection},{actionUri:"action://VaMusic/Controls",qsCode:"MKC",icon:t.ClientFontIcons.MusicInCollection},{actionUri:"action://InternalCommon/help",qsCode:"HPC",locString:"CortanaAnnotation_GetHelp",icon:t.ClientFontIcons.Help},{actionUri:"action://VaAudioSearch/Start",qsCode:"ARC",locString:"CortanaAnnotation_AudioReco",icon:t.ClientFontIcons.MusicInfo},{actionUri:"action://WpStartMenu/Launch",qsCode:t.LocalSuggestionTypes.Cat1_LaunchApp},],i={picture:t.LocalSuggestionTypes.Photo,video:t.LocalSuggestionTypes.Video,movie:t.LocalSuggestionTypes.Video,recordedtv:t.LocalSuggestionTypes.Video,music:t.LocalSuggestionTypes.Music,folder:t.LocalSuggestionTypes.Folder},e=function(){var n={};return u.forEach(function(t){return n[t.actionUri]=t.qsCode}),n}(),r=function(){var n={};return u.forEach(function(t){return n[t.qsCode]=t}),n}(),f=function(){function u(n,t,i,r,u){this._config=n,this._host=t,this._instrumentationHelper=i,this._navigationHelper=r,this._searchPreCacheHandler=u}return u.prototype.parse=function(i,r,u,f,e,o,s){switch(u){case n.WebResponseType:this.parseOnlineSuggestions(i,r,f,e,o,s);break;case t.ResponseTypes.BingContentStore:this.parseBCSResponse(i,r,f,e,o,s);break;case t.ResponseTypes.MRUSignals:o(t.ResponseTypes.MRUSignals,[],f);break;default:this.parseLocalSuggestions(i,u,f,e,o,r,s)}},u.prototype.parseLocalSuggestions=function(i,r,u,f,e,o,s){var l=this,v=r==t.ResponseTypes.ReactiveAgents,y=[],h=[],a,c;v&&u.suggestions.forEach(function(n){var t=n.deviceItem.appId;t&&(h.push(n),y.push(t))}),a=h.length>0?u.suggestions.filter(function(n){return!n.deviceItem.appId}):u.suggestions,c=a.map(function(t){return n.safeExecute(function(){return l.parseLocalSuggestion(i,t,null,r,o)},"parseLocalResponse "+r)}).filter(function(n){return n!=null}),r==t.LocalSuggestionTypes.File&&this.decorateLocalParsedFilesAndFolders(c),e(r,c,null),v&&this.parseAppsAndSettings(i,t.ResponseTypes.AppRelatedReactiveAgents,y,h,function(n){return n.deviceItem.appId},null,null,null,null,f,o,e,s,function(n,t,r){return r?(n.getIcon=r.getIcon,l.parseLocalSuggestion(i,n,null,t,o)):null})},u.prototype.decorateLocalParsedFilesAndFolders=function(n){for(var u=[],i,r,t=0;t<n.length-1;++t)for(i=t+1;i<n.length;++i)n[t].text.toLowerCase()==n[i].text.toLowerCase()&&(u[t]=!0,u[i]=!0);for(r=[],t=0;t<n.length;++t)u[t]&&r.push(n[t]);this.decorateSuggestionsWithSourceInfo(r)},u.prototype.parseAppsAndSettings=function(i,r,u,f,e,o,s,h,c,l,a,v,y,p){var w=this;r&&n.isResponseTypeEnabled(r,i,this._config)&&t.LocalDataProvider.getApps(this._config,l,u,function(t){if(l()){w._instrumentationHelper.instrumentResponseReceived(a,r,null);var i=f.map(function(i){return n.safeExecute(function(){return p(i,r,t[e(i)])},"parseApp "+r)}).filter(function(n){return n!=null});v(r,i,null)}},y),o&&n.isResponseTypeEnabled(o,i,this._config)&&t.LocalDataProvider.getSettings(this._config,l,s,function(t){if(l()){w._instrumentationHelper.instrumentResponseReceived(a,o,null);var i=h.map(function(i){return n.safeExecute(function(){return p(i,o,t[c(i)])},"parseSettings "+o)}).filter(function(n){return n!=null});v(o,i,null)}},y)},u.prototype.parseBCSResponse=function(i,r,u,f,e,o){var h=this,s;if(!u){n.isResponseTypeEnabled(t.ResponseTypes.BingContentStore,i,this._config)&&e(t.ResponseTypes.BingContentStore,[],null),n.isResponseTypeEnabled(t.LocalSuggestionTypes.BCSApp,i,this._config)&&e(t.LocalSuggestionTypes.BCSApp,[],null),n.isResponseTypeEnabled(t.LocalSuggestionTypes.BCSSetting,i,this._config)&&e(t.LocalSuggestionTypes.BCSSetting,[],null);return}n.isResponseTypeEnabled(t.ResponseTypes.BingContentStore,i,this._config)&&(s={suppressedAppIds:u.suppressedAppIds,suppressedSettingIds:u.suppressedSettingIds,engagementSignals:u.engagementSignals},e(t.ResponseTypes.BingContentStore,[],s)),this.parseAppsAndSettings(i,t.LocalSuggestionTypes.BCSApp,u.appIds,u.appIds,function(n){return n},t.LocalSuggestionTypes.BCSSetting,u.settingIds,u.settingIds,function(n){return n},f,r,e,o,function(n,t,u){return u?h.parseLocalSuggestion(i,u,null,t,r):null})},u.prototype.parseOnlineSuggestions=function(i,r,u,f,e,o){var c=this;if(!u){n.isResponseTypeEnabled(n.WebResponseType,i,this._config)&&e(n.WebResponseType,[],null),n.isResponseTypeEnabled(t.ResponseTypes.OnlineSuggestionsThatMapToApps,i,this._config)&&e(t.ResponseTypes.OnlineSuggestionsThatMapToApps,[],null),n.isResponseTypeEnabled(t.OnlineSuggestionTypes.SpellCorrectedSetting,i,this._config)&&e(t.OnlineSuggestionTypes.SpellCorrectedSetting,[],null);return}var a=[],h=[],v=[],s=[],l=[];n.safeExecute(function(){u.Suggestions.forEach(function(n){var e=n.Attributes,y=n.Attributes.stype,u,f,o;switch(y){case t.OnlineSuggestionTypes.SpellCorrectedApp:case t.OnlineSuggestionTypes.Store:u=e.appId,u&&(h.push(n),s.indexOf(u)==-1&&s.push(u));break;case t.OnlineSuggestionTypes.Cat1_VCD:u=e.appId,u&&(h.push(n),s.indexOf(u)==-1&&s.push(u));break;case t.OnlineSuggestionTypes.SpellCorrectedSetting:f=e.settingId,f&&(v.push(n),l.push(f));break;default:o=c.parseOnlineSuggestion(i,n,r),o&&a.push(o)}})},"parseOnlineSuggestions"),n.isResponseTypeEnabled(n.WebResponseType,i,this._config)&&e(n.WebResponseType,a,u.RankingSignals),this.parseAppsAndSettings(i,t.ResponseTypes.OnlineSuggestionsThatMapToApps,s,h,function(n){return n.Attributes.appId},t.OnlineSuggestionTypes.SpellCorrectedSetting,l,v,function(n){return n.Attributes.settingId},f,r,e,o,function(n,t,u){return u?c.parseLocalSuggestion(i,u,n,n.Attributes.stype,r):c.parseOnlineSuggestion(i,n,r)})},u.prototype.getRafSecondaryText=function(n){var t=r[n].locString||"CortanaAnnotation_Generic";return this._host.getLocString(t)},u.prototype.getAppSecondaryText=function(n){return CortanaApp.isMobile?null:n.isImmersive?n.isTrustedApp?this._host.getLocString("TrustedWindowsAppAnnotation"):this._host.getLocString("WindowsAppAnnotation"):n.isTrustedApp?this._host.getLocString("TrustedDesktopAppAnnotation"):this._host.getLocString("DesktopAppAnnotation")},u.prototype.getSettingSecondaryText=function(n){return t.isModernSetting(n)?this._host.getLocString("SystemSettingsAnnotation"):this._host.getLocString("ControlPanelAnnotation")},u.prototype.getMetadataForLocalSuggestion=function(n){var o,u,r,e,f;if(n.handoffType==5)return n.type==t.OnlineSuggestionTypes.Cat1_VCD?{secondaryText:null,secondaryTextClass:t.CssClass_Action}:{secondaryText:this.getRafSecondaryText(n.type),secondaryTextClass:t.CssClass_Action};if(o=t.getAppItem(n),o)return{secondaryText:this.getAppSecondaryText(o),secondaryTextClass:t.CssClass_Annotation};if(u=t.getEmailItem(n),u)return{secondaryText:u.fromName||u.senderName,secondaryTextClass:null};if(t.isSetting(n))return{secondaryText:this.getSettingSecondaryText(n.deviceItem),secondaryTextClass:t.CssClass_Annotation};r=n.deviceItem;switch(n.type){case t.LocalSuggestionTypes.PowerBi:return{secondaryText:"From "+n.deviceItem.modelDisplayName,secondaryTextClass:null};case t.LocalSuggestionTypes.File:case t.LocalSuggestionTypes.Folder:return this.getFileMetadata(r,r.itemTypeDisplayName);case t.LocalSuggestionTypes.Photo:case t.LocalSuggestionTypes.Video:case t.LocalSuggestionTypes.Music:return this.getMediaMetadata(r,n.type);case t.LocalSuggestionTypes.PathCompletion:case t.LocalSuggestionTypes.CommandLine:if(e=n.deviceItem.kind,e=="program")return this.getCommandMetadata();switch(i[e]){case t.LocalSuggestionTypes.Photo:case t.LocalSuggestionTypes.Video:case t.LocalSuggestionTypes.Music:return this.getMediaMetadata(r,n.type);default:if(f=this.getItemTypeDisplayName(r),f)return this.getFileMetadata(r,f);if(n.type==t.LocalSuggestionTypes.CommandLine)return this.getCommandMetadata()}}return{secondaryText:null,secondaryTextClass:null}},u.prototype.getItemTypeDisplayName=function(n){if(n.launchArguments)return null;var t=n.itemTypeDisplayName;return t&&t[0]!="."?t:null},u.prototype.getMediaMetadata=function(n,i){var r=i==t.LocalSuggestionTypes.Photo?this._host.getLocString("ViewPhotoPrompt"):i==t.LocalSuggestionTypes.Video?this._host.getLocString("PlayVideoPrompt"):i==t.LocalSuggestionTypes.Music?this._host.getLocString("PlaySongPrompt"):null;return{secondaryText:r,secondaryTextClass:t.CssClass_Action,additionalInfoText:n.itemTypeDisplayName}},u.prototype.getFileMetadata=function(i,r){var u=i.lastModifiedDate;return u?{secondaryText:n.formatString(this._host.getLocString("LastModifiedAnnotation"),[u.toLocaleDateString()]),secondaryTextClass:t.CssClass_Annotation,additionalInfoText:i.itemTypeDisplayName}:{secondaryText:r,secondaryTextClass:t.CssClass_Annotation}},u.prototype.decorateSuggestionsWithSourceInfo=function(t){var i=this._host.getLocString("InfoTextWithSource");t.forEach(function(t){var r=t.deviceItem.getProperty("System.ItemFolderPathDisplay");if(r){var f=r.slice(r.lastIndexOf("\\")+1),u=n.HitHighlighting.removeMarkers(f?f:r),e=t.deviceItem.lastModifiedDate;e?t.additionalInfoText=n.formatString(i,[t.additionalInfoText,u]):t.secondaryText=n.formatString(i,[t.secondaryText,u]),t.additionalSourceText=u}})},u.prototype.getCommandMetadata=function(){return{secondaryText:this._host.getLocString("RunCommandPrompt"),secondaryTextClass:t.CssClass_Action}},u.prototype.isValidIcon=function(n){return n!=null&&(n.type==3||!!n.content)},u.prototype.isValid=function(t,i,r){return t.text?t.handoffType==null?(n.reportException(new Error("Missing handoff type"),i,r?"":t.text),!1):t.type?!t.getIcon&&!this.isValidIcon(t.icon)?(n.reportException(new Error("Missing icon"),i,r?"":t.text),!1):!0:(n.reportException(new Error("Missing suggestion type"),i,r?"":t.text),!1):(n.reportException(new Error("Missing text"),i,r?"":t.id),!1)},u.prototype.parseLocalSuggestion=function(u,f,o,s,h){var a=this,v=f.deviceItem.kind,g=s==t.ResponseTypes.ReactiveAgents||s==t.ResponseTypes.AppRelatedReactiveAgents,p=g?e[v]:s==t.LocalSuggestionTypes.File?i[v]||t.LocalSuggestionTypes.File:s==t.ResponseTypes.LocalMedia?i[v]:s,nt=t.isSensitiveResponseType(this._config,s),y,k,tt,w,b,d;if(!p)return n.reportException(new Error("Unrecognized kind: "+v),"parseLocalSuggestion "+s,nt?"":f.deviceItem.displayName||f.deviceItem.id),null;if(p==t.OnlineSuggestionTypes.Store)return null;var it=f.deviceItem.displayName,l=o?o.Attributes:null,rt=l&&l.k&&l.appNS?new n.InstrumentedItem(parseInt(l.k),l.appNS,!0):n.InstrumentedItem.createInstrumentedItem(h),c=t.createSuggestion(n.HitHighlighting.addMarkers(it,u.queryToFetch),null,null,f.getIcon,f.icon,p,it,this._config.th?"AutoSuggest.LocalSuggestion":null,rt,null,g||p==t.OnlineSuggestionTypes.Cat1_VCD?5:2);if(c.deviceItem=f.deviceItem,y=this.getMetadataForLocalSuggestion(c),c.secondaryText=y.secondaryText,c.secondaryTextClass=y.secondaryTextClass,c.additionalInfoText=y.additionalInfoText,o){if(!t.compliesWithMinVersion(l.appMinVersion,c.deviceItem.version))return null;this.setCommonOnlineSuggestionProperties(c,o),o.Text&&l.query&&(!t.isApp(c)||c.appContext)&&(c.text=o.Text,c.query=l.query),o.SecondaryText&&(c.secondaryText=o.SecondaryText)}return(c.handoffType==5?(g?(tt=c.deviceItem,w=r[c.type],c.getIcon||(c.icon=w.icon?{content:w.icon,type:1}:{type:3}),c.actionUri=w.actionUri,c.hc=!0,k=tt.taskFrame):k=l.taskFrame,c.click=function(){return a.launchNonSearch(c.type,h,function(){return a._host.launchCat1(c.query,k)})}):(b=t.getAppItem(c),b?c.click=function(){return a.launchNonSearch(c.type,h,function(){return a._host.launchAppItem(b,c.appContext)})}:(d=t.getCommandLineItem(c),d&&(c.hc=t.isRealCommand(c,d)),c.click=function(){return a.launchNonSearch(c.type,h,function(){return a._host.launchDeviceItem(c.deviceItem)})})),this.isValid(c,"parseLocalSuggestion "+s,nt))?c:null},u.prototype.setCommonOnlineSuggestionProperties=function(n,t){var i=t.Attributes,r;n.hc=i.hc==="1",i.confidence&&(n.confidence=parseFloat(i.confidence)),i.catalogScore&&(n.catalogScore=parseFloat(i.catalogScore)),i.avgRating&&(n.avgRating=parseFloat(i.avgRating)),i.ratingCount&&(n.ratingCount=parseInt(i.ratingCount)),n.actionUri=i.actionUri,n.appContext=i.appContext,n.highConfidenceMetaSuggestionScore=t.HighConfidenceMetaSuggestionScore,n.prefetchConfidenceScore=t.PrefetchConfidenceScore,r=t.InlineAnswer,n.answerHtml=r&&r.Content?r.Content.HTML:null},u.getIcon=function(n){var t=n.IconContent;return t?t[0]=="B"?{content:t.slice(1),type:2}:{content:t,type:1}:{content:n.Icon,type:0}},u.prototype.parseOnlineSuggestion=function(i,r,f){var s=this,o=r.Attributes,c=o.stype,a,e,h,l;if(c==t.OnlineSuggestionTypes.SpellCorrectedApp||c==t.OnlineSuggestionTypes.SpellCorrectedSetting||c==t.OnlineSuggestionTypes.Cat1_VCD)return null;if(a=o&&o.k&&o.appNS?new n.InstrumentedItem(parseInt(o.k),o.appNS,this._config.logRankerOutput):n.InstrumentedItem.createInstrumentedItem(f),e=t.createSuggestion(r.Text,r.SecondaryText,t.CssClass_Annotation,null,u.getIcon(r),c,o.query,o["data-partnertag"],a,null,null),this.setCommonOnlineSuggestionProperties(e,r),o.isAnswer==="1"){if(e.handoffType=6,e.secondaryTextClass=t.CssClass_Action,n.adjustCasing(e,i),o.url)e.click=function(n){return s.launchSearch(e.query,i,e.type,o.url,f,n)};else{if(!t.isCortanaEnabledCache)return null;e.click=function(){return s.launchNonSearch(e.type,f,function(){return s._host.launchCat2or3a(e.query,o.taskFrame)})}}this.isValidIcon(e.icon)||(e.icon={type:3})}else if(o.taskFrame){if(!t.isCortanaEnabledCache)return null;e.actionUri.indexOf("action://FindMyStuff/")==0?(e.handoffType=4,h=this.getMyStuffScopeOverride(e.actionUri,o.taskFrame),h&&(e.secondaryText=this._host.getLocString(h.myStuffLocString),e.icon={content:h.myStuffIcon,type:1}),l=e.query.toLowerCase()==i.queryToFetch.toLowerCase(),e.updateFromQuery=function(t){return l?(e.query=t.queryToFetch,e.text=n.HitHighlighting.addMarkers(e.query,t.queryToFetch),!0):!1},n.adjustCasing(e,i),e.click=function(){return s.launchNonSearch(e.type,f,function(){return s._host.launchCat1MyStuff(e.query,o.taskFrame,s._config.targetLinkFormCode)})}):(e.handoffType=5,e.secondaryTextClass=t.CssClass_Action,this._config.forceCanonicalTextForCat1OnTextMismatch&&e.query.toLowerCase()!=i.queryToFetch.toLowerCase()&&(e.query=e.secondaryText,e.text=n.HitHighlighting.addMarkers(e.query,i.queryToFetch)),n.adjustCasing(e,i),e.click=function(){return s.launchNonSearch(e.type,f,function(){return s._host.launchCat1(e.query,o.taskFrame)})}),this.isValidIcon(e.icon)||(e.icon={type:3})}else{if(!o.query)return null;if(e.type==t.OnlineSuggestionTypes.DirectNav){if(!o.url)return null;e.handoffType=1,e.getIcon=this._host.getBrowserIcon,e.click=function(){return s.launchNonSearch(e.type,f,function(){return s._host.launchUrl(o.url)})}}else if(e.type==t.OnlineSuggestionTypes.Store)e.handoffType=3,e.icon.bgColor=o.bgColor,e.secondaryText=this._host.getLocString("AppInstallPrompt"),e.secondaryTextClass=t.CssClass_Action,e.click=function(){return s.launchNonSearch(e.type,f,function(){return s._host.launchStorePdp(o.appId,o.productId)})};else{if(!o.url)return null;e.handoffType=0,this.isValidIcon(e.icon)||(e.icon={content:t.ClientFontIcons.Search,type:1}),e.secondaryText||(e.secondaryText=this._host.getLocString("BingSearchAnnotation")),e.click=function(n){return s.launchSearch(e.query,i,e.type,o.url,f,n)}}}return this.isValid(e,"parseOnlineSuggestion",!1)?e:null},u.prototype.getMyStuffScopeOverride=function(i,r){if(i=="action://FindMyStuff/FindDocument"){var u=n.safeExecute(function(){return JSON.parse(r)},"parse MyStuff/FindDocument task frame");if(u&&u.FileType&&u.FileType.Value){if(u.FileType.Value=="Picture")return t.ScopeConfig[3];if(u.FileType.Value=="Video")return t.ScopeConfig[4]}}return null},u.prototype.launchSearch=function(n,t,i,r,u,f){if(this._instrumentationHelper.instrumentItemClick(u),r=this._navigationHelper.getSearchUrl(t.fullPartialQuery,n,i,r),this._config.eSearchPreCache){var e=this._searchPreCacheHandler.triggerPreCache(r,u);e.isPreCached&&(r+="&pf=2"),e.syncId&&e.syncId.length>0&&(r+="&pcsId="+e.syncId)}this._host.launchSearch(n,r,f)},u.prototype.launchNonSearch=function(n,t,i){this._instrumentationHelper.instrumentItemClick(t),i()},u}();t.SuggestionsParser=f})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var i;(function(t){function v(){return!!i}function a(){return e}function c(){return r}function o(n,t){var i=_ge(n.id);t?i.className.indexOf(f)===-1&&(i.className+=f):i.className=i.className.replace(f,"")}function y(n){r&&(r.selected=!1,o(r,!1)),r=n,r&&(r.selected=!0,o(r,!0))}function l(n,t,i,r){h(t,i,s(n,r))}function s(t,i){return t.map(function(t){var r={id:t.verb,text:t.displayName,isSeparator:!t.verb,selected:!1};return r.isSeparator||(r.click=function(){i(t.verb),n.safeExecute(function(){t.executeAsync(),u()},"verb.executeAsync")}),r})}function h(n,t,r){if(u(),r.length>0){e=r.filter(function(n){return!n.isSeparator}),i=_d.createElement("div"),i.id="contextMenu",i.className="contextMenu",i.style.top="1px",i.style.left="1px",i.style.visibility="hidden";var f;r.forEach(function(n){var r,t;n.isSeparator?(r=_d.createElement("hr"),r.className="divider",i.appendChild(r)):(t=_d.createElement("div"),t.id=n.id,t.textContent=n.text,t.className="contextMenuItem",t.addEventListener("mouseup",function(t){t.button==0&&n.click()}),i.appendChild(t))}),_d.body.appendChild(i),sb_st(function(){var u=i.offsetWidth+1,r=i.offsetHeight+1;i.style.left=i.parentElement.offsetWidth-n<u?i.parentElement.offsetWidth-u+"px":n+"px",i.style.top=i.parentElement.offsetHeight-t<r?i.parentElement.offsetHeight-r+"px":t+"px",i.style.visibility=""},0)}}function u(){i&&(_d.body.removeChild(i),i=null,e=[],r=null)}var i,e=[],r,f;t.isContextMenuVisible=v,t.getSelectableItems=a,t.getSelectedItem=c,f=" sa_hv",t.select=y,t.showContextMenu=l,t.dismiss=u,_d.body.addEventListener("mouseup",u),_w.addEventListener("blur",u),sj_evt.bind("ajax.threshold.pageStart",u)})(i=t.ContextMenus||(t.ContextMenus={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){function u(n){switch(n){case 0:return"AppsGroup";case 3:return"CommandGroup";case 1:return"SettingsGroup";case 2:return"CortanaGroup";case 4:return"PhotosGroup";case 5:return"VideosGroup";case 6:return"MusicGroup";case 7:return"FilesGroup";case 8:return"FoldersGroup";case 9:return"EmailsGroup";case 10:return"StoreGroup";case 11:return"WebGroup"}}var i=function(){function n(){this._pendingSuggestions=[],this._processedResponseCounts=[],this._resultsCounter={numberOfGroups:0,numberOfSuggestions:0,numberOfTopResultsNonAnswer2lines:0,numberOfTopResultsNonAnswer3lines:0,numberOfTopResultAnswers:0}}return n.prototype.getAllPendingSuggestions=function(){var n=[];return this._pendingSuggestions.forEach(function(t){return n=n.concat(t.suggestions)}),n},n.prototype.removePendingSuggestion=function(n,t){for(var i,u,r=0;r<this._pendingSuggestions.length;++r)if(i=this._pendingSuggestions[r],i.group==t)if(u=i.suggestions.indexOf(n),u==-1)throw new Error("Pending suggestion not found");else{i.suggestions.splice(u,1),i.suggestions.length==0&&this._pendingSuggestions.splice(r,1);return}throw new Error("Pending suggestion not found");},n.prototype.getResultsCounter=function(){return this._resultsCounter},n.prototype.onSuggestionAdded=function(){this._resultsCounter.numberOfSuggestions+=1},n.prototype.onSuggestionRemoved=function(){this._resultsCounter.numberOfSuggestions-=1},n.prototype.onTopResultsUpdated=function(n){var t,i;for(this._resultsCounter.numberOfTopResultsNonAnswer2lines=0,this._resultsCounter.numberOfTopResultsNonAnswer3lines=0,this._resultsCounter.numberOfTopResultAnswers=0,t=0;t<n.length;t++)i=n[t],i.answerHtml?this._resultsCounter.numberOfTopResultAnswers+=1:i.additionalInfoText?this._resultsCounter.numberOfTopResultsNonAnswer3lines+=1:this._resultsCounter.numberOfTopResultsNonAnswer2lines+=1},n.prototype.onGroupAdded=function(){this._resultsCounter.numberOfGroups+=1},n.prototype.onGroupRemoved=function(){this._resultsCounter.numberOfGroups-=1},n.prototype.queue=function(n,t){var i=this._pendingSuggestions.filter(function(n){return n.group.type==t.type})[0];i?i.suggestions.push(n):(i={group:t,suggestions:[n]},this._pendingSuggestions.push(i))},n.prototype.full=function(){return!t.canFitSuggestion(this._resultsCounter)},n.prototype.flush=function(n){for(var i,t,r,u;this._pendingSuggestions.some(function(n){return n.suggestions.length>0});)for(i=0;i<this._pendingSuggestions.length;++i)if(t=this._pendingSuggestions[i],r=t.suggestions[0],r){if(u=t.group,this.full()){this._pendingSuggestions=[];return}n(r,u),t.suggestions.splice(0,1)}this._pendingSuggestions=[]},n}(),r=function(){function r(r,u,f,e,o,s,h){var c=this,l;this._topResultsRenderingDisabled=!1,this._groupRenderingDisabled=!1,this._lastUpdatedSequenceNumber=-1,this._pendingSubmitSequenceNumber=-1,this._groupState=new i,this._initialized=!1,this._itemLaunchEventHandlers=[],this.groups=[],this.topResults=[],this.permanentDisambig=[],this._config=r,this._host=u,this._autoComplete=f,this._instrumentationHelper=e,this._sequenceNumberReader=o,this._navigationHelper=s,this._page=h,this._container=_ge("container"),this._page.setContextMenuHandler(function(n,t){return c.showContextMenu(n,t.pageX,t.pageY)}),this._page.setTopResultClickHandler(function(n){return c.click(n,!0)}),this._page.setSuggestionClickHandler(function(n){return c.click(n,!1)}),u.bindKeyDown(function(n,t){return c.onKeyDown(n,t)}),u.bindKeyUp(function(n){return c.onKeyUp(n)}),l=CortanaApp.searchBox.isMock,(CortanaApp.isMobile||l)&&ThresholdUtilities.getCortanaHeaders(function(t){var i,r;t&&(i=t["X-BM-DeviceDimensionsLogical"],i&&(r=_ge("root"),r.style.height=i.split("x")[1]+"px",l&&(r.style.width=i.split("x")[0]+"px"),n.Windows.resetPaneSizeCaches()))}),u.bindConversationStart(function(){return t.resetPaneSizeCaches()}),u.bindDismissed(function(){c._selectedItem=null,t.ContextMenus.dismiss(),c._permanentSearchMyStuff=null,c._permanentSearchTheWeb=null,c._initialized=!1,c.topResults=[],c.renderTopResults(),c.clearGroups(),c.permanentDisambig=[],c.renderPermanentDisambig(),c._lastUpdatedSequenceNumber=-1,c._extraSignalsMap=null})}return r.prototype.onItemLaunch=function(n){var t=this;this._itemLaunchEventHandlers.forEach(function(i){return i(n,t._partialQuery,t._extraSignalsMap)})},r.prototype.bindItemLaunch=function(n){this._itemLaunchEventHandlers.push(n)},r.prototype.setExtraSignalsMap=function(n){this._extraSignalsMap=n},r.prototype.ensureInitialized=function(){var i=this;this._initialized||(this.permanentDisambig=[],t.isMyStuffEnabled&&(this._permanentSearchMyStuff=t.createSuggestion(t.isBingEnabledCache?this._host.getLocString("DisambigMyStuff"):this._host.getLocString("SearchMyStuff"),null,null,null,{content:t.ClientFontIcons.WindowsLogo,type:1,needsAccentColor:!0},t.NonSuggestionQSCodes.PersistentSearchMyStuff,null,null,n.InstrumentedItem.getNonSuggestionInstrumentedItem(t.NonSuggestionQSCodes.PersistentSearchMyStuff),null,4,"psms",function(){return i.launchMyStuff(i._partialQuery,null,t.MyStuffFormCodes.PersistentDisambig,i._lastUpdatedSequenceNumber)},!0),this.permanentDisambig.push(this._permanentSearchMyStuff)),t.isBingEnabledCache&&(this._permanentSearchTheWeb=t.createSuggestion(t.isMyStuffEnabled?this._host.getLocString("DisambigWeb"):this._host.getLocString("SearchTheWeb"),null,null,null,{content:t.ClientFontIcons.Search,type:1},t.NonSuggestionQSCodes.PersistentSearchTheWeb,null,null,n.InstrumentedItem.getNonSuggestionInstrumentedItem(t.NonSuggestionQSCodes.PersistentSearchTheWeb),null,0,"pstw",function(){return i.launchSearch(i._partialQuery,t.NonSuggestionQSCodes.PersistentSearchTheWeb,i._lastUpdatedSequenceNumber)},!0),this.permanentDisambig.push(this._permanentSearchTheWeb)),this.renderPermanentDisambig(),this._initialized=!0)},r.prototype.onKeyDown=function(i,r){if(i!=13&&(this._pendingSubmitSequenceNumber=null),!n.isNavigationKey(i)){if(n.isContextMenuKey(i,r.shiftKey)&&this._selectedItem&&!this.isGroup(this._selectedItem)&&this.permanentDisambig.indexOf(this._selectedItem)==-1){var u=this._selectedItem,f=_ge(u.id);this.showContextMenu(u,120,f.offsetTop+this._container.scrollTop+24);return}i==13&&t.ContextMenus.getSelectedItem()||t.ContextMenus.dismiss()}},r.prototype.onKeyUp=function(t){var r,i;n.isNavigationKey(t)&&this._selectedItem&&(r=_ge(this._selectedItem.id),this.scrollToSuggestion(r,this._container,this._container.offsetHeight),i=window.innerHeight,CortanaApp.isMobile&&_d.body.scrollHeight>i&&this.scrollToSuggestion(r,_d.body,i))},r.prototype.scrollToSuggestion=function(n,t,i){var f=t.scrollTop,r=n.offsetTop,u=r+n.offsetHeight;u>f+i?t.scrollTop=u-i:r<f&&(t.scrollTop=r)},r.prototype.onQueryChanged=function(i){var u,r,f;(this.ensureInitialized(),this._extraSignalsMap=null,t.ContextMenus.dismiss(),this._partialQuery&&this._partialQuery.equals(i))||(u=this._partialQuery?this._partialQuery.queryToFetch:"",r=i.queryToFetch,this._partialQuery=i,f=!1,this.topResults.forEach(function(t){if(t.updateFromQuery&&t.updateFromQuery(i))f=!0;else if(r.length>u.length&&r.indexOf(u)==0&&t.query.toLowerCase().indexOf(i.queryToFetch.toLowerCase())>=0){var e=t.text.indexOf(n.HitHighlighting.endMarker);e>=0&&e<t.text.length-1&&(t.text=t.text.substr(0,e)+t.text.substr(e+1,r.length-u.length)+n.HitHighlighting.endMarker+t.text.substr(e+1+r.length-u.length),f=!0)}}),f&&(this.renderTopResults(),this._instrumentationHelper.instrumentTopResultRendered(this._sequenceNumberReader.getSequenceNumber(),this.topResults.map(function(n){return n.type}))))},r.prototype.getSelectableItems=function(){if(t.ContextMenus.isContextMenuVisible())return t.ContextMenus.getSelectableItems();var n=this.topResults;return this.groups.forEach(function(t){t.selectable&&(n=n.concat([t])),n=n.concat(t.suggestions)}),n=n.concat(this.permanentDisambig)},r.prototype.getSelectedItem=function(){return t.ContextMenus.isContextMenuVisible()?t.ContextMenus.getSelectedItem():this._selectedItem},r.prototype.select=function(n,i){if(t.ContextMenus.isContextMenuVisible())t.ContextMenus.select(n);else{var r=this._selectedItem;r&&(r.selected=!1),this._selectedItem=n,n&&(n.selected=!0),(n&&this.topResults.indexOf(n)>=0||r&&this.topResults.indexOf(r)>=0)&&this.renderTopResults(),(n&&this.groups.indexOf(n)>=0||n&&this.groups.some(function(t){return t.suggestions.indexOf(n)>=0})||r&&this.groups.indexOf(r)>=0||r&&this.groups.some(function(n){return n.suggestions.indexOf(r)>=0}))&&this.renderGroups(),(n&&this.permanentDisambig.indexOf(n)>=0||r&&this.permanentDisambig.indexOf(r)>=0)&&this.renderPermanentDisambig(),i&&this._host.setQuery(n.query)}},r.prototype.tabAllowedForKeyboardNav=function(){return!1},r.prototype.allowKeyboardNavCycling=function(){return this._config.allowKeyboardNavCycling},r.prototype.onlyAllowKeyboardNavWithTab=function(n){return this.isGroup(n)},r.prototype.isGroup=function(n){return!!n.suggestions},r.prototype.submit=function(n,i){var u=t.ContextMenus.getSelectedItem(),r;if(u){u.click();return}if(this._lastUpdatedSequenceNumber!=n&&(!this._selectedItem||this._selectedItem==this.getSelectableItems()[0])){this._pendingSubmitSequenceNumber=n;return}this._selectedItem&&(this._instrumentationHelper.instrumentKeyboardSubmitGping(this._selectedItem.instItem.getHValue()),r=this.topResults.indexOf(this._selectedItem)>=0,this.click(this._selectedItem,r,i))},r.prototype.click=function(n,t,i){if(n.click){if(this.isGroup(n)){n.click();return}var r=n;i=i||this._host.getModifierKeyState(),i.ctrlKey&&i.shiftKey?this.launchAsAdmin(r,t):r.click(t);this.onItemLaunch(r)}},r.prototype.launchAsAdmin=function(n,t){var i=this;this.getDeviceItemVerbsAsync(n,function(r){var u=!1;r.forEach(function(n){n.verb=="RunAs"&&(i._instrumentationHelper.instrumentItemClick(i._lastUpdatedSequenceNumber),n.executeAsync(),u=!0)}),u||n.click(t)})||n.click(t)},r.prototype.showContextMenu=function(n,i,r){var u=this;this.getDeviceItemVerbsAsync(n,function(f){return t.ContextMenus.showContextMenu(f,i,r,function(){u._instrumentationHelper.instrumentItemClick(u._lastUpdatedSequenceNumber),u._instrumentationHelper.instrumentKeyboardSubmitGping(n.instItem.getHValue())})})},r.prototype.getDeviceItemVerbsAsync=function(n,i){var r=t.getItemWithFileMetadata(n);return r&&r.canHaveContextMenu?(t.Promise.safeChain("getVerbsAsync",function(){return r.getVerbsAsync()},function(n){return i(n)}),!0):!1},r.prototype.getGroupHeaderClickAction=function(n,i,r,u){var e=this;switch(i){case 0:return this.getLaunchMyStuffAction(n,1,t.MyStuffFormCodes.GroupHeader,u);case 1:return this.getLaunchMyStuffAction(n,2,t.MyStuffFormCodes.GroupHeader,u);case 7:return this.getLaunchMyStuffAction(n,6,t.MyStuffFormCodes.GroupHeader,u);case 8:return this.getLaunchMyStuffAction(n,8,t.MyStuffFormCodes.GroupHeader,u);case 4:return this.getLaunchMyStuffAction(n,3,t.MyStuffFormCodes.GroupHeader,u);case 5:return this.getLaunchMyStuffAction(n,4,t.MyStuffFormCodes.GroupHeader,u);case 6:return this.getLaunchMyStuffAction(n,5,t.MyStuffFormCodes.GroupHeader,u);case 9:return this.getLaunchMyStuffAction(n,9,t.MyStuffFormCodes.GroupHeader,u);case 10:return function(){return e.launchStore(n,u)};case 11:return function(){return e.launchSearch(n,r,u)};case 12:return function(){return e.launchFolder(e.getFolderPathForPathCompletion(n),u)};case 2:case 3:return null}},r.prototype.setupIcon=function(n,t,i,r){var u=this;t.getIcon?(this._instrumentationHelper.notifyIconPending(n,i,t.instItem.getKValue(),t.type),t.getIcon(i,function(f){t.icon=f,n==u._sequenceNumberReader.getSequenceNumber()&&(u._instrumentationHelper.notifyIconReady(n,i,t.instItem.getKValue(),t.type),i?u.topResults.indexOf(t)>=0&&u.renderTopResults():u.groups.some(function(n){return n.suggestions.indexOf(t)>=0})&&u.renderGroups(),r&&r(),u._instrumentationHelper.tryInstrumentRenderStopped(n))})):r&&r()},r.prototype.addSuggestionToGroup=function(n,t,i){i.suggestions.push(t),this.setupIcon(n,t,!1);this._groupState.onSuggestionAdded(t,i)},r.prototype.getFolderPathForPathCompletion=function(n){return n.queryToFetch.substring(0,this._partialQuery.queryToFetch.lastIndexOf("\\"))},r.prototype.getGroupTitle=function(n,t){return t==12?this.getFolderPathForPathCompletion(n)+"\\"+String.fromCharCode(8206):t==13?"Power BI Insights":this._host.getLocString(u(t))},r.prototype.createGroup=function(i,r,u){var s=t.GroupHeaderQSCodes[r],f=this.getGroupHeaderClickAction(i,r,s,u,o),o,e;if(f&&!s)throw"No QS code for: "+r;o=f?n.InstrumentedItem.getNonSuggestionInstrumentedItem(s):null,e={type:r,id:"gr"+r,title:this.getGroupTitle(i,r),click:f,suggestions:[],instRegionName:t.GroupType[r],instItem:o,selectable:f!=null,selected:!1};this._groupState.onGroupAdded(e);return e},r.prototype.getSuggestions=function(n){var t=this.topResults.slice(0);return this.groups.forEach(function(n){return t=t.concat(n.suggestions)}),n&&(t=t.concat(this._groupState.getAllPendingSuggestions())),t},r.prototype.getCurrentTopResults=function(){return this.topResults.slice(0)},r.prototype.updateTopResults=function(t,i,r){var u=this,o,e;t!=(r!=this._lastUpdatedSequenceNumber)&&n.reportException(new Error("Precondition failed: forNewQuery "+t+" != (sequenceNumber "+r+" != lastUpdateSequenceNumber "+this._lastUpdatedSequenceNumber+")"),"updateTopResult");var c=this._selectedItem,s=!n.sequenceEqual(i,this.topResults),h=function(){return u._instrumentationHelper.instrumentTopResultRendered(r,i.map(function(n){return n.type}))},l=!1,f=s?i.length:0;return(s&&(o=!1,this.renderTopResultsAfter(function(){var n=u.topResults;u.topResults=i.slice(0);u._groupState.onTopResultsUpdated(u.topResults);u.topResults.forEach(function(t){n.indexOf(t)>=0?f-=1:u.setupIcon(r,t,!0,function(){f-=1,o&&f==0&&h()})}),u.ensureSelection()}),this._autoComplete&&i.length>0&&this._selectedItem==i[0]&&i[0].canAutocomplete&&this._autoComplete.apply(i[0].query),o=!0),this._selectedItem&&c!=this._selectedItem&&this.topResults.indexOf(this._selectedItem)>=0&&(e=_ge(this._selectedItem.id),e.setAttribute("aria-selected","false"),e.setAttribute("aria-selected","true")),l||f!=0||(s||t)&&h(),this._lastUpdatedSequenceNumber=r,i.length>0&&this._pendingSubmitSequenceNumber==r)?(this._pendingSubmitSequenceNumber=null,this._instrumentationHelper.instrumentKeyboardSubmitGping(i[0].instItem.getHValue()),i[0].click(!0),0):1},r.prototype.ensureSelection=function(){var n=this.getSelectableItems();n.indexOf(this._selectedItem)==-1&&this.select(this.getSuggestions()[0],!1)},r.prototype.allowedInGroups=function(n){return n.handoffType==6?t.isCortanaEnabledCache:!0},r.prototype.addSuggestions=function(i,u,f,e,o){var s=this;return f!=this._lastUpdatedSequenceNumber&&n.reportException(new Error("Precondition failed: sequenceNumber "+f+" != lastUpdateSequenceNumber "+this._lastUpdatedSequenceNumber),"addSuggestions"),this.renderGroupsAfter(function(){i&&s.clearGroups();var n=t.getMaxNumberOfGroups(s._groupState.getResultsCounter())-s.groups.length;e.forEach(function(i){if(s.allowedInGroups(i)){var e=t.getGroupType(i),u=s.groups.filter(function(n){return n.type==e})[0];u?u.suggestions.length<t.MinimumNumberOfSuggestionsPerGroup?s.addSuggestionToGroup(f,i,u):s._groupState.queue(i,u):n>0&&(u=s.createGroup(s._partialQuery,e,f),r.insertGroupWithRank(s.groups,u,o),s.addSuggestionToGroup(f,i,u),n-=1)}}),(n==0||u)&&s._groupState.flush(function(n,t){return s.addSuggestionToGroup(f,n,t)}),s.ensureSelection()}),this._groupState.full()?0:1},r.insertGroupWithRank=function(n,t,i){for(var f=i.indexOf(t.type),u,r=0;r<n.length;r++)if(u=i.indexOf(n[r].type),u>f){n.splice(r,0,t);return}n.push(t)},r.prototype.removeSuggestion=function(n){var i=this;this.renderGroupsAfter(function(){var o=t.getGroupType(n),r=i.groups.filter(function(n){return n.type==o})[0],u=r.suggestions,f=u.indexOf(n),e;if(f>=0){u.splice(f,1);i._groupState.onSuggestionRemoved(n,r)}else i._groupState.removePendingSuggestion(n,r);if(u.length==0){e=i.groups.indexOf(r),i.groups.splice(e,1);i._groupState.onGroupRemoved(r)}i.ensureSelection()})},r.prototype.clearGroups=function(){this.groups=[],this._groupState=new i;this._groupState.onTopResultsUpdated(this.topResults);this.renderGroups()},r.prototype.launchSearch=function(n,t,i,r){this._instrumentationHelper.instrumentItemClick(i);var u=n.queryToFetch||n.fullPartialQuery;this._host.launchSearch(u,this._navigationHelper.getSearchUrl(n.fullPartialQuery,u,t),r)},r.prototype.getLaunchMyStuffAction=function(n,i,r,u){var e=this,f=t.isMyStuffEnabled;return i==8&&f&&(f=this._config.myStuffHasFolderPivot),f?function(){return e.launchMyStuff(n,i,r,u)}:null},r.prototype.launchMyStuff=function(n,i,r,u){this._instrumentationHelper.instrumentItemClick(u);var e=n.queryToFetch||n.fullPartialQuery,f=t.ScopeConfig[i==null?n.scope:i].myStuffPivot;this._host.launchMyStuff(e,f,r,this.groups.map(function(n){return n.type}))},r.prototype.launchStore=function(n,t){this._instrumentationHelper.instrumentItemClick(t);var i=n.queryToFetch||n.fullPartialQuery;this._host.launchStoreSearch(i)},r.prototype.launchFolder=function(n,t){this._instrumentationHelper.instrumentItemClick(t),this._host.launchFolder(n)},r.prototype.renderGroups=function(){this._groupRenderingDisabled||this._page.updateGroupsView(this.groups)},r.prototype.renderGroupsAfter=function(n){var t=this._groupRenderingDisabled;this._groupRenderingDisabled=!0;try{n()}finally{this._groupRenderingDisabled=t,this.renderGroups()}},r.prototype.renderTopResults=function(){this._topResultsRenderingDisabled||this._page.updateTopResultsView(this.topResults)},r.prototype.renderTopResultsAfter=function(n){var t=this._topResultsRenderingDisabled;this._topResultsRenderingDisabled=!0;try{n()}finally{this._topResultsRenderingDisabled=t,this.renderTopResults()}},r.prototype.renderPermanentDisambig=function(){this._page.updatePermanentDisambigView(this.permanentDisambig)},r}();t.RootViewModel=r})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t=function(){function t(t,i){var r=this;this._host=t,this._selectableItemsContainer=i,t.bindKeyDown(function(t,i){if(n.isNavigationKey(t))switch(t){case 38:r.selectNextItem(!0,!1);break;case 40:r.selectNextItem(!1,!1);break;case 9:r._selectableItemsContainer.tabAllowedForKeyboardNav()&&r.selectNextItem(i.shiftKey,!0)}})}return t.prototype.selectNextItem=function(n,t){var o=this,r=this._selectableItemsContainer.getSelectableItems(),e=this._selectableItemsContainer.getSelectedItem(),i=e?r.indexOf(e):-1,f,u;if(!this._selectableItemsContainer.allowKeyboardNavCycling())if(n){if(i==0)return}else if(i==r.length-1)return;f=t?function(){return!0}:function(n){return!o._selectableItemsContainer.onlyAllowKeyboardNavWithTab(n)};do i=n?i<=0?r.length-1:i-1:(i+1)%r.length,u=r[i];while(!f(u));this._selectableItemsContainer.select(u,!0)},t}();n.KeyboardEvtHandler=t})(AutoSuggest||(AutoSuggest={}));
//]]></script><script type="text/javascript" src="/rms/rms%20answers%20AutoSuggest%20Modules$Aggregators$FastRankModel/jc/a129a4d8/019ae10c.js"></script><script type="text/javascript" src="/rms/rms%20answers%20AutoSuggest%20Modules$Aggregators$TopHitConfidenceModel/jc/8b3b3f0d/a2d42288.js"></script><script type="text/javascript">//<![CDATA[
var AutoSuggest;(function(n){var t;(function(n){var t;(function(t){t.suggestionRankingModel,t.topHitConfidenceModel,t.suggestionRankingModelId,t.topHitConfidenceModelId;var i=function(){function i(n){this.config=n}return i.prototype.rank=function(n,t,i,r,u,f){var e,o;return this.orderSuggestions(n,t,i,r,u,f),e=this.filterOutNonHcStoreCortanaCommandAndWebSuggestions(t),n.scope==12?t.length>0&&(t[0].topHitConfidenceScore=1):this.populateTopHitConfidenceScore(e,r),o=this.createTopHitSuggestionList(e,this.config.multipleTopHitMinConfidenceScore,this.config.multipleTopHitMinConfidenceSum,this.config.multipleTopHitSecondaryMinConfidenceScore),this.createRankerResponse(n,t,o,i)},i.prototype.orderSuggestions=function(n,i,r,u,f,e){var h,o,s;if(n.scope!=12){for(r.searchTheWeb?i.push(r.searchTheWeb):r.searchMyStuff&&i.push(r.searchMyStuff),h=this.createFeatureStore(n.queryToFetch,i,u,f,e),o=0;o<i.length;o++)s=h[o],i[o].rankingScore=t.suggestionRankingModel(s),i[o].featureStore=s;i.sort(function(n,t){return t.rankingScore-n.rankingScore})}this.putCommandSuggestionOnTop(i)},i.prototype.putCommandSuggestionOnTop=function(t){for(var i=-1,u,r=0;r<t.length;r++)if(n.tryGetGroupType(t[r])==3){t[r].hc&&(i=r);break}while(i>0)u=t[i-1],t[i-1]=t[i],t[i]=u,i--},i.prototype.filterOutNonHcStoreCortanaCommandAndWebSuggestions=function(t){return t.filter(function(t){var i=n.tryGetGroupType(t);return i==10?!1:[11,3].indexOf(n.tryGetGroupType(t))!=-1&&!t.hc?!1:!0})},i.prototype.populateTopHitConfidenceScore=function(n,i){var f,e,u,r;for(f=i&&i.WebReturned?this.config.maxNumberOfTopResults:1,e=Math.min(f,n.length),u=0;u<e;u++)r=n[u].featureStore,r[45]=n[u].rankingScore,r[43]=u,r[44]=n[0].featureStore[45]-r[45],r[46]=t.topHitConfidenceModel(r),n[u].topHitConfidenceScore=r[46]},i.prototype.createTopHitSuggestionList=function(t,i,r,u){for(var e=[],o=0,h=-1,s=-1,f=0;f<t.length;f++)if(typeof t[f].topHitConfidenceScore!="undefined")t[f].topHitConfidenceScore>i&&(h=f),t[f].topHitConfidenceScore>u&&(o=o+t[f].topHitConfidenceScore,s=f);else break;return h>-1?e=t.splice(0,h+1):o>r&&s>-1&&(e=t.splice(0,s+1)),e.length==0&&t.length>0&&n.tryGetGroupType(t[0])==3&&t[0].hc&&e.push(t[0]),e},i.prototype.createRankerResponse=function(n,t,i){var e=!1,f,u;return i=i.filter(function(n){if(n.handoffType==0){if(e)return!1;e=!0}return!0}),f=t.filter(function(n){return!n.isSynthetic&&i.indexOf(n)==-1}),u=this.getGroupOrder(f),{topResults:i,groupOrder:u}},i.prototype.getGroupOrder=function(t){var i=[];return t.forEach(function(t){var r=n.getGroupType(t);i.indexOf(r)==-1&&i.push(r)}),i},i.prototype.createFeatureStore=function(t,i,r,u,f){var w=[],s=0,k=0,b=0,l=0,p=0,nt=0,c=0,g=0,d=0,v=0,a=0,y=0,h=t.toLowerCase(),o,e;for(i.forEach(function(t){if(t.handoffType==2){k++,t.query&&h==t.query.toLowerCase()&&y++;var i=n.getAppItem(t);i?(t.type==n.LocalSuggestionTypes.App&&b++,i.totalLaunches>l&&(l=i.totalLaunches),i.lastAccessed&&i.lastAccessed.getFullYear()!=1600||s++):s++,t.deviceItem&&t.deviceItem.rankScore>c&&(c=t.deviceItem.rankScore)}else s++;t.type==n.OnlineSuggestionTypes.LocalCity&&p++,(t.handoffType==0||t.handoffType==1)&&nt++,n.tryGetGroupType(t)==2&&g++,t.type==n.OnlineSuggestionTypes.DirectNav&&d++,t.query&&t.query.toLowerCase()==h&&(v++,n.tryGetGroupType(t)==11&&a++)}),o=0;o<i.length;o++)e=this.getSuggestionFeatureStore(h,i[o],f,r),e[77]=s,e[73]=k,e[80]=b,e[13]=l,e[78]=p,e[72]=nt,e[7]=c,e[81]=g,e[79]=d,e[74]=v,e[75]=a,e[76]=y,e[60]=CortanaApp.isMobile?1:0,e[93]=r&&r.WebReturned?1:0,this.setMRUSignal(i[o],e,u),w.push(e);return w},i.prototype.getSuggestionFeatureStore=function(t,i,r,u){var f={},e,s,h,o;return this.setTypeSignal(i,f),e=n.getAppItem(i),e?(f[2]=e.totalLaunches,f[92]=e.launchArguments?1:0,e.lastAccessed&&e.lastAccessed.getFullYear()!=1600||(f[19]=1),e.lastAccessed&&e.lastAccessed.getFullYear()!=1600&&(s=Math.abs(Date.now()-e.lastAccessed.getTime()),h=s/864e5,f[9]=h)):(f[19]=1,f[68]=1),f[96]=i.catalogScore,f[97]=i.avgRating,f[98]=i.ratingCount,f[99]=i.confidence,typeof i.highConfidenceMetaSuggestionScore!="undefined"?f[17]=i.highConfidenceMetaSuggestionScore:f[69]=1,i.deviceItem&&typeof i.deviceItem.rankScore!="undefined"?f[16]=i.deviceItem.rankScore:f[4]=1,f[23]=i.prefetchConfidenceScore,this.setThresholdRatios(f,u),this.setRatios(f,u),this.setEngagementSignals(i,f,r),f[10]=t.length,n.tryGetGroupType(i)==2&&(f[11]=1),f[65]=!i.query||n.isSensitiveSuggestionType(i)?1:0,f[20]=i.query&&i.query.toLowerCase()==t&&!n.isSensitiveSuggestionType(i)?1:0,i.handoffType==2?(f[8]=1,n.isSetting(i)&&(f[64]=1),n.isApp(i)&&(f[83]=1)):f[8]=0,i.isSynthetic&&(f[66]=1),n.tryGetGroupType(i)==11&&(f[82]=1),(i.handoffType==0||i.handoffType==1)&&(f[25]=1),o=f[65]==1||f[66]==1||n.isSensitiveSuggestionType(i),f[14]=o?0:n.getEditDistanceIgnoreCase(t,i.query),f[22]=o?0:Math.min(100,this.computeEditDistanceRatio(f[14],t.length,i.query.length)),f[70]=o?0:this.isWordBoundary(t,i.query),f[15]=o?t.length:i.query.length,f[25]==1&&(f[71]=f[20]),f[8]==1&&(f[27]=f[20]),f[67]==1&&(f[55]=f[20]),f[41]=f[83]==1?f[40]:f[64]==1?f[39]:f[84]==1?f[32]:f[89]==1?f[54]:f[85]==1?f[30]:f[86]==1?f[53]:f[87]==1?f[52]:f[61]==1?f[31]:f[88]==1?f[51]:f[62]==1?f[33]:f[63]==1?f[35]:f[82]==1?f[29]:f[90]==1?f[50]:f[59]==1?f[34]:f[58]==1?f[36]:f[37],f},i.prototype.setMRUSignal=function(t,i,r){var f,u;r&&(f=n.getSuggestionKey(t),r[f]&&(u=r[f],i[47]=u.prefixLaunchCount,i[49]=u.lastLaunchTime))},i.prototype.setEngagementSignals=function(t,i,r){var e,f,u;r&&(e=n.NonSuggestionQSCodes.Groups[t.type]||n.getGroupType(t),f=t.query,t.type==n.NonSuggestionQSCodes.TopSearchMyStuff?f="SearchMyStuff":t.type==n.NonSuggestionQSCodes.TopSearchTheWeb&&(f="SearchTheWeb"),u=n.getEngagementSignalKey(f,String(e)),r[u]&&(i[6]=r[u].Loglikelihood,i[3]=r[u].ProbSugClickGivenBackground,i[0]=r[u].ProbSugClickGivenPref,i[94]=r[u].CCR,i[95]=r[u].EventCount))},i.prototype.setTypeSignal=function(t,i){n.tryGetGroupType(t)==2&&(i[84]=1),i[67]=t.handoffType==5||t.handoffType==6?1:0;switch(t.type){case n.LocalSuggestionTypes.Email:i[62]=1;break;case n.LocalSuggestionTypes.File:i[61]=1;break;case n.LocalSuggestionTypes.Photo:i[85]=1;break;case n.LocalSuggestionTypes.Video:i[86]=1;break;case n.LocalSuggestionTypes.Music:i[87]=1;break;case n.LocalSuggestionTypes.Folder:i[88]=1;break;case n.LocalSuggestionTypes.CommandLine:i[89]=1;break;case n.LocalSuggestionTypes.PathCompletion:i[90]=1;break;case n.LocalSuggestionTypes.App:i[1]=1;break;case n.OnlineSuggestionTypes.DirectNav:i[21]=1;break;case n.OnlineSuggestionTypes.Store:i[63]=1;break;case n.NonSuggestionQSCodes.TopSearchTheWeb:case n.NonSuggestionQSCodes.PersistentSearchTheWeb:i[59]=1;break;case n.NonSuggestionQSCodes.TopSearchMyStuff:case n.NonSuggestionQSCodes.PersistentSearchMyStuff:i[58]=1}},i.prototype.setRatios=function(n,t){t&&typeof t.AppsRatio!="undefined"&&(n[26]=t.AppsRatio,t.SettingsRatio&&(n[5]=t.SettingsRatio),t.StoreRatio&&(n[57]=t.StoreRatio),t.PrefixProbability&&(n[12]=t.PrefixProbability),t.FilesRatio&&(n[24]=t.FilesRatio),t.WebRatio&&(n[18]=t.WebRatio),t.PhotosVideosMusicRatio&&(n[28]=t.PhotosVideosMusicRatio),t.ContactsRatio&&(n[56]=t.ContactsRatio),t.LocalProtocolRatio&&(n[91]=t.LocalProtocolRatio))},i.prototype.setThresholdRatios=function(n,t){t&&typeof t.ThApps!="undefined"?(n[40]=t.ThApps,t.ThStore&&(n[35]=t.ThStore),t.ThSetting&&(n[39]=t.ThSetting),t.ThCortAns&&(n[32]=t.ThCortAns),t.ThPrefixCount&&(n[38]=t.ThPrefixCount),t.ThWeb&&(n[29]=t.ThWeb),t.ThSearchTheWeb&&(n[34]=t.ThSearchTheWeb),t.ThOther&&(n[37]=t.ThOther),t.ThSearchMyStuff&&(n[36]=t.ThSearchMyStuff),t.ThFile&&(n[31]=t.ThFile),t.ThFolder&&(n[51]=t.ThFolder),t.ThPath&&(n[50]=t.ThPath),t.ThEmail&&(n[33]=t.ThEmail),t.ThCommAns&&(n[54]=t.ThCommAns),t.ThPhotoAns&&(n[30]=t.ThPhotoAns),t.ThVideoAns&&(n[53]=t.ThVideoAns),t.ThMusicAns&&(n[52]=t.ThMusicAns)):n[42]=1},i.prototype.computeEditDistanceRatio=function(n,t,i){var r=0,u;return(t>0||i>0)&&(t>0&&i>0?(i>t&&(u=t,t=i,i=u),r=n/(t-n+i)):r=Number.MAX_VALUE),r},i.prototype.isWordBoundary=function(n,t){return!n||!t?0:n.length+1<=t.length&&t[n.length]==" "?1:n.length==t.length?1:0},i}();t.FastRankRanker=i,t.ranker=new i(sa_config)})(t=n.Ranking||(n.Ranking={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(t){var i;(function(i){function e(n,i,r){var w=t.getFileItem(i),v,l,y,e,a,c;if(w){if(v=w.id,v&&(v.indexOf("\\.")>-1||v.indexOf("/.")>-1))return!0}else if(l=t.getAppItem(i),l){if((e=l.id,s.indexOf(e)>=0)||n&&n.suppressedAppIds.indexOf(e)>=0||r.suppressDesktopAppsBasedOnExtensionAndIdPrefix&&!l.isImmersive&&(h.indexOf(e)>=0||(y=l.extension,y&&u.indexOf(y.toLowerCase())<0)||f.test(e)))return!0}else if(t.isSetting(i)){if((e=i.deviceItem.id,o.indexOf(e)>=0)||n&&n.suppressedSettingIds.some(function(n){return e.indexOf(n)>=0}))return!0}else if(a=t.getCommandLineItem(i),a){if(c=i.query.split(" ")[0].toLowerCase(),c.indexOf("\\")>=0||c.indexOf(":")==1)return!1;var e=a.id.toLowerCase(),p=e.lastIndexOf("."),k=e.lastIndexOf("\\"),b=a.kind=="folder"||p<0||p<k;if(b&&c.indexOf("%")<0||[".exe",".com"].every(function(n){return c.indexOf(n)<0})&&(t.BlacklistedSystemCommands.some(function(n){return e.indexOf(n)>=0})||!a.launchArguments&&t.BlacklistedSystemCommandsWhenNoArgs.some(function(n){return e.indexOf(n)>=0})||t.BlacklistedCommands.indexOf(c)>=0))return!0}return!1}var r;i.ranker,r=function(){function r(n,t,i,r){this._config=n,this._host=t,this._instrumentationHelper=i,this._navigationHelper=r}return r.prototype.launchProtocol=function(n,t){this._instrumentationHelper.instrumentItemClick(t),this._host.launchUrl(n.fixedUrl)},r.prototype.launchSearch=function(n,i,r){this._instrumentationHelper.instrumentItemClick(i);var u=n.queryToFetch||n.fullPartialQuery;this._host.launchSearch(u,this._navigationHelper.getSearchUrl(n.fullPartialQuery,u,t.NonSuggestionQSCodes.TopSearchTheWeb),r)},r.prototype.launchMyStuff=function(n,i,r){this._instrumentationHelper.instrumentItemClick(r);var f=n.queryToFetch||n.fullPartialQuery,u=t.ScopeConfig[i].myStuffPivot;this._host.launchMyStuff(f,u,this._config.targetLinkFormCode,this._groupOrder)},r.prototype.getProtocol=function(i,r){var f=this,e=i.fixedUrl,u=t.createSuggestion(n.HitHighlighting.addMarkers(i.fixedUrl,i.fixedUrl),null,null,this._host.getBrowserIcon,null,t.NonSuggestionQSCodes.Protocol,null,null,n.InstrumentedItem.getNonSuggestionInstrumentedItem(t.NonSuggestionQSCodes.Protocol),null,1,"tp",function(){return f.launchProtocol(i,r)},!0);return u.updateFromQuery=function(t){return t.isProtocol?(u.text=n.HitHighlighting.addMarkers(t.fixedUrl,t.fixedUrl),!0):!1},u},r.prototype.getSearchMyStuff=function(i,r){var o=this,u=t.ScopeConfig[i.scope],e=i.queryToFetch||i.fullPartialQuery,f=t.createSuggestion(n.HitHighlighting.addMarkers(e,e),this._host.getLocString(u.myStuffLocString),t.CssClass_Annotation,null,{content:u.myStuffIcon,type:1,needsAccentColor:u.myStuffIcon==t.ClientFontIcons.WindowsLogo},t.NonSuggestionQSCodes.TopSearchMyStuff,null,null,n.InstrumentedItem.getNonSuggestionInstrumentedItem(t.NonSuggestionQSCodes.TopSearchMyStuff),null,4,"tsms",function(){return o.launchMyStuff(i,i.scope,r)},!0);return f.updateFromQuery=function(t){var i=t.queryToFetch||t.fullPartialQuery;return f.text=n.HitHighlighting.addMarkers(i,i),!0},f},r.prototype.getSearchTheWeb=function(i,r){var e=this,f=i.queryToFetch||i.fullPartialQuery,u=t.createSuggestion(n.HitHighlighting.addMarkers(f,f),this._host.getLocString("BingSearchAnnotation"),t.CssClass_Annotation,null,{content:t.ClientFontIcons.Search,type:1},t.NonSuggestionQSCodes.TopSearchTheWeb,null,null,n.InstrumentedItem.getNonSuggestionInstrumentedItem(t.NonSuggestionQSCodes.TopSearchTheWeb),null,0,"tstw",function(n){return e.launchSearch(i,r,n)},!0);return u.updateFromQuery=function(t){var i=t.queryToFetch||t.fullPartialQuery;return u.text=n.HitHighlighting.addMarkers(i,i),!0},u},r.prototype.getSyntheticSuggestions=function(i,r){var u=i.scope!=11&&t.isMyStuffEnabled?this.getSearchMyStuff(i,r):null,f=t.isBingEnabledCache&&(!u||i.scope==11||i.scope==0&&n.isBrowserOnline())?this.getSearchTheWeb(i,r):null;return{searchMyStuff:u,searchTheWeb:f}},r.prototype.canHaveDuplicates=function(i){switch(i){case t.LocalSuggestionTypes.App:case t.LocalSuggestionTypes.BCSApp:case t.ResponseTypes.OnlineSuggestionsThatMapToApps:case t.LocalSuggestionTypes.Setting:case t.LocalSuggestionTypes.BCSSetting:case t.OnlineSuggestionTypes.SpellCorrectedSetting:case n.WebResponseType:case t.ResponseTypes.ReactiveAgents:case t.ResponseTypes.AppRelatedReactiveAgents:case t.LocalSuggestionTypes.CommandLine:case t.LocalSuggestionTypes.PathCompletion:return!0}return!1},r.prototype.canHaveDuplicatesWithinResponse=function(){return!1},r.prototype.isDuplicate=function(n,i,r){if(i.actionUri&&i.actionUri==r.actionUri)return!0;if(i.type==t.LocalSuggestionTypes.Cat1_LaunchApp&&t.isApp(r))return t.getRafItem(i).appId==r.deviceItem.id;if(r.type==t.LocalSuggestionTypes.Cat1_LaunchApp&&t.isApp(i))return t.getRafItem(r).appId==i.deviceItem.id;if(i.type==t.LocalSuggestionTypes.CommandLine&&t.isApp(r)||r.type==t.LocalSuggestionTypes.CommandLine&&t.isApp(i)){var f=t.getAppItem(i)||t.getAppItem(r),u=t.getCommandLineItem(i)||t.getCommandLineItem(r);return f.filePath&&u.encodedPath&&f.filePath.toLowerCase()==u.encodedPath.toLowerCase()?!u.launchArguments||(f.launchArguments||"").toLowerCase()==u.launchArguments.toLowerCase()||!f.launchArguments&&u.launchArguments&&f.displayName.toLowerCase().indexOf(u.displayName.toLowerCase())==0:!1}return i.deviceItem&&r.deviceItem?t.isApp(i)||t.isApp(r)?i.deviceItem.id!=r.deviceItem.id?!1:(i.appContext||"").toLowerCase()==(r.appContext||"").toLowerCase():i.deviceItem.id&&r.deviceItem.id&&i.deviceItem.id.toLowerCase()==r.deviceItem.id.toLowerCase():!1},r.prototype.rank=function(r,u,f,o,s,h,c){var it=this,p=f?f[t.ResponseTypes.BingContentStore]:null,a=f?f[n.WebResponseType]:null,v=f?f[t.ResponseTypes.MRUSignals]:null,b,g,l,d,k;a&&(a.WebReturned=!0),!a&&v&&v.RankingSignals&&(a=v.RankingSignals,a.WebReturned=!1),b=null,a?b=this.parseWebEngagementSignals(a):p&&p.engagementSignals&&(b=p.engagementSignals),g=u.filter(function(n){return n.handoffType==0||n.handoffType==1}),u=u.filter(function(n){return!e(p,n,it._config)});var nt=u.concat(r.filter(function(n){return!n.isSynthetic})),y=this.getSyntheticSuggestions(o,c),tt=v?v.PrefixSuggestions:null,w=i.ranker.rank(o,nt,y,a,tt,b);return this._config.logRankerOutput&&this._instrumentationHelper.instrumentSyntheticSuggestions(c,nt.filter(function(n){return n.isSynthetic})),u.sort(function(n,t){return t.rankingScore-n.rankingScore}),u=this.insertWebToRightPlace(u,g),d=this._config.maxNumberOfTopResults,h?l=[]:o.isProtocol?(l=w.topResults.filter(function(n){return n.type==t.OnlineSuggestionTypes.DirectNav}),l.length==0&&l.push(this.getProtocol(o,c))):(k=s.filter(function(n){return!n.isSynthetic}),l=k.concat(w.topResults.filter(function(n){return k.indexOf(n)==-1}))),l.length==0&&(y.searchTheWeb?l.push(y.searchTheWeb):y.searchMyStuff&&l.push(y.searchMyStuff)),l.length>d&&(l=l.slice(0,d)),this._groupOrder=w.groupOrder,{topResults:l,suggestionsToAdd:u,groupOrder:w.groupOrder}},r.prototype.parseWebEngagementSignals=function(n){var u={},i,f;if(n&&n.Suggestions){var e=n.Suggestions.split("\t"),v=n.ProbSugClickGivenPrefs.split("\t"),a=n.ProbSugClickGivenBackground.split("\t"),l=n.Loglikelihoods.split("\t"),h=n.SuggestionGroups.split("\t"),r=e.length;if(a.length==r&&v.length==r&&l.length==r&&h.length==r)for(i=0;i<e.length;i++)u[t.getEngagementSignalKey(e[i],h[i])]={Loglikelihood:+l[i],ProbSugClickGivenBackground:+a[i],ProbSugClickGivenPref:+v[i],SuggestionGroup:+h[i]}}if(n&&n.CCRSuggestions){var y=n.CCRSuggestions.split("\t"),s=n.CCRSuggestionGroups.split("\t"),o=n.CCRs.split("\t"),c=n.EventCounts.split("\t"),r=y.length;if(s.length==r&&o.length==r&&c.length==r)for(i=0;i<r;i++)f=t.getEngagementSignalKey(y[i],s[i]),u[f]?(u[f].CCR=+o[i],u[f].EventCount=+c[i]):u[f]={SuggestionGroups:+s[i],CCR:+o[i],EventCount:+c[i]}}return u},r.prototype.insertWebToRightPlace=function(n,t){var f,u;if(t&&t.length>0){f=-1e3,t.forEach(function(n){n.rankingScore>f&&(f=n.rankingScore)});for(var i=n.filter(function(n){return n.handoffType!=0&&n.handoffType!=1}),e=!1,r=0;!e&&r<i.length;){if(i[r].rankingScore<f){for(u=t.length-1;u>=0;u--)i.splice(r,0,t[u]);e=!0}r++}return e||(i=i.concat(t)),i}return n},r}(),i.Aggregator=r;var o=["Classic_{E9C71548-B580-43B2-ACDB-1BA924002754}","ControlPanel","NameSpace_Classic_{D8559EB9-20C0-410E-BEDA-7ED416AECC2A}",],s=["Microsoft.Cortana_8wekyb3d8bbwe!CortanaUI","Microsoft.Windows.Cortana_cw5n1h2txyewy!CortanaUI",],h=["Microsoft.Windows.Pictures","Microsoft.Windows.Documents","Microsoft.Windows.Computer",],u=[".exe",".com",".cmd",".bat",],f=/^https?:\/\//})(i=t.Ranking||(t.Ranking={}))})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t=function(){function t(n,t,i,r,u,f){this._lastUsedId=-1,this._sequenceNumber=-1,this._suggestionsQueue={},this._arrivedResponses=[],this._isAnySuggestionRendered=!1,this._canFlush=!1,this._full=!1,this._allResponseTypesArrived=!1,this._config=n,this._host=i,this._instrumentationHelper=r,this._aggregator=u,this._settings=t,this._rootViewModel=f}return t.prototype.setDefaultTopResult=function(n){this._defaultTopResultSequenceNumber=n},t.prototype.initiateSequenceNumber=function(t,i){var r=this;if(this._sequenceNumber>=t){n.reportException(new Error("Unexpected sequence number"),"initiateSequenceNumber");return}this.resetStateForNewQuery(t,i),this._highPriorityResponseTypes=[],this._normalPriorityResponseTypes=[],this._lowPriorityResponseTypes=[],this._settings.allResponseTypes().filter(function(t){return n.isResponseTypeEnabled(t,i,r._config)}).forEach(function(n){r._config.highPriorityProviderResponses.indexOf(n)>=0?r._highPriorityResponseTypes.push(n):r._config.lowPriorityProviderResponses.indexOf(n)>=0?r._lowPriorityResponseTypes.push(n):r._normalPriorityResponseTypes.push(n)}),this._config.providerResponsesMaximumWaitTime>0&&(this._bufferingTimer=sb_st(function(){r._bufferingTimer=null,r.processSuggestions(!0)},this._config.providerResponsesMaximumWaitTime))},t.prototype.queueSuggestions=function(t,i,r,u){if(t>this._sequenceNumber){n.reportException(new Error("Unexpected sequence number"),"queueSuggestions");return}if(!(t<this._sequenceNumber)){if(this._suggestionsQueue[i]){n.reportException(new Error("Duplicate "+i+" response"),"queueSuggestions");return}if(this._highPriorityResponseTypes.indexOf(i)<0&&this._normalPriorityResponseTypes.indexOf(i)<0&&this._lowPriorityResponseTypes.indexOf(i)<0){n.reportException(new Error("Unexpected "+i+" response"),"queueSuggestions");return}this._suggestionsQueue[i]={suggestions:r,responseType:i,updated:!1},u&&(this._extraSignalsMap[i]=u),this._arrivedResponses.push(i),this._allResponseTypesArrived=this._arrivedResponses.length==this._highPriorityResponseTypes.length+this._normalPriorityResponseTypes.length+this._lowPriorityResponseTypes.length,this._allResponseTypesArrived&&this._instrumentationHelper.notifyAllProvidersArrived(this._sequenceNumber),this._full||this.processSuggestions(!1)}},t.prototype.resetState=function(){this.setDefaultTopResult(null),this.resetStateForNewQuery(-1,null)},t.prototype.resetStateForNewQuery=function(n,t){this._arrivedResponses=[],this._sequenceNumber=n,this._partialQuery=t,this._suggestionsQueue={},this._extraSignalsMap={},this._isAnySuggestionRendered=!1,this._canFlush=!1,this._full=!1,this._allResponseTypesArrived=!1,this._bufferingTimer&&(sb_ct(this._bufferingTimer),this._bufferingTimer=null)},t.prototype.getDependencies=function(t){var i=this;return this._settings.responseTypeDependencies(t).filter(function(t){return n.isResponseTypeEnabled(t,i._partialQuery,i._config)})},t.prototype.processSuggestions=function(n){var t=this,o=[],e=[],i,l=function(n,r){if(!n.updated&&t.getDependencies(r).every(function(n){return t._arrivedResponses.indexOf(n)>=0})){if(e.push(r),n.suggestions.length>0){i||(i=t._isAnySuggestionRendered?t._rootViewModel.getSuggestions(!0):[]);var s=t.removeDuplicatesAndAssignIds(n.suggestions,i,o,r),u=t._partialQuery.enabledProviderResponses?t._partialQuery.enabledProviderResponses.filter(function(n){return n.responseType==r})[0]:null,f=!1;s.forEach(function(n){u&&u.suggestionIsEnabled&&!u.suggestionIsEnabled(n)||(f=!0,o.push(n))})}n.updated=!0}},c=!0,a,s,u,r,f;for(u in this._highPriorityResponseTypes)if(r=this._highPriorityResponseTypes[u],a=this._suggestionsQueue[r],a)l(a,r);else if(c=!1,!(this._config.providerResponsesMaximumWaitTime>0)||this._bufferingTimer!=null)break;if(this._bufferingTimer&&c){s=!0;for(u in this._normalPriorityResponseTypes)if(r=this._normalPriorityResponseTypes[u],!this._suggestionsQueue[r]){s=!1;break}s&&(sb_ct(this._bufferingTimer),this._bufferingTimer=null)}f=!1,f=this._config.providerResponsesMaximumWaitTime>0?this._bufferingTimer==null:c,f&&(this._normalPriorityResponseTypes.forEach(function(n){var i=t._suggestionsQueue[n];i&&l(i,n)}),this._lowPriorityResponseTypes.forEach(function(n){var i=t._suggestionsQueue[n];i&&l(i,n)}));var y=this._arrivedResponses.filter(function(n){return t._highPriorityResponseTypes.indexOf(n)>=0||t._normalPriorityResponseTypes.indexOf(n)>=0}).length,p=y==this._highPriorityResponseTypes.length+this._normalPriorityResponseTypes.length,v=!1,h=n&&!this._isAnySuggestionRendered;!this._canFlush&&p&&(this._canFlush=!0,h=!0),(o.length>0||h)&&(i||(i=this._isAnySuggestionRendered?this._rootViewModel.getSuggestions(!0):[]),this.addSuggestions(i,o,e,h),v=!0),e.length>0&&this._instrumentationHelper.instrumentRenderFinished(this._sequenceNumber,e),v&&this._host.adjustSize(),this._allResponseTypesArrived&&(this._full=!0),this._full&&(this._instrumentationHelper.notifyFull(this._sequenceNumber),this._instrumentationHelper.tryInstrumentRenderStopped(this._sequenceNumber))},t.prototype.addSuggestions=function(n,t,i,r){var f=this,s=this._isAnySuggestionRendered?this._rootViewModel.getCurrentTopResults():[],h=this._defaultTopResultSequenceNumber==this._sequenceNumber,u=this._instrumentationHelper.profileKeystroke(this._sequenceNumber,function(){return"Aggregator"+i},function(){return f._aggregator.rank(n,t,f._extraSignalsMap,f._partialQuery,s,h,f._sequenceNumber)}),e,o;(this._instrumentationHelper.instrumentAggregatorCall(this._sequenceNumber,u),t=u.suggestionsToAdd,t.length!=0||r)&&(s.forEach(function(i){i.isSynthetic||t.unshift(i),n.splice(n.indexOf(i),1)}),u.topResults.forEach(function(i){var u=n.indexOf(i)>=0,r;u?f._rootViewModel.removeSuggestion(i):(r=t.indexOf(i),r>=0&&t.splice(r,1))}),e=!this._isAnySuggestionRendered,e&&(this._isAnySuggestionRendered=!0,this._instrumentationHelper.instrumentRenderingStarted(this._sequenceNumber),this._rootViewModel.setExtraSignalsMap(this._extraSignalsMap)),o=this._rootViewModel.updateTopResults(e,u.topResults,this._sequenceNumber),o==1&&this._rootViewModel.addSuggestions(e,this._canFlush,this._sequenceNumber,t,u.groupOrder)==0&&(this._full=!0))},t.prototype.removeDuplicatesAndAssignIds=function(t,i,r,u){var o=this,s,h,f,e;if(this._aggregator.canHaveDuplicates(u)){for(s=[],h=0;h<t.length;++h){if(f=t[h],e=n.indexOf(i,function(n){return o._aggregator.isDuplicate(o._partialQuery,n,f)}),e>=0){this._instrumentationHelper.instrumentDuplicate(this._sequenceNumber,i[e],f);continue}if(e=n.indexOf(r,function(n){return o._aggregator.isDuplicate(o._partialQuery,n,f)}),e>=0){this._instrumentationHelper.instrumentDuplicate(this._sequenceNumber,r[e],f);continue}if(this._aggregator.canHaveDuplicatesWithinResponse(u)&&(e=n.indexOf(s,function(n){return o._aggregator.isDuplicate(o._partialQuery,n,f)}),e>=0)){this._instrumentationHelper.instrumentDuplicate(this._sequenceNumber,s[e],f);continue}f.id||(f.id="id_"+ ++this._lastUsedId),s.push(f)}return s}return t.forEach(function(n){n.id||(n.id="id_"+ ++o._lastUsedId)}),t},t}();n.SuggestionsRenderingManager=t})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t=function(){function n(){this._sequenceNumber=0}return n.prototype.getNextSequenceNumber=function(){return this._sequenceNumber+1},n.prototype.getSequenceNumber=function(){return this._sequenceNumber},n.prototype.incrementSequenceNumber=function(){this._sequenceNumber++},n.prototype.reset=function(){this._sequenceNumber=0},n}();n.SequenceNumberManager=t})(AutoSuggest||(AutoSuggest={}));
//]]></script><script type="text/javascript" src="/rms/rms%20views%20AutoSuggest%20CortanaIcon/jc/7a5f01a7/530fee23.js"></script><script type="text/javascript" src="/rms/rms%20views%20AutoSuggest%20Icon/jc/ac3292a6/060f3809.js"></script><script type="text/javascript" src="/rms/rms%20views%20AutoSuggest%20HighlightedText/jc/e8ae0dba/25f0e9f6.js"></script><script type="text/javascript" src="/rms/rms%20views%20AutoSuggest%20WindowsSuggestionThreeLines/jc/b5f7df1b/30f6bcb6.js"></script><script type="text/javascript" src="/rms/rms%20views%20AutoSuggest%20WindowsTopResults/jc/7d8f5e79/c616155a.js"></script><script type="text/javascript" src="/rms/rms%20views%20AutoSuggest%20WindowsSuggestionSingleLine/jc/1ef01986/4e3bcc88.js"></script><script type="text/javascript" src="/rms/rms%20views%20AutoSuggest%20WindowsGroup/jc/e5d681a6/a154ba56.js"></script><script type="text/javascript" src="/rms/rms%20views%20AutoSuggest%20WindowsGroups/jc/0e17ff5a/8bed40e8.js"></script><script type="text/javascript" src="/rms/rms%20views%20AutoSuggest%20WindowsPermanentDisambig/jc/bdc6f7c3/8649feed.js"></script><script type="text/javascript">//<![CDATA[
var AutoSuggest;(function(n){var t;(function(t){var i=function(){function t(n,t){this._viewData={TestHooksEnabled:n.th},this._instHelper=t;var i=CortanaApp.uiLanguage;this._groupsView=Sparkle.render("AutoSuggest:WindowsGroups",{uiCulture:i,properties:{Groups:[]},viewData:this._viewData},_ge("groups")),this._topResultsView=Sparkle.render("AutoSuggest:WindowsTopResults",{uiCulture:i,properties:{Suggestions:[]},viewData:this._viewData},_ge("topResults")),this._permanentDisambigView=Sparkle.render("AutoSuggest:WindowsPermanentDisambig",{uiCulture:i,properties:{Suggestions:[]},viewData:this._viewData},_ge("permanentDisambig"))}return t.prototype.setContextMenuHandler=function(n){this._contextMenuHandler=n},t.prototype.setTopResultClickHandler=function(n){this._topResultClickHandler=n},t.prototype.setSuggestionClickHandler=function(n){this._suggestionClickHandler=n},t.prototype.updateGroupsView=function(t){var i=this;this._instHelper.profileKeystroke(n.InstrumentationCommon.INVALID_SEQUENCE_NUMBER,function(){return"Sparkle_groups"},function(){return Sparkle.update(i._groupsView,{uiCulture:CortanaApp.uiLanguage,properties:{Groups:t,ContextMenuHandler:i._contextMenuHandler,ClickHandler:i._suggestionClickHandler},viewData:i._viewData})})},t.prototype.updateTopResultsView=function(t){var i=this;this._instHelper.profileKeystroke(n.InstrumentationCommon.INVALID_SEQUENCE_NUMBER,function(){return"Sparkle_topResult"},function(){return Sparkle.update(i._topResultsView,{uiCulture:CortanaApp.uiLanguage,properties:{Suggestions:t,ContextMenuHandler:i._contextMenuHandler,ClickHandler:i._topResultClickHandler},viewData:i._viewData})})},t.prototype.updatePermanentDisambigView=function(t){var i=this;this._instHelper.profileKeystroke(n.InstrumentationCommon.INVALID_SEQUENCE_NUMBER,function(){return"Sparkle_permDis"},function(){return Sparkle.update(i._permanentDisambigView,{uiCulture:CortanaApp.uiLanguage,properties:{Suggestions:t,ContextMenuHandler:i._contextMenuHandler,ClickHandler:i._suggestionClickHandler},viewData:i._viewData})})},t}();t.Page=i})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));var AutoSuggest;(function(n){var t;(function(n){var t=function(){function n(n,t){var i=this;this.ClientInfoUrl="/searchPreCache/mapClient?clientType=DefaultBrowser",this.SearchPath="/search?",this.SearchPreCachePath="/searchPreCache/cacheMappedClient?",this.PreCacheDirective="pf=1",this._dataIsCurrent=function(){return!0},this._webDataProvider=t,this.mapClient(),n.bindConversationStart(function(){return i.mapClient()})}return n.prototype.triggerPreCache=function(n,t){var u=!1,r="",i;return this._clientInfo&&this._clientInfo.mapped=="1"&&(u=!0,i=n.replace(this.SearchPath,this.SearchPreCachePath)+"&"+this.PreCacheDirective,this._webDataProvider.fetchUrl(i,null,t,null,this._dataIsCurrent)),this._clientInfo&&this._clientInfo.pcsId&&this._clientInfo.pcsId.length>0&&(r=this._clientInfo.pcsId),{isPreCached:u,syncId:r}},n.prototype.mapClient=function(){var i=this,t=0,n=function(n,t){i._clientInfo=t};this._webDataProvider.fetchUrl(this.ClientInfoUrl,n,t,null,this._dataIsCurrent)},n}();n.SearchPreCacheHandler=t})(t=n.Windows||(n.Windows={}))})(AutoSuggest||(AutoSuggest={}));(function(){var n=sa_config,e=new AutoSuggest.Windows.WindowsCortanaPaneSettings,t=new AutoSuggest.Windows.Host(n,e);ClientInstConfig&&(ClientInstConfig.queueDumpInterval=50);var v=new AutoSuggest.Windows.WindowsCortanaPaneInstrumentationProvider(n,CortanaApp),i=new AutoSuggest.InstrumentationHelper(n,t,v),a=AutoSuggest.QFAppCacheLogHelper.GetAppCacheLogger(t,i);n.lifeTimeEventsAvailable&&new AutoSuggest.SuperFreshAppCache(n,t,a);var s=new AutoSuggest.SnRDataProvider(n,i),y=AutoSuggest.StandaloneAutoComplete?new AutoSuggest.StandaloneAutoComplete(t):null,w=n.eSearchPreCache?new AutoSuggest.Windows.SearchPreCacheHandler(t,s):null,f=new AutoSuggest.NavigationHelper(n,i),p=new AutoSuggest.Windows.SuggestionsParser(n,t,i,f,w),l=new AutoSuggest.Windows.Page(n,i),o=new AutoSuggest.SequenceNumberManager,r=new AutoSuggest.Windows.RootViewModel(n,t,y,i,o,f,l),u=[];u.push(new AutoSuggest.Windows.LocalDataProvider(n,t)),AutoSuggest.isResponseTypeEnabled(AutoSuggest.Windows.ResponseTypes.BingContentStore,null,n)&&u.push(new AutoSuggest.Windows.Bcs.BCSDataProvider(n,AutoSuggest.ClientSideStorage.instanceWithStringKeys,t,i)),AutoSuggest.isResponseTypeEnabled(AutoSuggest.Windows.ResponseTypes.MRUSignals,null,n)&&u.push(new AutoSuggest.Windows.MRUDataProvider(n,function(n){return r.bindItemLaunch(n)},AutoSuggest.ClientSideStorage.instanceWithStringKeysAndSecondaryKey,t));var b=new AutoSuggest.KeyboardEvtHandler(t,r),h=new AutoSuggest.Windows.Ranking.Aggregator(n,t,i,f),c=new AutoSuggest.SuggestionsRenderingManager(n,e,t,i,h,r);new AutoSuggest.Core(n,e,t,p,r,c,s,u,i,o),t.init(),_w.WindowsFeedbackBadge&&WindowsFeedbackBadge.Show()})();"default";"default";"default";"default";"default";"default";"default";"default";"default";"default";"default";"default";"default";"default";"default";"default";"default";"default";
//]]></script><script type="text/javascript" src="/rms/rms%20localizationstrings%20Feedback%20LocStrings/jc/a7e49b91/99ff3224.js"></script><script type="text/javascript">//<![CDATA[
var Feedback;(function(n){var t;(function(n){"use strict";function r(n){for(var i="",r="abcdefghijklmnopqrstuvwxyz0123456789",t=0;t<n;++t)i+=r.charAt(Math.floor(Math.random()*r.length));return i}function i(n){var t="",u=0,r;switch(typeof n){case"object":if(n instanceof Array){for(t+="[",r=0;r<n.length;r++)r>0&&(t+=","),t+=i(n[r]);t+="]"}else if(n instanceof Boolean||n instanceof Date||n instanceof Number||n instanceof String)t=n.toString();else{t+="{";for(r in n)n.hasOwnProperty(r)&&(u>0&&(t+=","),t+='"'+r+'":'+i(n[r]),u++);t+="}"}return t;case"boolean":case"number":return n;case"string":return'"'+n.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\/]/g,"\\/").replace(/[\b]/g,"\\b").replace(/[\f]/g,"\\f").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t")+'"';default:return null}}function f(){try{if(_w.localStorage)return _w.localStorage}catch(n){return undefined}}function u(n){var i="";return i=Date.prototype.toISOString?n.toISOString():n.getUTCFullYear()+"-"+t(n.getUTCMonth()+1)+"-"+t(n.getUTCDate())+"T"+t(n.getUTCHours())+":"+t(n.getUTCMinutes())+":"+t(n.getUTCSeconds())+"."+String((n.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}function t(n){var t=String(n);return t.length===1&&(t="0"+t),t}n.GenerateString=r,n.Stringify=i,n.FetchLocalStorage=f,n.GetISODate=u})(t=n.Core||(n.Core={}))})(Feedback||(Feedback={}));var WindowsFeedback;(function(){"use strict";var t=function(){function n(){this.maxSizeBytes=35e5,this.feedbackUploadUrl="/customerfeedback/queue/full/windows",this.maxSendTries=3,this.requestTimeout=1e4}return n.prototype.Send=function(n,t,i,r){t===void 0&&(t=undefined),i===void 0&&(i=undefined),r===void 0&&(r=undefined);var u=typeof t=="undefined"?Feedback.Core.GenerateString(8):t;return this.SendAttempt(n,u,1,i,r)},n.prototype.SendAttempt=function(n,t,i,r,u){var f=sj_gx();f.open("POST",this.AppendParameter(this.feedbackUploadUrl,"debugid",t),!0),f.timeout=this.requestTimeout,f.setRequestHeader("Content-Type","application/json; charset=UTF-8"),f.onreadystatechange=function(){f.readyState==f.DONE&&(f.status==204?this.OnSendSuccess(n,t,r):i>=this.maxSendTries?this.OnOnlineSendFailure(n,t,r):(typeof _G!="undefined"&&_G.IG?Log2.LogEvent("ClientInst",{error:"Will need to retry sending the payload because not all of them reached the live bing.com servers"},"Feedback.Error",null,null,_G.IG):Log2.LogEvent("ClientInst",{error:"_G.IG was not available when we wanted to log that we will resend the payload"},"Feedback.Error"),this.SendAttempt(n,t,++i,r,u)))}.bind(this),f.send(JSON.stringify(n))},n.prototype.OnSendSuccess=function(n,t,i){i===void 0&&(i=undefined),delete n.html,typeof _G!="undefined"&&_G.IG?Log2.LogEvent("ClientInst",JSON.stringify(n),"Feedback.Online",null,null,_G.IG):Log2.LogEvent("ClientInst",{error:"_G.IG was not available when submitting feedback online"},"Feedback.Error"),typeof i!="undefined"&&i(t)},n.prototype.OnOnlineSendFailure=function(n,t,i){i===void 0&&(i=undefined),delete n.html,typeof _G!="undefined"&&_G.IG?Log2.LogEvent("ClientInst",JSON.stringify(n),"Feedback.Offline",null,null,_G.IG):Log2.LogEvent("ClientInst",{error:"_G.IG was not available when submitting feedback offline"},"Feedback.Error"),typeof i!="undefined"&&i(t)},n.prototype.AppendParameter=function(n,t,i){return n+(n.indexOf("?")>=0?"&":"?")+t+"="+encodeURIComponent(i)},n}();_w.WindowsFeedbackProtocol=new t})(WindowsFeedback||(WindowsFeedback={}));var Microsoft;(function(n){var t;(function(n){"use strict";var t=function(){function n(n){this.base64ImageBlobs=this.GetImageBlobsAsBase64(n)}return n.prototype.Manipulate=function(n){if(n instanceof HTMLImageElement){var t=n;t.src&&this.base64ImageBlobs[t.src]&&(t.src=this.base64ImageBlobs[t.src])}},n.prototype.GetImageBlobsAsBase64=function(n){for(var e=n.querySelectorAll("img[src^='blob:']"),f={},t,i,o,u,r=0;r<e.length;r++)t=e[r],i=document.createElement("canvas"),i.width=t.width,i.height=t.height,o=i.getContext("2d"),o.drawImage(t,0,0),u=i.toDataURL(),f[t.src]=u;return f},n}();n.InlineImagesManipulator=t})(t=n.Search||(n.Search={}))})(Microsoft||(Microsoft={}));var Microsoft;(function(n){var t;(function(n){"use strict";var t=function(){function n(n){this.DocumentFragment=document.createDocumentFragment(),this.DocumentFragment.appendChild(n.cloneNode(!0))}return n.prototype.ManipulateElementsBySelector=function(n,t){var u,r,o,f,i,e;if(t)for(u=this.DocumentFragment.querySelectorAll(n),r=0,o=u.length;r<o;r++)for(f=u[r],i=0;i<t.length;i++)e=t[i],typeof f!="undefined"&&e.Manipulate(f)},n.prototype.DeleteElementsBySelector=function(n){for(var t;t=this.DocumentFragment.querySelector(n);)t&&t.parentNode.removeChild(t)},n.prototype.SerializeToHtml=function(){return this.DocumentFragment.firstChild.outerHTML},n}();n.DOMCopyManipulator=t})(t=n.Search||(n.Search={}))})(Microsoft||(Microsoft={}));var WindowsFeedback;(function(){"use strict";var t=function(){function n(){this.feedbackContainerId="fdbkcontainer",this.feedbackFormId="fdbkfrm",this.privacyLinkId="fdbkpplink",this.learnMoreLinkId="fdbklmlink",this.verbatimId="fdbkverbatim",this.privacyPolicyUrl="http://go.microsoft.com/fwlink/?LinkId=248686",this.learnMoreLinkUrl="http://bing.com/explore/feedback",this.internalCheckUrl="/feedback/internal",this.internalCheckRequestTimeout=2e3,this.localStorage=Feedback.Core.FetchLocalStorage()}return n.prototype.Show=function(){var n=_ge(this.feedbackContainerId);n===null?this.CreateShowForm():this.ResetShowForm()},n.prototype.Hide=function(){var n=_ge(this.feedbackContainerId);n&&(n.style.display="none")},n.prototype.CreateShowForm=function(){var n=sj_ce("form",this.feedbackFormId),a=this.AddText(n,"h1",this.GetLocString("WINDOWS_TITLE_TEXT")),r=sj_ce("div"),c=this.AddLabeledInput(r,"radio",this.GetLocString("DIALOG_COMMENT_TYPE4"),"type",!0,"1"),o=this.AddLabeledInput(r,"radio",this.GetLocString("DIALOG_COMMENT_TYPE5"),"type",!1,"2"),s=this.AddLabeledInput(r,"radio",this.GetLocString("DIALOG_COMMENT_TYPE6"),"type",!1,"3"),e,u,t;n.appendChild(r);var l=this.AddTextArea(n,this.verbatimId,this.GetLocString("DIALOG_COMMENT_TEXT"),!0),h=this.AddLabeledInput(n,"checkbox",this.GetLocString("DIALOG_INCLUDE_SCREENSHOT"),"screenshot",!0,undefined,"fdbkss"),f=sj_ce("div","fdbkinternal","inputwrapper");n.appendChild(f),this.CheckInternal(f);var y=this.AddLink(n,this.privacyLinkId,this.privacyPolicyUrl,this.GetLocString("PRIVACY_STATEMENT_LINK_TEXT")),v=this.AddLink(n,this.learnMoreLinkId,this.learnMoreLinkUrl,this.GetLocString("LEARN_MORE_LINK_TEXT")),i=sj_ce("div");return i.className="fdbkactionbtns",e=this.AddButton(i,"submit",this.GetLocString("DIALOG_SUBMIT_BUTTON_TEXT")),u=this.AddButton(i,"button",this.GetLocString("DIALOG_CANCEL_BUTTON_TEXT")),sj_be(u,"click",this.OnCloseForm.bind(this)),n.appendChild(i),t=sj_ce("div",this.feedbackContainerId),sj_be(t,"submit",this.OnSubmitForm.bind(this)),t.appendChild(n),_d.body.appendChild(t),typeof TestHooksEnabled!="undefined"&&TestHooksEnabled===!0&&(n.setAttribute("data-tag","WindowsFeedback.Form"),a.setAttribute("data-tag","WindowsFeedback.FormTitle"),c.setAttribute("data-tag","WindowsFeedback.SuggestRadioButton"),o.setAttribute("data-tag","WindowsFeedback.LikeRadioButton"),s.setAttribute("data-tag","WindowsFeedback.DislikeRadioButton"),l.setAttribute("data-tag","WindowsFeedback.VerbatimTextArea"),h.setAttribute("data-tag","WindowsFeedback.IncludeScreenshotCheckbox"),y.setAttribute("data-tag","WindowsFeedback.PrivacyLink"),v.setAttribute("data-tag","WindowsFeedback.LearnMoreLink"),e.setAttribute("data-tag","WindowsFeedback.SubmitButton"),u.setAttribute("data-tag","WindowsFeedback.CloseButton"),t.setAttribute("data-tag","WindowsFeedback.FeedbackContainer")),n},n.prototype.CheckInternal=function(n){var t=sj_gx();t.open("HEAD",this.internalCheckUrl,!0),t.timeout=this.internalCheckRequestTimeout,t.onreadystatechange=function(){t.readyState===t.DONE&&t.status===204&&this.AddInternalFormElements(n)}.bind(this),t.send()},n.prototype.AddInternalFormElements=function(n){var c=_ge(this.feedbackFormId),h=_ge(this.verbatimId),r=_ge(this.privacyLinkId),i=_ge(this.learnMoreLinkId),o=c.elements.screenshot,f=this.GetAlias(),e,u;h.classList.add("smallverbatim"),r&&r.parentNode.removeChild(r),i&&i.parentNode.removeChild(i),o&&(e=o.parentNode,u=e.parentNode,u.parentNode.removeChild(u));var l=this.AddText(n,"div",this.GetLocString("DIALOG_MSFT_INTERNAL"),"medium"),s=this.GetLocString("DIALOG_SEND_EMAIL_LABEL").replace("{0}","Bing")+" "+this.GetLocString("DIALOG_ALIAS_LABEL"),a=this.AddLabeledInput(n,"checkbox",s,"sendmail",!0,undefined,null,null,"medium"),t=sj_ce("input");t.type="text",t.name="alias",t.required=!0,f!=null&&(t.value=f),t.placeholder=this.GetLocString("DIALOG_ALIAS_TEXT"),n.appendChild(t)},n.prototype.AddLabeledInput=function(n,t,i,r,u,f,e,o,s,h){var a,c,l;return r===void 0&&(r=undefined),u===void 0&&(u=undefined),f===void 0&&(f=undefined),e===void 0&&(e="inputwrapper"),o===void 0&&(o=null),s===void 0&&(s=null),h===void 0&&(h=null),a=sj_ce("div",null,e),c=sj_ce("input",h,o),c.type=t,u===!0&&(c.checked=!0),typeof r=="string"&&(c.name=r),typeof f=="string"&&(c.value=f),l=sj_ce("label",null,s),l.appendChild(c),l.appendChild(_d.createTextNode(i)),a.appendChild(l),n.appendChild(a),c},n.prototype.AddLink=function(n,t,i,r){var u=sj_ce("a",t);return u.href=i,u.target="_blank",u.innerText=r,n.appendChild(u),u},n.prototype.AddTextArea=function(n,t,i,r){r===void 0&&(r=!0);var u=sj_ce("textarea",t);return u.placeholder=i,u.required=!0,n.appendChild(u),u},n.prototype.AddText=function(n,t,i,r){var u=sj_ce(t);return u.innerText=i,typeof r!="undefined"&&(u.className=r),n.appendChild(u),u},n.prototype.AddButton=function(n,t,i){var r=sj_ce("input");return r.type=t,r.value=i,n.appendChild(r),r},n.prototype.OnSubmitForm=function(n){var t,e,r,i,o,u,f;if(n.preventDefault(),typeof _w.PageDebug=="undefined"&&(_w.PageDebug={}),t={url:location.href,width:_w.innerWidth,height:_w.innerHeight,source:typeof _w.PageDebug.source=="undefined"?"windows":_w.PageDebug.source,send_mail:!0},e=this.GetFormValue("sendmail","checked"),e!==null&&(t.send_mail=e),r=this.GetFormValue("alias","value"),r&&(t.alias=r,this.SetAlias(r)),(!this.FormElementExists("screenshot")||this.GetFormValue("screenshot","checked"))&&(i=new Microsoft.Search.DOMCopyManipulator(_d.documentElement),i.DeleteElementsBySelector("script"),i.DeleteElementsBySelector("#aRmsDefer"),i.ManipulateElementsBySelector("img",[new Microsoft.Search.InlineImagesManipulator(i.DocumentFragment)]),t.html=i.SerializeToHtml()),typeof _G!="undefined"&&(_G.IG&&(t.impression_guid=_G.IG),_G.ST&&(t.timeStamp=Feedback.Core.GetISODate(_G.ST)),_G.V?t.vertical=_G.V:_G.P&&(t.vertical=_G.P)),o=this.DetermineQuery(),o&&(t.query=o),typeof _w.PageDebug!="undefined"){for(u in _w.PageDebug)t[u]=_w.PageDebug[u];_w.PageDebug.canvas!=="undefined"&&(t.vertical=_w.PageDebug.canvas)}f=this.GetTextAreaValue(this.verbatimId),typeof f=="string"&&(t.text=f),t.type=this.DetermineFeedbackType(),_w.WindowsFeedbackProtocol&&WindowsFeedbackProtocol.Send(t),this.Hide(),typeof _G!="undefined"&&_G.IG?Log2.LogEvent("ClientInst",{target:"Submit"},"Feedback.Click",null,null,_G.IG):Log2.LogEvent("ClientInst",{error:"_G.IG was not available when clicking on Submit button"},"Feedback.Error")},n.prototype.DetermineQuery=function(){var n;return typeof ThresholdUtilities!="undefined"&&(n=ThresholdUtilities.getDecodedQuery(),typeof n=="string")?n:typeof CortanaApp!="undefined"?CortanaApp.searchBox.getQueryText().queryText:null},n.prototype.OnCloseForm=function(n){n.preventDefault(),this.Hide(),typeof _G!="undefined"&&_G.IG?Log2.LogEvent("ClientInst",{target:"Cancel"},"Feedback.Click",null,null,_G.IG):Log2.LogEvent("ClientInst",{error:"_G.IG was not available when clicking on Cancel button"},"Feedback.Error")},n.prototype.DetermineFeedbackType=function(){for(var u=_ge(this.feedbackFormId),t=u.elements.type,r=1,n=0,i=t.length;n<i;n++)if(t[n].checked){r=+t[n].value;break}return r},n.prototype.GetTextAreaValue=function(n){var t=_ge(n);return typeof t!="undefined"?t.innerText:null},n.prototype.GetFormValue=function(n,t){var r=_ge(this.feedbackFormId),i=r.elements[n];return i?i[t]:null},n.prototype.FormElementExists=function(n){var i=_ge(this.feedbackFormId),t=i.elements[n];return t?!0:!1},n.prototype.ResetShowForm=function(){var t=_ge(this.feedbackFormId),i=t.elements.type,f=t.elements.screenshot,e=t.elements.sendmail,o=t.elements.alias,r=this.GetAlias(),n,u;for(t.reset(),n=0,u=i.length;n<u;n++)i[n].checked=n==0?!0:!1;f&&(f.checked=!0),e&&(e.checked=!0),o&&r&&(o.value=r),_ge(this.feedbackContainerId).style.display="block",i[0].focus()},n.prototype.GetLocString=function(n){return LocStringManager.getLocString({uiCulture:SearchAppWrapper.CortanaApp.uiLanguage,name:"LocStrings",namespace:"Feedback"})[n]},n.prototype.GetAlias=function(){return localStorage?localStorage.getItem("alias"):null},n.prototype.SetAlias=function(n){localStorage&&localStorage.setItem("alias",n)},n}();_w.WindowsFeedbackForm=new t,typeof sj_evt!="undefined"&&(sj_evt.bind("WindowsFeedback.Form.Show",function(){_w.WindowsFeedbackForm.Show()},1),sj_evt.bind("WindowsFeedback.Form.Hide",function(){_w.WindowsFeedbackForm.Hide()})),typeof CortanaApp!="undefined"&&CortanaApp.addEventListener&&CortanaApp.addEventListener("feedbackformrequested",function(){_w.WindowsFeedbackForm.Show()})})(WindowsFeedback||(WindowsFeedback={}));
//]]></script><script type="text/javascript">//<![CDATA[
_G.HT=new Date;
//]]></script></body></html>